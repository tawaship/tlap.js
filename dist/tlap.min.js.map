{"version":3,"file":"tlap.min.js","sources":["../src/Anchor.ts","../node_modules/ismobilejs/esm/isMobile.js","../node_modules/@tawaship/emitter/dist/Emitter.esm.js","../src/InteractionManager.ts","../src/Application.ts","../src/BodyPosition.ts","../src/BodyRotation.ts","../node_modules/@tawaship/task/dist/Task.esm.js","../src/DisplayObject.ts","../src/Object3D.ts","../src/Camera.ts","../src/Object2D.ts","../src/Container2D.ts","../src/Container3D.ts","../src/Content.ts","../src/Mesh.ts","../src/PhysicsObject3D.ts","../src/View.ts","../src/OIMO.ts","../src/PhysicsView.ts","../src/Shape.ts","../src/RigidBody.ts","../src/Sprite.ts"],"sourcesContent":["import * as THREE from 'three';\r\nimport { IMesh } from './IMesh';\r\n\r\nexport class Anchor {\r\n\tprivate _x: number;\r\n\tprivate _y: number;\r\n\tprivate _z: number;\r\n\tprivate _mesh: IMesh;\r\n\t\r\n\tconstructor(x: number, y: number, z: number, mesh: IMesh) {\r\n\t\tthis._x = x;\r\n\t\tthis._y = y;\r\n\t\tthis._z = z;\r\n\t\tthis._mesh = mesh;\r\n\t}\r\n\t\r\n\tget x() {\r\n\t\treturn this._x;\r\n\t}\r\n\t\r\n\tset x(value) {\r\n\t\tthis._x = value;\r\n\t\tthis._mesh.updateGeometryPosition();\r\n\t}\r\n\t\r\n\tget y() {\r\n\t\treturn this._y;\r\n\t}\r\n\t\r\n\tset y(value) {\r\n\t\tthis._y = value;\r\n\t\tthis._mesh.updateGeometryPosition();\r\n\t}\r\n\t\r\n\tget z() {\r\n\t\treturn this._z;\r\n\t}\r\n\t\r\n\tset z(value) {\r\n\t\tthis._z = value;\r\n\t\tthis._mesh.updateGeometryPosition();\r\n\t}\r\n\t\r\n\tset(x: number, y?: number, z?: number) {\r\n\t\tif (y === undefined) {\r\n\t\t\ty = x;\r\n\t\t}\r\n\t\t\r\n\t\tif (z === undefined) {\r\n\t\t\tz = y;\r\n\t\t}\r\n\t\t\r\n\t\tthis._x = x;\r\n\t\tthis._y = y;\r\n\t\tthis._z = z;\r\n\t\t\r\n\t\tthis._mesh.updateGeometryPosition();\r\n\t}\r\n}","var appleIphone = /iPhone/i;\nvar appleIpod = /iPod/i;\nvar appleTablet = /iPad/i;\nvar appleUniversal = /\\biOS-universal(?:.+)Mac\\b/i;\nvar androidPhone = /\\bAndroid(?:.+)Mobile\\b/i;\nvar androidTablet = /Android/i;\nvar amazonPhone = /(?:SD4930UR|\\bSilk(?:.+)Mobile\\b)/i;\nvar amazonTablet = /Silk/i;\nvar windowsPhone = /Windows Phone/i;\nvar windowsTablet = /\\bWindows(?:.+)ARM\\b/i;\nvar otherBlackBerry = /BlackBerry/i;\nvar otherBlackBerry10 = /BB10/i;\nvar otherOpera = /Opera Mini/i;\nvar otherChrome = /\\b(CriOS|Chrome)(?:.+)Mobile/i;\nvar otherFirefox = /Mobile(?:.+)Firefox\\b/i;\nvar isAppleTabletOnIos13 = function (navigator) {\n    return (typeof navigator !== 'undefined' &&\n        navigator.platform === 'MacIntel' &&\n        typeof navigator.maxTouchPoints === 'number' &&\n        navigator.maxTouchPoints > 1 &&\n        typeof MSStream === 'undefined');\n};\nfunction createMatch(userAgent) {\n    return function (regex) { return regex.test(userAgent); };\n}\nexport default function isMobile(param) {\n    var nav = {\n        userAgent: '',\n        platform: '',\n        maxTouchPoints: 0\n    };\n    if (!param && typeof navigator !== 'undefined') {\n        nav = {\n            userAgent: navigator.userAgent,\n            platform: navigator.platform,\n            maxTouchPoints: navigator.maxTouchPoints || 0\n        };\n    }\n    else if (typeof param === 'string') {\n        nav.userAgent = param;\n    }\n    else if (param && param.userAgent) {\n        nav = {\n            userAgent: param.userAgent,\n            platform: param.platform,\n            maxTouchPoints: param.maxTouchPoints || 0\n        };\n    }\n    var userAgent = nav.userAgent;\n    var tmp = userAgent.split('[FBAN');\n    if (typeof tmp[1] !== 'undefined') {\n        userAgent = tmp[0];\n    }\n    tmp = userAgent.split('Twitter');\n    if (typeof tmp[1] !== 'undefined') {\n        userAgent = tmp[0];\n    }\n    var match = createMatch(userAgent);\n    var result = {\n        apple: {\n            phone: match(appleIphone) && !match(windowsPhone),\n            ipod: match(appleIpod),\n            tablet: !match(appleIphone) &&\n                (match(appleTablet) || isAppleTabletOnIos13(nav)) &&\n                !match(windowsPhone),\n            universal: match(appleUniversal),\n            device: (match(appleIphone) ||\n                match(appleIpod) ||\n                match(appleTablet) ||\n                match(appleUniversal) ||\n                isAppleTabletOnIos13(nav)) &&\n                !match(windowsPhone)\n        },\n        amazon: {\n            phone: match(amazonPhone),\n            tablet: !match(amazonPhone) && match(amazonTablet),\n            device: match(amazonPhone) || match(amazonTablet)\n        },\n        android: {\n            phone: (!match(windowsPhone) && match(amazonPhone)) ||\n                (!match(windowsPhone) && match(androidPhone)),\n            tablet: !match(windowsPhone) &&\n                !match(amazonPhone) &&\n                !match(androidPhone) &&\n                (match(amazonTablet) || match(androidTablet)),\n            device: (!match(windowsPhone) &&\n                (match(amazonPhone) ||\n                    match(amazonTablet) ||\n                    match(androidPhone) ||\n                    match(androidTablet))) ||\n                match(/\\bokhttp\\b/i)\n        },\n        windows: {\n            phone: match(windowsPhone),\n            tablet: match(windowsTablet),\n            device: match(windowsPhone) || match(windowsTablet)\n        },\n        other: {\n            blackberry: match(otherBlackBerry),\n            blackberry10: match(otherBlackBerry10),\n            opera: match(otherOpera),\n            firefox: match(otherFirefox),\n            chrome: match(otherChrome),\n            device: match(otherBlackBerry) ||\n                match(otherBlackBerry10) ||\n                match(otherOpera) ||\n                match(otherFirefox) ||\n                match(otherChrome)\n        },\n        any: false,\n        phone: false,\n        tablet: false\n    };\n    result.any =\n        result.apple.device ||\n            result.android.device ||\n            result.windows.device ||\n            result.other.device;\n    result.phone =\n        result.apple.phone || result.android.phone || result.windows.phone;\n    result.tablet =\n        result.apple.tablet || result.android.tablet || result.windows.tablet;\n    return result;\n}\n//# sourceMappingURL=isMobile.js.map","/*!\n * @tawaship/emitter - v3.1.1\n * \n * @author tawaship (makazu.mori@gmail.com)\n * @license MIT\n */\n\nclass Emitter {\r\n    constructor() {\r\n        this._events = {};\r\n    }\r\n    _on(type, callback, once) {\r\n        if (!type || !callback) {\r\n            return this;\r\n        }\r\n        const events = this._events[type] = this._events[type] || [];\r\n        for (let i = 0; i < events.length; i++) {\r\n            if (events[i].callback === callback) {\r\n                return this;\r\n            }\r\n        }\r\n        events.push({ callback, once });\r\n        return this;\r\n    }\r\n    /**\r\n     * Register event.\r\n     *\r\n     * @param type Event type.\r\n     * @param callback Callback when the event fires.\r\n     */\r\n    on(type, callback) {\r\n        return this._on(type, callback, false);\r\n    }\r\n    /**\r\n     * Register one-time event.\r\n     *\r\n     * @param type Event type.\r\n     * @param callback Callback when the event fires.\r\n     */\r\n    once(type, callback) {\r\n        return this._on(type, callback, true);\r\n    }\r\n    /**\r\n     * Unregister event.\r\n     *\r\n     * @param type Event type.\r\n     * @param callback Registered callback.\r\n     */\r\n    off(type, callback) {\r\n        if (!type || !callback) {\r\n            return this;\r\n        }\r\n        const events = this._events[type] || [];\r\n        for (let i = 0; i < events.length; i++) {\r\n            if (events[i].callback === callback) {\r\n                events.splice(i, 1);\r\n                return this;\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    _emit(type, context, ...args) {\r\n        if (!type) {\r\n            return this;\r\n        }\r\n        const events = this._events[type] || [];\r\n        const targets = [];\r\n        for (let i = events.length - 1; i >= 0; i--) {\r\n            const event = events[i];\r\n            if (event.once) {\r\n                events.splice(i, 1);\r\n            }\r\n            targets.push(event);\r\n        }\r\n        for (let i = targets.length - 1; i >= 0; i--) {\r\n            targets[i].callback.apply(context, args);\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Emit event.\r\n     *\r\n     * @param type Event type to emit.\r\n     * @param args Argument(s) in callback.\r\n     */\r\n    emit(type, ...args) {\r\n        return this._emit(type, this, ...args);\r\n    }\r\n    /**\r\n     * Emit event with specifying a context.\r\n     *\r\n     * @param type Event type to emit.\r\n     * @param context Context to execute the callback.\r\n     * @param args Argument(s) in callback.\r\n     */\r\n    cemit(type, context, ...args) {\r\n        return this._emit(type, context, ...args);\r\n    }\r\n    _emitAll(context, ...args) {\r\n        if (context == null) {\r\n            return this;\r\n        }\r\n        const targets = [];\r\n        for (let type in this._events) {\r\n            const events = this._events[type] || [];\r\n            for (let i = events.length - 1; i >= 0; i--) {\r\n                const event = events[i];\r\n                if (event.once) {\r\n                    events.splice(i, 1);\r\n                }\r\n                targets.push(event);\r\n            }\r\n        }\r\n        for (let i = targets.length - 1; i >= 0; i--) {\r\n            targets[i].callback.apply(context, args);\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Emit all events.\r\n     *\r\n     * @param args Argument(s) in callback.\r\n     */\r\n    emitAll(...args) {\r\n        return this._emitAll(this, ...args);\r\n    }\r\n    /**\r\n     * Emit all events with specifying a context.\r\n     *\r\n     * @param context Context to execute the callback.\r\n     * @param args Argument(s) in callback.\r\n     */\r\n    cemitAll(context, ...args) {\r\n        return this._emitAll(context, ...args);\r\n    }\r\n    /**\r\n     * Remove events grouped event type.\r\n     *\r\n     * @param type Event type to remove. If it is empty, removes all events.\r\n     */\r\n    clear(type = '') {\r\n        if (type) {\r\n            delete (this._events[type]);\r\n        }\r\n        else {\r\n            this._events = {};\r\n        }\r\n        return this;\r\n    }\r\n}\n\nexport { Emitter };\n//# sourceMappingURL=Emitter.esm.js.map\n","import * as THREE from 'three';\r\nimport isMobile from 'ismobilejs';\r\nimport { DisplayObject } from './DisplayObject';\r\nimport { Emitter } from '@tawaship/emitter';\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst isSP = isMobile(navigator.userAgent).any;\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction separate(_first: DisplayObject[], _emitted: DisplayObject[]) {\r\n\tconst first: DisplayObject[] = _first.concat([]);\r\n\tconst emitted: DisplayObject[] = _emitted.concat([]);\r\n\tconst both: DisplayObject[] = [];\r\n\t\r\n\tfor (let i = first.length - 1; i >= 0; i--) {\r\n\t\tconst p = first[i];\r\n\t\tconst index = emitted.indexOf(p);\r\n\t\t\r\n\t\tif (index > -1) {\r\n\t\t\tfirst.splice(i, 1);\r\n\t\t\temitted.splice(index, 1);\r\n\t\t\tboth.push(p);\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn { both, first, emitted };\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction dispatch(targets: DisplayObject[], type: string, event: IInteractionEvent) {\r\n\tfor (let i = 0; i < targets.length; i++) {\r\n\t\ttargets[i].emit(type, event);\r\n\t}\r\n};\r\n\r\nexport interface IInteractionEvent extends THREE.Event {\r\n\ttype: string;\r\n\temitted: DisplayObject[];\r\n\toriginalEvent: Event | null;\r\n};\r\n\r\nexport class InteractionManager extends Emitter {\r\n\tprotected _mouse: THREE.Vector2 = new THREE.Vector2();\r\n\tprotected _event: IInteractionEvent = { type: '', emitted: [], originalEvent: null };\r\n\tprotected _down: DisplayObject[] = [];\r\n\tprotected _over: DisplayObject[] = [];\r\n\t\r\n\tinteractive: boolean = true;\r\n\tinteractiveDown: boolean = true;\r\n\tinteractiveMove: boolean = false;\r\n\tinteractiveUp: boolean = true;\r\n\t\r\n\t/**\r\n\t * @fire cast\r\n\t */\r\n\tprotected _cast(e: Event, x: number, y: number, width: number, height: number) {\r\n\t\tthis._event.originalEvent = e;\r\n\t\tthis._event.emitted = [];\r\n\t\t\r\n\t\tthis._mouse.x = (x / width) * 2 - 1;\r\n\t\tthis._mouse.y = -(y / height) * 2 + 1;\r\n\t\t\r\n\t\tthis.emit('cast', this._event, this._mouse);\r\n\t}\r\n\t\r\n\tonDown(e: Event, x: number, y: number, width: number, height: number) {\r\n\t\tthis._down = [];\r\n\t\tif (!this.interactive || !this.interactiveDown) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._event.type = 'system:interaction:pointerdown';\r\n\t\tthis._cast(e, x, y, width, height);\r\n\t\t\r\n\t\tif (this._event.emitted.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tdispatch(this._event.emitted, 'pointerdown', this._event);\r\n\t\tthis._down = this._event.emitted;\r\n\t}\r\n\t\r\n\tonMove(e: Event, x: number, y: number, width: number, height: number) {\r\n\t\tif (!this.interactive || !this.interactiveMove) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._event.type = 'system:interaction:pointermove';\r\n\t\tthis._cast(e, x, y, width, height);\r\n\t\t\r\n\t\tif (this._over.length === 0) {\r\n\t\t\tif (this._event.emitted.length > 0) {\r\n\t\t\t\tdispatch(this._event.emitted, 'pointerover', this._event);\r\n\t\t\t\tthis._over = this._event.emitted;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tif (this._event.emitted.length === 0) {\r\n\t\t\tdispatch(this._over, 'pointerout', this._event);\r\n\t\t\tthis._over = [];\r\n\t\t\t\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tconst saparated = separate(this._over, this._event.emitted);\r\n\t\t\r\n\t\tdispatch(saparated.emitted, 'pointerover', this._event);\r\n\t\tdispatch(saparated.first, 'pointerout', this._event);\r\n\t\tthis._over = this._event.emitted;\r\n\t\t\r\n\t\tdispatch(saparated.both, 'pointermove', this._event);\r\n\t}\r\n\t\r\n\tonUp(e: Event, x: number, y: number, width: number, height: number) {\r\n\t\tif (!this.interactive || !this.interactiveUp) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._event.type = 'system:interaction:pointerup';\r\n\t\tthis._cast(e, x, y, width, height);\r\n\t\t\r\n\t\tif (this._down.length === 0) {\r\n\t\t\tif (this._event.emitted.length > 0) {\r\n\t\t\t\tdispatch(this._event.emitted, 'pointerup', this._event);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tif (this._event.emitted.length === 0) {\r\n\t\t\tdispatch(this._down, 'pointerupoutside', this._event);\r\n\t\t\tthis._down = [];\r\n\t\t\t\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tconst saparated = separate(this._down, this._event.emitted);\r\n\t\t\r\n\t\tdispatch(saparated.emitted, 'pointerup', this._event);\r\n\t\tdispatch(saparated.first, 'pointerupoutside', this._event);\r\n\t\t\r\n\t\tdispatch(saparated.both, 'pointerup', this._event);\r\n\t\tdispatch(saparated.both, 'pointertap', this._event);\r\n\t\tthis._down = [];\r\n\t}\r\n\t\r\n\taddCanvas(canvas: HTMLCanvasElement) {\r\n\t\tif (isSP) {\r\n\t\t\tcanvas.addEventListener('touchstart', (e: TouchEvent) => {\r\n\t\t\t\tthis.onDown(e, e.touches[0].clientX - canvas.offsetLeft, e.touches[0].clientY - canvas.offsetTop, canvas.offsetWidth, canvas.offsetHeight);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tcanvas.addEventListener('touchmove', (e: TouchEvent) => {\r\n\t\t\t\tthis.onMove(e, e.touches[0].clientX - canvas.offsetLeft, e.touches[0].clientY - canvas.offsetTop, canvas.offsetWidth, canvas.offsetHeight);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tcanvas.addEventListener('touchend', (e: TouchEvent) => {\r\n\t\t\t\tthis.onUp(e, e.changedTouches[0].clientX - canvas.offsetLeft, e.changedTouches[0].clientY - canvas.offsetTop, canvas.offsetWidth, canvas.offsetHeight);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tcanvas.addEventListener('mousedown', (e: MouseEvent) => {\r\n\t\t\t\tthis.onDown(e, e.offsetX, e.offsetY, canvas.offsetWidth, canvas.offsetHeight);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tcanvas.addEventListener('mousemove', (e: MouseEvent) => {\r\n\t\t\t\tthis.onMove(e, e.offsetX, e.offsetY, canvas.offsetWidth, canvas.offsetHeight);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tcanvas.addEventListener('mouseup', (e: MouseEvent) => {\r\n\t\t\t\tthis.onUp(e, e.offsetX, e.offsetY, canvas.offsetWidth, canvas.offsetHeight);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n}\r\n","import * as THREE from 'three';\r\nimport isMobile from 'ismobilejs';\r\nimport { View } from './View';\r\nimport { DisplayObject, ITickerData } from './DisplayObject';\r\nimport { InteractionManager, IInteractionEvent } from './InteractionManager';\r\nimport { Content } from './Content';\r\nimport { IDeliverData } from './IDeliverData';\r\n\r\nexport interface IApplicationOption {\r\n\tcanvas?: HTMLCanvasElement;\r\n\tcontainer?: HTMLElement;\r\n\twidth?: number;\r\n\theight?: number;\r\n\ttransparent?: boolean;\r\n\tresolution?: number;\r\n\tbackgroundColor?: number;\r\n\tantialias?: boolean;\r\n\tautoAdjust?: TAutoAdjust;\r\n\tbasepath?: string;\r\n\tversion?: string;\r\n\tinteractionCanvas?: HTMLCanvasElement;\r\n}\r\n\r\nexport interface IAdjustDelegate {\r\n\t(app: Application): void;\r\n}\r\n\r\nexport type TAutoAdjust = boolean | IAdjustDelegate;\r\n\r\nexport interface IAutoAdjustDelegate {\r\n\t(): void;\r\n}\r\n\r\nexport type TAutoAdjuster = IAutoAdjustDelegate | null;\r\n\r\nexport interface ISize {\r\n\twidth: number;\r\n\theight: number;\r\n}\r\n\r\nexport interface IPosition {\r\n\tx: number;\r\n\ty: number;\r\n}\r\n\r\nexport interface IHorizontal {\r\n\tx: number;\r\n\twidth: number;\r\n}\r\n\r\nexport interface IVertical {\r\n\ty: number;\r\n\theight: number;\r\n}\r\n\r\nexport interface IRect extends ISize, IPosition {}\r\n\r\nexport class Application {\r\n\tprivate _container: HTMLElement;\r\n\tprivate _renderer: THREE.WebGLRenderer;\r\n\tprivate _views: View[] = [];\r\n\tprivate _lastTime: number = 0;\r\n\tprivate _playing: boolean = false;\r\n\tprivate _rendererSize: THREE.Vector2;\r\n\tprivate _autoAdjuster: TAutoAdjuster = null;\r\n\tprivate _basepath: string = '';\r\n\tprivate _version: string = '';\r\n\tprivate _interactionManager = new InteractionManager();\r\n\t\r\n\tconstructor(options: IApplicationOption = {}) {\r\n\t\tconst canvas = options.canvas || undefined;\r\n\t\tconst container = options.container || document.body;\r\n\t\tconst transparent = options.transparent || false;\r\n\t\tconst antialias = options.antialias || false;\r\n\t\tconst rendererOptions = {\r\n\t\t\tcanvas, alpha: transparent, antialias\r\n\t\t}\r\n\t\t\r\n\t\tconst renderer = new THREE.WebGLRenderer(rendererOptions);\r\n\t\t\r\n\t\tconst width = options.width || 600;\r\n\t\tconst height = options.height || 400;\r\n\t\tconst resolution = options.resolution || 1;\r\n\t\tconst backgroundColor = options.backgroundColor || 0;\r\n\t\tconst opacity = transparent ? 0 : 1;\r\n\t\tconst autoAdjust = options.autoAdjust || false;\r\n\t\tconst basepath = options.basepath || './';\r\n\t\tconst version = options.version || '';\r\n\t\t\r\n\t\trenderer.setClearColor(backgroundColor, 0);\r\n\t\trenderer.setSize(width, height);\r\n\t\trenderer.setPixelRatio(resolution);\r\n\t\trenderer.autoClear = false;\r\n\t\t\r\n\t\tthis._container = container;\r\n\t\tthis._renderer = renderer;\r\n\t\tthis._rendererSize = new THREE.Vector2(width, height);\r\n\t\tthis._basepath = basepath;\r\n\t\tthis._version = version;\r\n\t\t\r\n\t\trenderer.domElement.style.position = 'absolute';\r\n\t\t\r\n\t\tconst raycaster = new THREE.Raycaster();\r\n\t\t\r\n\t\tthis._interactionManager.addCanvas(renderer.domElement);\r\n\t\t\r\n\t\tthis._interactionManager.on('cast', (event: IInteractionEvent, mouse: THREE.Vector2) => {\r\n\t\t\tconst c = this._views;\r\n\t\t\tfor (let i = c.length - 1; i >= 0; i--) {\r\n\t\t\t\tif (event.emitted.length > 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tc[i].onInteraction(event, raycaster, mouse);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\twindow.addEventListener('visibilitychange', e => {\r\n\t\t\tthis._lastTime = e.timeStamp;\r\n\t\t});\r\n\t\t\r\n\t\tconst step = (timestamp: number) => {\r\n\t\t\tconst delta = (timestamp - this._lastTime) * 0.06;\r\n\t\t\tthis._lastTime = timestamp;\r\n\t\t\t\r\n\t\t\tif (!this._playing) {\r\n\t\t\t\trequestAnimationFrame(step);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.update(delta);\r\n\t\t\trequestAnimationFrame(step);\r\n\t\t};\r\n\t\t\r\n\t\trequestAnimationFrame(step);\r\n\t\t\r\n\t\tif (autoAdjust) {\r\n\t\t\tif (autoAdjust === true) {\r\n\t\t\t\tthis.autoAdjuster = () => {\r\n\t\t\t\t\tthis.fullScreen()\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\tthis.autoAdjuster = () => {\r\n\t\t\t\t\tautoAdjust(this);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tattachAsync(content: Content) {\r\n\t\treturn content.loadAssetsAsync(this._basepath, this._version)\r\n\t\t\t.then(resources => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\twidth: this._rendererSize.width,\r\n\t\t\t\t\theight: this._rendererSize.height,\r\n\t\t\t\t\tresources,\r\n\t\t\t\t\tvars: content.vars\r\n\t\t\t\t};\r\n\t\t\t})\r\n\t\t\t.then(($: IDeliverData) => {\r\n\t\t\t\tconst viewClasses = content.viewClasses;\r\n\t\t\t\tfor (let i = 0; i < viewClasses.length; i++) {\r\n\t\t\t\t\tthis.addView(new viewClasses[i]($));\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn this;\r\n\t\t\t});\r\n\t}\r\n\t\r\n\tget renderer() {\r\n\t\treturn this._renderer;\r\n\t}\r\n\t\r\n\tget interactionManager() {\r\n\t\treturn this._interactionManager;\r\n\t}\r\n\t\r\n\tget element() {\r\n\t\treturn this._renderer.domElement;\r\n\t}\r\n\t\r\n\tget width() {\r\n\t\treturn this._rendererSize.x;\r\n\t}\r\n\t\r\n\tget height() {\r\n\t\treturn this._rendererSize.y;\r\n\t}\r\n\t\r\n\taddView(view: View) {\r\n\t\tthis._views.push(view);\r\n\t\t\r\n\t\treturn view;\r\n\t}\r\n\t\r\n\tremoveView(view: View) {\r\n\t\tconst index = this._views.indexOf(view);\r\n\t\tif (index === -1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._views.splice(index, 1);\r\n\t\t\r\n\t\treturn view;\r\n\t}\r\n\t\r\n\tplay() {\r\n\t\tthis._container.appendChild(this._renderer.domElement);\r\n\t\t\r\n\t\treturn this.start();\r\n\t}\r\n\t\r\n\tstart() {\r\n\t\tthis._playing = true;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\tstop() {\r\n\t\tthis._playing = false;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\tupdate(delta: number) {\r\n\t\tconst c = this._views;\r\n\t\tconst e: ITickerData = { delta };\r\n\t\t\r\n\t\tfor (let i = 0; i < c.length; i++) {\r\n\t\t\tc[i].update(e, false);\r\n\t\t}\r\n\t\t\r\n\t\tthis.render();\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tthis._renderer.setViewport(0, 0, this._rendererSize.x, this._rendererSize.y);\r\n\t\tthis._renderer.clear();\r\n\t\t\r\n\t\tconst c = this._views;\r\n\t\tfor (let i = 0; i < c.length; i++) {\r\n\t\t\tc[i].render(this._renderer);\r\n\t\t}\r\n\t}\r\n\t\r\n\tget autoAdjuster() {\r\n\t\treturn this._autoAdjuster;\r\n\t}\r\n\t\r\n\tset autoAdjuster(autoAdjuster: TAutoAdjuster) {\r\n\t\tif (this._autoAdjuster) {\r\n\t\t\twindow.removeEventListener('resize', this._autoAdjuster);\r\n\t\t}\r\n\t\t\r\n\t\tif (!autoAdjuster) {\r\n\t\t\tthis._autoAdjuster = null;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._autoAdjuster = autoAdjuster;\r\n\t\twindow.addEventListener('resize', autoAdjuster);\r\n\t\tautoAdjuster();\r\n\t}\r\n\t\r\n\t/**\r\n\t * Resize canvas to fit specified rectangle.\r\n\t * \r\n\t * @param rect Rectangle to adjust.\r\n\t */\r\n\tfullScreen(rect?: IRect) {\r\n\t\tconst view: HTMLCanvasElement = this._renderer.domElement;\r\n\t\tconst r: IRect = rect || {\r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\twidth: this._container.offsetWidth || window.innerWidth,\r\n\t\t\theight: this._container.offsetHeight || window.innerHeight\r\n\t\t};\r\n\t\t\r\n\t\tif (r.width / r.height > view.width / view.height) {\r\n\t\t\treturn this.adjustHeight(r.height).toCenter(r).toTop(r);\r\n\t\t}\r\n\t\t\r\n\t\treturn this.adjustWidth(r.width).toMiddle(r).toLeft(r);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Resize canvas to fit specified width.\r\n\t * \r\n\t * @param width Width to adjust.\r\n\t */\r\n\tadjustWidth(width?: number) {\r\n\t\tconst view: HTMLCanvasElement = this._renderer.domElement;\r\n\t\tconst w: number = width || this._container.offsetWidth || window.innerWidth;\r\n\t\t\r\n\t\tconst h: number = w / view.width * view.height;\r\n\t\t\r\n\t\t//const frame = this._piximData.frame;\r\n\t\tview.style.width = `${w}px`;\r\n\t\tview.style.height = `${h}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Resize canvas to fit specified height.\r\n\t * \r\n\t * @param height Height to adjust.\r\n\t */\r\n\tadjustHeight(height?: number) {\r\n\t\tconst view = this._renderer.domElement;\r\n\t\tconst h: number = height || this._container.offsetHeight || window.innerHeight;\r\n\t\t\r\n\t\tconst w = h / view.height * view.width;\r\n\t\t\r\n\t\t//const frame = this._piximData.frame;\r\n\t\tview.style.height = `${h}px`;\r\n\t\tview.style.width = `${w}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Left justified with respect to the reference data.\r\n\t * \r\n\t * @param horizontal Horizontal data used to calculate the position.\r\n\t */\r\n\ttoLeft(horizontal?: IHorizontal) {\r\n\t\tconst view = this._renderer.domElement;\r\n\t\tconst hol: IHorizontal = horizontal || {\r\n\t\t\tx: 0,\r\n\t\t\twidth: this._container.offsetWidth || window.innerWidth\r\n\t\t};\r\n\t\t\r\n\t\tview.style.left = `${hol.x}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Center justified with respect to the reference data.\r\n\t * \r\n\t * @param horizontal Horizontal data used to calculate the position.\r\n\t */\r\n\ttoCenter(horizontal?: IHorizontal) {\r\n\t\tconst view = this._renderer.domElement;\r\n\t\tconst hol: IHorizontal = horizontal || {\r\n\t\t\tx: 0,\r\n\t\t\twidth: this._container.offsetWidth || window.innerWidth\r\n\t\t};\r\n\t\t\r\n\t\tview.style.left = `${(hol.width - this._getViewRect().width) / 2 + hol.x}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Right justified with respect to the reference data.\r\n\t * \r\n\t * @param horizontal Horizontal data used to calculate the position.\r\n\t */\r\n\ttoRight(horizontal?: IHorizontal) {\r\n\t\tconst view = this._renderer.domElement;\r\n\t\tconst hol: IHorizontal = horizontal || {\r\n\t\t\tx: 0,\r\n\t\t\twidth: this._container.offsetWidth || window.innerWidth\r\n\t\t};\r\n\t\t\r\n\t\tview.style.left = `${hol.width - this._getViewRect().width + hol.x}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Top justified with respect to the reference data.\r\n\t * \r\n\t * @param vertical Vertical data used to calculate the position.\r\n\t */\r\n\ttoTop(vertical?: IVertical) {\r\n\t\tconst view = this._renderer.domElement;\r\n\t\tconst ver: IVertical = vertical || {\r\n\t\t\ty: 0,\r\n\t\t\theight: this._container.offsetHeight || window.innerHeight\r\n\t\t};\r\n\t\t\r\n\t\tview.style.top = `${ver.y}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Middle justified with respect to the reference data.\r\n\t * \r\n\t * @param vertical Vertical data used to calculate the position.\r\n\t */\r\n\ttoMiddle(vertical?: IVertical) {\r\n\t\tconst view = this._renderer.domElement;\r\n\t\tconst ver: IVertical = vertical || {\r\n\t\t\ty: 0,\r\n\t\t\theight: this._container.offsetHeight || window.innerHeight\r\n\t\t};\r\n\t\t\r\n\t\tview.style.top = `${(ver.height - this._getViewRect().height) / 2 + ver.y}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Bottom justified with respect to the reference data.\r\n\t * \r\n\t * @param vertical Vertical data used to calculate the position.\r\n\t */\r\n\ttoBottom(vertical?: IVertical) {\r\n\t\tconst view = this._renderer.domElement;\r\n\t\tconst ver: IVertical = vertical || {\r\n\t\t\ty: 0,\r\n\t\t\theight: this._container.offsetHeight || window.innerHeight\r\n\t\t};\r\n\t\t\r\n\t\tview.style.top = `${ver.height - this._getViewRect().height + ver.y}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\tprivate _getViewRect(): IRect {\r\n\t\tconst view = this._renderer.domElement;\r\n\t\t\r\n\t\treturn {\r\n\t\t\tx: parseInt(view.style.left.replace('px', '')),\r\n\t\t\ty: parseInt(view.style.top.replace('px', '')),\r\n\t\t\twidth: parseInt(view.style.width.replace('px', '')),\r\n\t\t\theight: parseInt(view.style.height.replace('px', ''))\r\n\t\t};\r\n\t}\r\n}\r\n","import { PhysicsObject3D } from './PhysicsObject3D';\r\n\r\nexport class BodyPosition {\r\n\tprivate _object: PhysicsObject3D;\r\n\t\r\n\tconstructor(object: PhysicsObject3D) {\r\n\t\tthis._object = object;\r\n\t}\r\n\t\r\n\tget x() {\r\n\t\treturn this._object.body.getPosition().x;\r\n\t}\r\n\t\r\n\tset x(value) {\r\n\t\tconst position = this._object.body.getPosition();\r\n\t\tposition.x = value;\r\n\t\tthis._object.body.setPosition(position);\r\n\t\tthis._object.updateTransform();\r\n\t}\r\n\t\r\n\tget y() {\r\n\t\treturn this._object.body.getPosition().y;\r\n\t}\r\n\t\r\n\tset y(value) {\r\n\t\tconst position = this._object.body.getPosition();\r\n\t\tposition.y = value;\r\n\t\tthis._object.body.setPosition(position);\r\n\t\tthis._object.updateTransform();\r\n\t}\r\n\t\r\n\tget z() {\r\n\t\treturn this._object.body.getPosition().z;\r\n\t}\r\n\t\r\n\tset z(value) {\r\n\t\tconst position = this._object.body.getPosition();\r\n\t\tposition.z = value;\r\n\t\tthis._object.body.setPosition(position);\r\n\t\tthis._object.updateTransform();\r\n\t}\r\n\t\r\n\tset(x: number, y?: number, z?: number) {\r\n\t\tif (y === undefined) {\r\n\t\t\ty = x;\r\n\t\t}\r\n\t\t\r\n\t\tif (z === undefined) {\r\n\t\t\tz = y;\r\n\t\t}\r\n\t\t\r\n\t\tconst position = this._object.body.getPosition();\r\n\t\tposition.x = x;\r\n\t\tposition.y = y;\r\n\t\tposition.z = z;\r\n\t\t\r\n\t\tthis._object.body.setPosition(position);\r\n\t\tthis._object.updateTransform();\r\n\t}\r\n}","import { PhysicsObject3D } from './PhysicsObject3D';\r\n\r\nexport class BodyRotation {\r\n\tprivate _object: PhysicsObject3D;\r\n\t\r\n\tconstructor(object: PhysicsObject3D) {\r\n\t\tthis._object = object;\r\n\t}\r\n\t\r\n\tget x() {\r\n\t\treturn this._object.body.getRotation().toEulerXyz().x;\r\n\t}\r\n\t\r\n\tset x(value) {\r\n\t\tconst rotation = this._object.body.getRotation().toEulerXyz();\r\n\t\trotation.x = value;\r\n\t\tthis._object.body.setRotationXyz(rotation);\r\n\t\tthis._object.updateTransform();\r\n\t}\r\n\t\r\n\tget y() {\r\n\t\treturn this._object.body.getRotation().toEulerXyz().y;\r\n\t}\r\n\t\r\n\tset y(value) {\r\n\t\tconst rotation = this._object.body.getRotation().toEulerXyz();\r\n\t\trotation.y = value;\r\n\t\tthis._object.body.setRotationXyz(rotation);\r\n\t\tthis._object.updateTransform();\r\n\t}\r\n\t\r\n\tget z() {\r\n\t\treturn this._object.body.getRotation().toEulerXyz().z;\r\n\t}\r\n\t\r\n\tset z(value) {\r\n\t\tconst rotation = this._object.body.getRotation().toEulerXyz();\r\n\t\trotation.z = value;\r\n\t\tthis._object.body.setRotationXyz(rotation);\r\n\t\tthis._object.updateTransform();\r\n\t}\r\n\t\r\n\tset(x: number, y?: number, z?: number) {\r\n\t\tif (y === undefined) {\r\n\t\t\ty = x;\r\n\t\t}\r\n\t\t\r\n\t\tif (z === undefined) {\r\n\t\t\tz = y;\r\n\t\t}\r\n\t\t\r\n\t\tconst rotation = this._object.body.getRotation().toEulerXyz();\r\n\t\trotation.x = x;\r\n\t\trotation.y = y;\r\n\t\trotation.z = z;\r\n\t\t\r\n\t\tthis._object.body.setRotationXyz(rotation);\r\n\t\tthis._object.updateTransform();\r\n\t}\r\n}","/*!\n * @tawaship/task - v1.1.0\n * \n * @author tawaship (makazu.mori@gmail.com)\n * @license MIT\n */\n\nclass Task {\r\n    constructor(callbacks, context) {\r\n        this._taskData = {\r\n            context: context == null ? this : context,\r\n            enabled: true,\r\n            index: -1,\r\n            callbacks: [],\r\n            value: null\r\n        };\r\n        this.add(callbacks);\r\n    }\r\n    /**\r\n     * Whether the task works.\r\n     */\r\n    get enabled() {\r\n        return this._taskData.enabled;\r\n    }\r\n    set enabled(enabled) {\r\n        this._taskData.enabled = enabled;\r\n    }\r\n    /**\r\n     * Add the task to the end of the list.\r\n     */\r\n    add(callbacks) {\r\n        if (!Array.isArray(callbacks)) {\r\n            callbacks = [callbacks];\r\n        }\r\n        const list = this._taskData.callbacks;\r\n        const flag = list.length === 0;\r\n        for (let i = 0; i < callbacks.length; i++) {\r\n            if (!(callbacks[i] instanceof Function)) {\r\n                continue;\r\n            }\r\n            list.push(callbacks[i]);\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Execute the current task.\r\n     */\r\n    done(...args) {\r\n        if (!this._taskData.enabled) {\r\n            return;\r\n        }\r\n        const task = this._taskData.callbacks[this._taskData.index];\r\n        if (!task) {\r\n            return;\r\n        }\r\n        return this._taskData.value = task.apply(this._taskData.context, args);\r\n    }\r\n    _to(index) {\r\n        this._taskData.index = Number(index);\r\n        return this;\r\n    }\r\n    /**\r\n     * Change the current task to the first task.\r\n     */\r\n    first() {\r\n        return this._to(0);\r\n    }\r\n    /**\r\n     * Change the current task to the previos task.\r\n     */\r\n    prev() {\r\n        return this._to(this._taskData.index - 1);\r\n    }\r\n    /**\r\n     * Change the current task to the next task.\r\n     */\r\n    next() {\r\n        return this._to(this._taskData.index + 1);\r\n    }\r\n    /**\r\n     * Change the current task to the specified task.\r\n     */\r\n    to(index) {\r\n        return this._to(index);\r\n    }\r\n    /**\r\n     * Skips all tasks and changes to the finished state.\r\n     */\r\n    finish() {\r\n        this._taskData.index = -1;\r\n        return this;\r\n    }\r\n    /**\r\n     * Cancel all task and leave them unregistered.\r\n     */\r\n    reset() {\r\n        this._taskData.callbacks = [];\r\n        this._taskData.index = -1;\r\n        this._taskData.value = null;\r\n        return this;\r\n    }\r\n    /**\r\n     * Destroy instance.\r\n     */\r\n    destroy() {\r\n        this.reset();\r\n    }\r\n    /**\r\n     * The value returned by the last task executed.\r\n     */\r\n    get value() {\r\n        return this._taskData.value;\r\n    }\r\n}\n\nexport { Task };\n//# sourceMappingURL=Task.esm.js.map\n","import * as THREE from 'three';\r\nimport { Emitter } from '@tawaship/emitter';\r\nimport { Task } from '@tawaship/task';\r\n\r\nexport interface ITickerData {\r\n\tdelta: number;\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst _box = new THREE.Box3();\r\n\r\nexport abstract class DisplayObject<T extends THREE.Object3D = THREE.Object3D> extends Emitter {\r\n\tprotected _three: T;\r\n\tprotected _sub: T;\r\n\tprotected _size: THREE.Vector3 = new THREE.Vector3();\r\n\tprotected _pivot: THREE.Vector3 = new THREE.Vector3();\r\n\tprotected _children: DisplayObject[] = [];\r\n\tprotected _task: Task;\r\n\t\r\n\tinteractive: boolean = false;\r\n\ttaskEnabledChildren: boolean = true;\r\n\t\r\n\tconstructor(three: T) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis._three = this._sub = three;\r\n\t\t\r\n\t\tthree.addEventListener('system:interaction:pointerdown', event => {\r\n\t\t\tif (!this.interactive) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tevent.emitted.push(this);\r\n\t\t});\r\n\t\t\r\n\t\tthree.addEventListener('system:interaction:pointerup', event => {\r\n\t\t\tif (!this.interactive) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tevent.emitted.push(this);\r\n\t\t});\r\n\t\t\r\n\t\tthree.addEventListener('system:interaction:pointermove', event => {\r\n\t\t\tif (!this.interactive) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tevent.emitted.push(this);\r\n\t\t});\r\n\t\t\r\n\t\tthree.addEventListener('system:interaction:pointerupoutside', event => {\r\n\t\t\tif (!this.interactive) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tevent.emitted.push(this);\r\n\t\t});\r\n\t\t\r\n\t\tthis._task = new Task([], this);\r\n\t\tthis._task.first();\r\n\t}\r\n\t\r\n\tget three() {\r\n\t\treturn this._three;\r\n\t}\r\n\t\r\n\tget task() {\r\n\t\treturn this._task;\r\n\t}\r\n\t\r\n\tget taskEnabled() {\r\n\t\treturn this._task.enabled;\r\n\t}\r\n\t\r\n\tset taskEnabled(value: boolean) {\r\n\t\tthis._task.enabled = value;\r\n\t}\r\n\t\r\n\tget parent(): DisplayObject | null {\r\n\t\treturn this._three.userData.parent;\r\n\t}\r\n\t\r\n\tget children() {\r\n\t\treturn this._children;\r\n\t}\r\n\t\r\n\tupdateTask(e: ITickerData) {\r\n\t\tthis._task.done(e);\r\n\t}\r\n\t\r\n\tget width() {\r\n\t\tthis.updateBoundingBox();\r\n\t\treturn this._size.x;\r\n\t}\r\n\t\r\n\tget height() {\r\n\t\tthis.updateBoundingBox();\r\n\t\treturn this._size.y;\r\n\t}\r\n\t\r\n\tget depth() {\r\n\t\tthis.updateBoundingBox();\r\n\t\treturn this._size.z * this.scale.z;\r\n\t}\r\n\t\r\n\tget x() {\r\n\t\treturn this._three.position.x;\r\n\t}\r\n\t\r\n\tset x(value) {\r\n\t\tthis._three.position.x = value;\r\n\t}\r\n\t\r\n\tget y() {\r\n\t\treturn this._three.position.y;\r\n\t}\r\n\t\r\n\tset y(value) {\r\n\t\tthis._three.position.y = value;\r\n\t}\r\n\t\r\n\tget z() {\r\n\t\treturn this._three.position.z;\r\n\t}\r\n\t\r\n\tset z(value) {\r\n\t\tthis._three.position.z = value;\r\n\t}\r\n\t\r\n\t/*\r\n\tget position() {\r\n\t\treturn this._three.position;\r\n\t}\r\n\t*/\r\n\t\r\n\tget scale() {\r\n\t\treturn this._three.scale;\r\n\t}\r\n\t\r\n\tget pivot() {\r\n\t\treturn this._pivot;\r\n\t}\r\n\t\r\n\tupdate(e: ITickerData, taskDisabledChildren: boolean) {\r\n\t\tthis.updateTransform();\r\n\t\t!taskDisabledChildren && this.updateTask(e);\r\n\t\ttaskDisabledChildren = taskDisabledChildren || !this.taskEnabledChildren;\r\n\t\t\r\n\t\tconst c = this._children;\r\n\t\tfor (let i = 0; i < c.length; i++) {\r\n\t\t\tc[i].update(e, taskDisabledChildren);\r\n\t\t}\r\n\t}\r\n\t\r\n\tabstract updateTransform(): void;\r\n\t\r\n\tupdateBoundingBox() {\r\n\t\tthis.updateTransform();\r\n\t\t\r\n\t\t_box.setFromObject(this._sub);\r\n\t\t_box.getSize(this._size);\r\n\t\tthis._size.multiply(this.scale);\r\n\t}\r\n\t\r\n\taddChild(object: DisplayObject) {\r\n\t\tif (object.parent) {\r\n\t\t\tobject.parent.removeChild(object);\r\n\t\t}\r\n\t\t\r\n\t\tthis._children.push(object);\r\n\t\tthis._sub.add(object.three);\r\n\t\tobject.three.userData.parent = this;\r\n\t\t\r\n\t\treturn object;\r\n\t}\r\n\t\r\n\tremoveChild(object: DisplayObject) {\r\n\t\tif (object.parent !== this) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tconst index = this._children.indexOf(object);\r\n\t\tif (index === -1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._children.splice(index, 1);\r\n\t\tthis._sub.remove(object.three);\r\n\t\tobject.three.userData.parent = null;\r\n\t\t\r\n\t\treturn object;\r\n\t}\r\n}\r\n","import * as THREE from 'three';\r\nimport { DisplayObject } from './DisplayObject';\r\n\r\nexport abstract class Object3D<T extends THREE.Object3D = THREE.Object3D> extends DisplayObject<T> {\r\n\tget rotation() {\r\n\t\treturn this._three.rotation;\r\n\t}\r\n\t\r\n\tupdateTransform() {\r\n\t\t\r\n\t}\r\n}","import * as THREE from 'three';\r\nimport { Object3D } from './Object3D';\r\nimport { IRect } from './Application';\r\n\r\nexport class Camera extends Object3D<THREE.Camera> {\r\n\tprivate _viewport: IRect;\r\n\t\r\n\tconstructor(camera: THREE.Camera, viewport: IRect) {\r\n\t\tsuper(camera);\r\n\t\t\r\n\t\tthis._viewport = viewport;\r\n\t}\r\n\t\r\n\tget camera() {\r\n\t\treturn this._three;\r\n\t}\r\n\t\r\n\tget viewport() {\r\n\t\treturn this._viewport;\r\n\t}\r\n\t\r\n\trender(renderer: THREE.WebGLRenderer, scene: THREE.Scene) {\r\n\t\trenderer.setViewport(this._viewport.x, this._viewport.y, this._viewport.width, this._viewport.height);\r\n\t\trenderer.render(scene, this._three);\r\n\t}\r\n\t\r\n\tupdateTransform() {\r\n\t\r\n\t}\r\n\t\r\n\tupdateBoundingBox() {\r\n\t\r\n\t}\r\n}","import * as THREE from 'three';\r\nimport { DisplayObject } from './DisplayObject';\r\n\r\nexport abstract class Object2D<T extends THREE.Object3D = THREE.Object3D> extends DisplayObject<T> {\r\n\tprotected _skew: THREE.Vector2 = new THREE.Vector2();\r\n\t\r\n\tconstructor(three: T) {\r\n\t\tsuper(three);\r\n\t\t\r\n\t\tthree.matrixAutoUpdate = false;\r\n\t}\r\n\t\r\n\tget skew() {\r\n\t\treturn this._skew;\r\n\t}\r\n\t\r\n\tget rotation() {\r\n\t\treturn this._three.rotation.z;\r\n\t}\r\n\t\r\n\tset rotation(value) {\r\n\t\tthis._three.rotation.z = value;\r\n\t}\r\n\t\r\n\tupdateTransform() {\r\n\t\tthis._updateMatrix();\r\n\t}\r\n\t\r\n\t_updateMatrix() {\r\n\t\tconst x = this.x;\r\n\t\tconst y = this.y;\r\n\t\tconst z = this._three.position.z;\r\n\t\tconst scaleX = this.scale.x;\r\n\t\tconst scaleY = this.scale.y;\r\n\t\tconst skewX = this.skew.x;\r\n\t\tconst skewY = this.skew.y;\r\n\t\tconst rotation = this.rotation;\r\n\t\tconst pivotX = this.pivot.x;\r\n\t\tconst pivotY = this.pivot.y;\r\n\t\t\r\n\t\tconst a = Math.cos(rotation + skewY) * scaleX;\r\n\t\tconst b = Math.sin(rotation + skewY) * scaleX;\r\n\t\tconst c = -Math.sin(rotation - skewX) * scaleY;\r\n\t\tconst d = Math.cos(rotation - skewX) * scaleY;\r\n\t\tconst tx = x - ((pivotX * a) + (pivotY * c));\r\n\t\tconst ty = y - ((pivotX * b) + (pivotY * d));\r\n\t\t\r\n\t\tthis._three.matrix.set(\r\n\t\t\ta, c, 0, tx, \r\n\t\t\tb, d, 0, ty,\r\n\t\t\t0, 0, 1, z,\r\n\t\t\t0, 0, 0, 1\r\n\t\t);\r\n\t}\r\n}","import * as THREE from 'three';\r\nimport { Object2D } from './Object2D';\r\n\r\nexport class Container2D extends Object2D<THREE.Group> {\r\n\tconstructor() {\r\n\t\tsuper(new THREE.Group());\r\n\t\t\r\n\t\tthis._sub = new THREE.Group();\r\n\t\tthis._three.add(this._sub);\r\n\t}\r\n\t\r\n\t_updateOrder() {\r\n\t\tconst c = this._children;\r\n\t\tfor (let i = 0; i < c.length; i++) {\r\n\t\t\tc[i].three.position.z = i * 0.0000001;\r\n\t\t}\r\n\t}\r\n\t\r\n\tupdateBoundingBox() {\r\n\t\tthis._three.remove(this._sub);\r\n\t\tfor (let i = 0; i < this._children.length; i++) {\r\n\t\t\tthis._children[i].updateTransform();\r\n\t\t}\r\n\t\tsuper.updateBoundingBox();\r\n\t\tthis._three.add(this._sub)\r\n\t}\r\n}","import * as THREE from 'three';\r\nimport { Object3D } from './Object3D';\r\n\r\nexport class Container3D extends Object3D<THREE.Group> {\r\n\tconstructor() {\r\n\t\tsuper(new THREE.Group());\r\n\t\t\r\n\t\tthis._sub = new THREE.Group();\r\n\t\tthis._three.add(this._sub);\r\n\t}\r\n\t\r\n\tupdateTransform() {\r\n\t\tthis._sub.position.x = -this._pivot.x;\r\n\t\tthis._sub.position.y = -this._pivot.y;\r\n\t\tthis._sub.position.z = -this._pivot.z;\r\n\t}\r\n\t\r\n\tupdateBoundingBox() {\r\n\t\tthis._three.remove(this._sub);\r\n\t\tsuper.updateBoundingBox();\r\n\t\tthis._three.add(this._sub)\r\n\t}\r\n}","import * as THREE from 'three';\r\nimport { GLTFLoader, GLTF } from 'three/examples/jsm/loaders/GLTFLoader';\r\nimport { View } from './View';\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction resolvePath(path: string, basepath: string) {\r\n\tif (path.indexOf('http://') === 0 || path.indexOf('https://') === 0 || path.indexOf('//') === 0 || path.indexOf('/') === 0) {\r\n\t\treturn path;\r\n\t} else {\r\n\t\treturn basepath.replace(/^(.+)\\/$/, '$1') + '/' + path;\r\n\t}\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction resolveVersion(url: string, version: string) {\r\n\tif (!version) {\r\n\t\treturn url;\r\n\t}\r\n\t\r\n\treturn `${url}${url.match(/\\?/) ? '&' : '?'}_fv=${version}`;\r\n}\r\n\r\nexport interface IAssetDefinitionDictionary<T> {\r\n\t[key: string]: T;\r\n}\r\n\r\nexport interface IAssetDictionary<T> {\r\n\t[key: string]: T;\r\n}\r\n\r\nexport interface ITextureDefinitionDictionary extends IAssetDefinitionDictionary<string> {\r\n\r\n}\r\n\r\nexport interface ITextureDictionary extends IAssetDictionary<THREE.Texture> {\r\n\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction loadTexturesAsync(data: ITextureDefinitionDictionary, basepath: string, version: string): Promise<ITextureDictionary> {\r\n\tconst loader = new THREE.TextureLoader();\r\n\tconst promises: Promise<void>[] = [];\r\n\tconst textures: ITextureDictionary = {};\r\n\t\r\n\tfor (let i in data) {\r\n\t\tpromises.push(\r\n\t\t\tnew Promise<void>((resolve, reject) => {\r\n\t\t\t\tconst url = resolveVersion(resolvePath(data[i], basepath), version);\r\n\t\t\t\tloader.load(url, texture => {\r\n\t\t\t\t\ttextures[i] = texture;\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t}, undefined, e => {\r\n\t\t\t\t\treject(e);\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\t\r\n\treturn Promise.all(promises).then(() => textures);\r\n}\r\n\r\nexport interface IGLTFDefinitionDictionary extends IAssetDefinitionDictionary<string> {\r\n\r\n}\r\n\r\nexport interface IGLTFDictionary extends IAssetDictionary<GLTF> {\r\n\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction loadGLTFsAsync(data: IGLTFDefinitionDictionary, basepath: string, version: string): Promise<IGLTFDictionary> {\r\n\tconst loader = new GLTFLoader();\r\n\tconst promises: Promise<void>[] = [];\r\n\tconst models: IGLTFDictionary = {};\r\n\t\r\n\tfor (let i in data) {\r\n\t\tpromises.push(\r\n\t\t\tnew Promise<void>((resolve, reject) => {\r\n\t\t\t\tconst url = resolveVersion(resolvePath(data[i], basepath), version);\r\n\t\t\t\tloader.load(url, model => {\r\n\t\t\t\t\tmodels[i] = model;\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t}, undefined, e => {\r\n\t\t\t\t\treject(e);\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\t\r\n\treturn Promise.all(promises).then(() => models);\r\n}\r\n\r\nexport interface IAssetLoaderDelegate<T> {\r\n\t(data: { [key: string]: any }, basepath: string, version: string): Promise<IAssetDictionary<T>>;\r\n}\r\n\r\nexport interface IResourceDictionary {\r\n\t[key: string]: IAssetDictionary<any>;\r\n}\r\n\r\nexport interface IVariableDictionary {\r\n\t[key: string]: any;\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst _assetLoaders: { [key: string]: IAssetLoaderDelegate<any> } = {};\r\n\r\nexport class Content {\r\n\tprivate _assetDefines: { [ley: string]: IAssetDictionary<any> } = {};\r\n\tprivate _viewClasses: typeof View[] = [];\r\n\tprivate _vars: IVariableDictionary = {};\r\n\t\r\n\tget viewClasses() {\r\n\t\treturn this._viewClasses;\r\n\t}\r\n\t\r\n\tget vars() {\r\n\t\treturn Object.assign({}, this._vars);\r\n\t}\r\n\t\r\n\tdefineViews(viewClasses: typeof View | typeof View[]) {\r\n\t\tif (!Array.isArray(viewClasses)) {\r\n\t\t\tviewClasses = [ viewClasses ];\r\n\t\t}\r\n\t\t\r\n\t\tviewClasses.forEach(viewClass => {\r\n\t\t\tthis._viewClasses.push(viewClass);\r\n\t\t});\r\n\t}\r\n\t\r\n\tdefineAssets<T>(key: string, data: IAssetDefinitionDictionary<T>) {\r\n\t\tthis._assetDefines[key] = this._assetDefines[key] || {};\r\n\t\t\r\n\t\tfor (let i in data) {\r\n\t\t\tthis._assetDefines[key][i] = data[i];\r\n\t\t}\r\n\t}\r\n\t\r\n\tdefineTextures(data: ITextureDefinitionDictionary) {\r\n\t\tthis.defineAssets<string>('textures', data);\r\n\t}\r\n\t\r\n\tdefineGLBs(data: IGLTFDefinitionDictionary) {\r\n\t\tthis.defineAssets<string>('glbs', data);\r\n\t}\r\n\t\r\n\tloadAssetsAsync(basepath: string, version: string) {\r\n\t\tconst promises: Promise<IAssetDictionary<any>>[] = [];\r\n\t\tconst resources: IResourceDictionary = {};\r\n\t\t\r\n\t\tfor (let i in this._assetDefines) {\r\n\t\t\tif (!(i in _assetLoaders)) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tpromises.push(\r\n\t\t\t\t_assetLoaders[i](this._assetDefines[i], basepath, version)\r\n\t\t\t\t\t.then((assets: IAssetDictionary<any>) => {\r\n\t\t\t\t\t\treturn resources[i] = assets;\r\n\t\t\t\t\t})\r\n\t\t\t);\r\n\t\t}\r\n\t\t\r\n\t\treturn Promise.all(promises).then(() => resources);\r\n\t}\r\n\t\r\n\tdefineVars(data: IVariableDictionary) {\r\n\t\tfor (let i in data) {\r\n\t\t\tthis._vars[i] = data[i];\r\n\t\t}\r\n\t}\r\n\t\r\n\tstatic registerLoader<T>(key: string, delegate: IAssetLoaderDelegate<T>) {\r\n\t\t_assetLoaders[key] = delegate;\r\n\t}\r\n}\r\n\r\nContent.registerLoader<THREE.Texture>('textures', loadTexturesAsync);\r\nContent.registerLoader<GLTF>('glbs', loadGLTFsAsync);","import * as THREE from 'three';\r\nimport { Object3D } from './Object3D';\r\nimport { Anchor } from './Anchor';\r\nimport { IMesh } from './IMesh'\r\n\r\nexport class Mesh extends Object3D<THREE.Mesh> implements IMesh {\r\n\tprivate _anchor: Anchor;\r\n\t\r\n\tconstructor(geometry: THREE.BufferGeometry, material: THREE.Material) {\r\n\t\tsuper(new THREE.Mesh(geometry, material));\r\n\t\t\r\n\t\tthis._anchor = new Anchor(0, 0, 0, this);\r\n\t\tmaterial.transparent = true;\r\n\t\tthis.updateGeometryPosition();\r\n\t}\r\n\t\r\n\tget anchor() {\r\n\t\treturn this._anchor;\r\n\t}\r\n\t\r\n\tupdateGeometryPosition() {\r\n\t\tthis._three.geometry.center();\r\n\t\tthis.updateBoundingBox();\r\n\t\tthis._three.geometry.translate(this._size.x * (0.5 - this._anchor.x), this._size.y * (0.5 - this._anchor.y), this._size.z * (0.5 - this._anchor.z))\r\n\t}\r\n\t\r\n\tupdateBoundingBox() {\r\n\t\tthis._three.geometry.computeBoundingBox();\r\n\t\tthis._three.geometry.boundingBox && this._three.geometry.boundingBox.getSize(this._size);\r\n\t\tthis._size.multiply(this.scale);\r\n\t}\r\n}","import * as THREE from 'three';\r\nimport { Object3D } from './Object3D';\r\nimport OIMO from './OIMO';\r\nimport { BodyPosition } from './BodyPosition';\r\nimport { BodyRotation } from './BodyRotation';\r\n\r\nexport class PhysicsObject3D extends Object3D<THREE.Object3D> {\r\n\tprotected _body: OIMO.RigidBody;\r\n\tprotected _contactEnabled: boolean = false;\r\n\tprotected _position: BodyPosition;\r\n\tprotected _rotation: BodyRotation;\r\n\t\r\n\tconstructor(three: THREE.Object3D, body: OIMO.RigidBody) {\r\n\t\tsuper(three);\r\n\t\t\r\n\t\tthis._body = body;\r\n\t\tthis._position = new BodyPosition(this);\r\n\t\tthis._rotation = new BodyRotation(this);\r\n\t\t\r\n\t\tbody.userData.ref = this;\r\n\t}\r\n\t\r\n\tget body() {\r\n\t\treturn this._body;\r\n\t}\r\n\t\r\n\tget x() {\r\n\t\treturn this._position.x;\r\n\t}\r\n\t\r\n\tset x(value) {\r\n\t\tthis._position.x = value;\r\n\t}\r\n\t\r\n\tget y() {\r\n\t\treturn this._position.y;\r\n\t}\r\n\t\r\n\tset y(value) {\r\n\t\tthis._position.y = value;\r\n\t}\r\n\t\r\n\tget z() {\r\n\t\treturn this._position.z;\r\n\t}\r\n\t\r\n\tset z(value) {\r\n\t\tthis._position.z = value;\r\n\t}\r\n\t\r\n\tget position() {\r\n\t\treturn this._position;\r\n\t}\r\n\t\r\n\t// @ts-ignore\r\n\tget rotation() {\r\n\t\treturn this._rotation;\r\n\t}\r\n\t\r\n\tupdateTransform() {\r\n\t\tthis._three.position.copy(this._body.getPosition());\r\n\t\tthis._three.quaternion.copy(this._body.getOrientation());\r\n\t}\r\n\t\r\n\tsetCollisionGroup(collisionGroup: number) {\r\n\t\tthis._body.setCollisionGroup(collisionGroup);\r\n\t}\r\n\t\r\n\taddCollisionGroup(collisionGroup: number) {\r\n\t\tthis._body.addCollisionGroup(collisionGroup);\r\n\t}\r\n\t\r\n\tremoveCollisionGroup(collisionGroup: number) {\r\n\t\tthis._body.removeCollisionGroup(collisionGroup);\r\n\t}\r\n\t\r\n\tsetCollisionMask(collisionMask: number) {\r\n\t\tthis._body.setCollisionMask(collisionMask);\r\n\t}\r\n\t\r\n\taddCollisionMask(collisionMask: number) {\r\n\t\tthis._body.addCollisionMask(collisionMask);\r\n\t}\r\n\t\r\n\tremoveCollisionMask(collisionMask: number) {\r\n\t\tthis._body.removeCollisionMask(collisionMask);\r\n\t}\r\n}","import * as THREE from 'three';\r\nimport { Object3D } from './Object3D';\r\nimport { Camera } from './Camera';\r\nimport { IInteractionEvent } from './InteractionManager';\r\nimport { ITickerData } from './DisplayObject';\r\nimport { IDeliverData } from './IDeliverData';\r\n\r\nexport class View extends Object3D<THREE.Scene> {\r\n\tprivate _cameras: Camera[] = [];\r\n\t\r\n\tconstructor($?: IDeliverData) {\r\n\t\tsuper(new THREE.Scene());\r\n\t\t\r\n\t\tthis.interactive = true;\r\n\t}\r\n\t\r\n\tget scene() {\r\n\t\treturn this._three;\r\n\t}\r\n\t\r\n\taddCamera(camera: Camera) {\r\n\t\tif (camera.parent) {\r\n\t\t\tcamera.parent.removeChild(camera);\r\n\t\t}\r\n\t\t\r\n\t\tthis._cameras.push(camera);\r\n\t\tthis._three.add(camera.three);\r\n\t\tcamera.three.userData.parent = this;\r\n\t\t\r\n\t\treturn camera;\r\n\t}\r\n\t\r\n\tremoveCamera(camera: Camera) {\r\n\t\tif (camera.parent !== this) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tconst index = this._cameras.indexOf(camera);\r\n\t\tif (index === -1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._cameras.splice(index, 1);\r\n\t\tthis._three.remove(camera.three);\r\n\t\tcamera.three.userData.parent = null;\r\n\t\t\r\n\t\treturn camera;\r\n\t}\r\n\t\r\n\tadd(three: THREE.Object3D) {\r\n\t\tthis._three.add(three);\r\n\t\t\r\n\t\treturn three;\r\n\t}\r\n\t\r\n\tremove(three: THREE.Object3D) {\r\n\t\tthis._three.remove(three);\r\n\t\t\r\n\t\treturn three;\r\n\t}\r\n\t/*\r\n\tupdate(e: ITickerData) {\r\n\t\tthis.updateTask(e);\r\n\t\t\r\n\t\tconst c = this._children;\r\n\t\tfor (let i in this._children) {\r\n\t\t\tc[i].update(e);\r\n\t\t}\r\n\t}\r\n\t*/\r\n\trender(renderer: THREE.WebGLRenderer) {\r\n\t\tconst c = this._cameras;\r\n\t\t\r\n\t\tfor (let i = 0; i < c.length; i++) {\r\n\t\t\trenderer.clearDepth();\r\n\t\t\tc[i].render(renderer, this._three);\r\n\t\t}\r\n\t}\r\n\t\r\n\tonInteraction(event: IInteractionEvent, raycaster: THREE.Raycaster, mouse: THREE.Vector2) {\r\n\t\tif (!this.interactive) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tconst c = this._cameras;\r\n\t\t\r\n\t\tfor (let i = 0; i < c.length; i++) {\r\n\t\t\tif (event.emitted.length > 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\traycaster.setFromCamera(mouse, c[i].camera);\r\n\t\t\t\r\n\t\t\tconst f: (p: THREE.Object3D) => THREE.Object3D[] = (p: THREE.Object3D) => {\r\n\t\t\t\treturn p.children.map(p => {\r\n\t\t\t\t\tif (p instanceof THREE.Mesh) {\r\n\t\t\t\t\t\treturn p;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn f(p);\r\n\t\t\t\t}).flat();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst meshes = f(this._three);\r\n\t\t\t\r\n\t\t\tconst intersects = raycaster.intersectObjects(meshes);\r\n\t\t\t\r\n\t\t\tfor (let i = 0; i < intersects.length; i++) {\r\n\t\t\t\tif (event.emitted.length > 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tlet p = intersects[i].object;\r\n\t\t\t\twhile (p !== this._three) {\r\n\t\t\t\t\tp.dispatchEvent(event);\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (!p.parent) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tp = p.parent;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tupdateTransform() {\r\n\t\r\n\t}\r\n}\r\n","declare namespace OIMO {\r\n\tclass CommonConstructor {\r\n\t\tconstructor(...args: any[]);\r\n\t\t[key: string]: any;\r\n\t}\r\n\t\r\n\texport class World extends CommonConstructor {}\r\n\t\r\n\texport class RigidBody extends CommonConstructor {}\r\n\t\r\n\texport class RigidBodyConfig extends CommonConstructor {}\r\n\t\r\n\texport class Shape extends CommonConstructor {}\r\n\t\r\n\texport class ShapeConfig extends CommonConstructor {}\r\n\t\r\n\texport class ContactCallback extends CommonConstructor {}\r\n\t\r\n\texport class AabbTestCallback extends CommonConstructor {}\r\n\t\r\n\texport class Vec3 extends CommonConstructor {}\r\n\t\r\n\texport namespace RigidBodyType {\r\n\t\texport const STATIC: number;\r\n\t\texport const DYNAMIC: number;\r\n\t\texport const KINEMATIC: number;\r\n\t}\r\n}\r\n\r\nexport default OIMO;","import * as THREE from 'three';\r\nimport { View } from './View';\r\nimport { ITickerData } from './DisplayObject';\r\nimport { PhysicsObject3D } from './PhysicsObject3D';\r\nimport { Shape, SensoredShape } from './Shape';\r\nimport OIMO from './OIMO';\r\n\r\nexport class PhysicsView extends View {\r\n\tprivate _world: any;\r\n\tprivate _sensoredShapes: SensoredShape[] = [];\r\n\tprivate _onShapeAdded: (shape: SensoredShape) => void;\r\n\tprivate _onShapeRemoved: (shape: SensoredShape) => void;\r\n\tdeclare protected _children: PhysicsObject3D[];\r\n\tphysicsEnabled: boolean = true;\r\n\t\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis._world = new OIMO.World();\r\n\t\tthis._world.setGravity(new OIMO.Vec3(0, -9.8, 0));\r\n\t\t\r\n\t\tthis._onShapeAdded = (shape: SensoredShape) => {\r\n\t\t\tconst index = this._sensoredShapes.indexOf(shape);\r\n\t\t\tif (index === -1) {\r\n\t\t\t\tthis._sensoredShapes.push(shape);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tthis._onShapeRemoved = (shape: SensoredShape) => {\r\n\t\t\tconst index = this._sensoredShapes.indexOf(shape);\r\n\t\t\tif (index > -1) {\r\n\t\t\t\tthis._sensoredShapes.splice(index, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tget world() {\r\n\t\treturn this._world;\r\n\t}\r\n\t\r\n\tget children() {\r\n\t\treturn this._children;\r\n\t}\r\n\t\r\n\taddChild(object: PhysicsObject3D) {\r\n\t\tsuper.addChild(object);\r\n\t\t\r\n\t\tthis._world.addRigidBody(object.body);\r\n\t\t\r\n\t\tconst sensoredShapes = object.body.getSensoredShapeList();\r\n\t\tfor (let i = 0; i < sensoredShapes.length; i++) {\r\n\t\t\tthis._onShapeAdded(sensoredShapes[i]);\r\n\t\t}\r\n\t\t\r\n\t\tobject.body.on('sensoredShapeAdded', this._onShapeAdded);\r\n\t\tobject.body.on('sensoredShapeRemoved', this._onShapeRemoved);\r\n\t\t\r\n\t\treturn object;\r\n\t}\r\n\t\r\n\tremoveChild(object: PhysicsObject3D) {\r\n\t\tconst o = super.removeChild(object);\r\n\t\t\r\n\t\tif (!o) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._world.removeRigidBody(object.body);\r\n\t\t\r\n\t\tconst sensoredShapes = object.body.getSensoredShapeList();\r\n\t\tfor (let i = 0; i < sensoredShapes.length; i++) {\r\n\t\t\tthis._onShapeRemoved(sensoredShapes[i]);\r\n\t\t}\r\n\t\t\r\n\t\tobject.body.off('sensoredShapeAdded', this._onShapeAdded);\r\n\t\tobject.body.off('sensoredShapeRemoved', this._onShapeRemoved);\r\n\t\t\r\n\t\treturn o;\r\n\t}\r\n\t\r\n\tupdate(e: ITickerData, taskDisabledChildren: boolean) {\r\n\t\tif (this.physicsEnabled) {\r\n\t\t\tthis._world.step(1 / 60);\r\n\t\t\t\r\n\t\t\t/*\r\n\t\t\tlet body = this._world.getRigidBodyList();\r\n\t\t\twhile (body) {\r\n\t\t\t\tconst object = body.userData.ref;\r\n\t\t\t\tif (object.sensorEnabled) {\r\n\t\t\t\t\tobject.aabbTest(this._world);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tbody = body.getNext();\r\n\t\t\t}\r\n\t\t\t*/\r\n\t\t\t\r\n\t\t\tfor (let i = 0; i < this._sensoredShapes.length; i++) {\r\n\t\t\t\tthis._sensoredShapes[i].aabbTest(this._world);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tsuper.update(e, taskDisabledChildren);\r\n\t}\r\n}\r\n","import OIMO from './OIMO';\r\nimport { PhysicsObject3D } from './PhysicsObject3D';\r\nimport { RigidBody } from './RigidBody';\r\nimport { Emitter, IEmitterDelegate } from '@tawaship/emitter';\r\n\r\nexport interface IContactData {\r\n\thit: Shape;\r\n\toriginalEvent: any;\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst contactCallback = new OIMO.ContactCallback();\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction contactHandler(type: string, e: any) {\r\n\tconst selfShape: Shape = e.getShape1();\r\n\tconst opponentShape: Shape = e.getShape2();\r\n\t\r\n\tevent.originalEvent = e;\r\n\tevent.hit = opponentShape;\r\n\tselfShape.emit(type, event);\r\n}\r\n\r\ncontactCallback.beginContact = (e: any) => {\r\n\tcontactHandler('beginContact', e);\r\n};\r\ncontactCallback.endContact = (e: any) => {\r\n\tcontactHandler('endContact', e);\r\n};\r\ncontactCallback.preSolve = (e: any) => {\r\n\tcontactHandler('preSolve', e);\r\n};\r\ncontactCallback.postSolve = (e: any) => {\r\n\tcontactHandler('postSolve', e);\r\n};\r\n\r\nexport class Shape extends OIMO.Shape {\r\n\tprotected _collisionGroup: number;\r\n\tprotected _collisionMask: number;\r\n\tprotected _collisionEnabled: boolean = true;\r\n\tprotected _contactEnabled: boolean = false;\r\n\tprivate _emitter: Emitter = new Emitter();\r\n\t\r\n\tconstructor(shapeConfig: OIMO.ShapeConfig) {\r\n\t\tsuper(shapeConfig);\r\n\t\t\r\n\t\tthis._collisionGroup = this.getCollisionGroup();\r\n\t\tthis._collisionMask = this.getCollisionMask();\r\n\t\t\r\n\t\tthis._updateCollisionGroup();\r\n\t\tthis._updateCollisionMask();\r\n\t}\r\n\t\r\n\ton(type: string, callback: IEmitterDelegate) {\r\n\t\tthis._emitter.on(type, callback);\r\n\t}\r\n\t\r\n\toff(type: string, callback: IEmitterDelegate) {\r\n\t\tthis._emitter.off(type, callback);\r\n\t}\r\n\t\r\n\temit(type: string, ...args: any[]) {\r\n\t\tthis._emitter.cemit(type, this, ...args);\r\n\t}\r\n\t\r\n\tget collisionGroup() {\r\n\t\treturn this._collisionGroup;\r\n\t}\r\n\t\r\n\tget collisionMask() {\r\n\t\treturn this._collisionMask;\r\n\t}\r\n\t\r\n\tget collisionEnabled() {\r\n\t\treturn this._collisionEnabled;\r\n\t}\r\n\t\r\n\tset collisionEnabled(value: boolean) {\r\n\t\tthis._collisionEnabled = value;\r\n\t\t\r\n\t\tthis._updateCollisionGroup();\r\n\t\tthis._updateCollisionMask();\r\n\t}\r\n\t\r\n\tget contectEnabled() {\r\n\t\treturn this._contactEnabled;\r\n\t}\r\n\t\r\n\tset contactEnabled(value: boolean) {\r\n\t\tthis._contactEnabled = value;\r\n\t\t\r\n\t\tif (value) {\r\n\t\t\tthis.setContactCallback(contactCallback);\r\n\t\t} else {\r\n\t\t\tthis.setContactCallback(null);\r\n\t\t}\r\n\t}\r\n\t\r\n\tsetCollisionGroup(collisionGroup: number) {\r\n\t\tthis._collisionGroup = collisionGroup;\r\n\t\t\r\n\t\tthis._updateCollisionGroup();\r\n\t}\r\n\t\r\n\taddCollisionGroup(collisionGroup: number) {\r\n\t\tthis._collisionGroup |= collisionGroup;\r\n\t\t\r\n\t\tthis._updateCollisionGroup();\r\n\t}\r\n\t\r\n\tremoveCollisionGroup(collisionGroup: number) {\r\n\t\tthis._collisionGroup ^= this._collisionGroup & collisionGroup;\r\n\t\t\r\n\t\tthis._updateCollisionGroup();\r\n\t}\r\n\t\r\n\tsetCollisionMask(collisionMask: number) {\r\n\t\tthis._collisionMask = collisionMask;\r\n\t\t\r\n\t\tthis._updateCollisionMask();\r\n\t}\r\n\t\r\n\taddCollisionMask(collisionMask: number) {\r\n\t\tthis._collisionMask |= collisionMask;\r\n\t\t\r\n\t\tthis._updateCollisionMask();\r\n\t}\r\n\t\r\n\tremoveCollisionMask(collisionMask: number) {\r\n\t\tthis._collisionMask ^= this._collisionMask & collisionMask;\r\n\t\t\r\n\t\tthis._updateCollisionMask();\r\n\t}\r\n\t\r\n\tprotected _setCollisionGroup(collisionGroup: number) {\r\n\t\tsuper.setCollisionGroup(collisionGroup);\r\n\t}\r\n\t\r\n\tprotected _setCollisionMask(collisionMask: number) {\r\n\t\tsuper.setCollisionMask(collisionMask);\r\n\t}\r\n\t\r\n\tprotected _updateCollisionGroup() {\r\n\t\tif (!this._collisionEnabled) {\r\n\t\t\tthis._setCollisionGroup(0);\r\n\t\t} else {\r\n\t\t\tthis._setCollisionMask(this._collisionGroup);\r\n\t\t}\r\n\t}\r\n\t\r\n\tprotected _updateCollisionMask() {\r\n\t\tif (!this._collisionEnabled) {\r\n\t\t\tthis._setCollisionMask(0);\r\n\t\t} else {\r\n\t\t\tthis._setCollisionMask(this._collisionMask);\r\n\t\t}\r\n\t}\r\n\t\r\n\tgetObject() {\r\n\t\tconst body = this.getRigidBody();\r\n\t\tif (!body) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\treturn body.getObject();\r\n\t}\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst event: IContactData = { hit: new Shape(new OIMO.ShapeConfig()), originalEvent: null };\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction sensorHandler(type: string, selfShape: SensoredShape, opponentShape: Shape) {\r\n\tevent.originalEvent = null;\r\n\tevent.hit = opponentShape;\r\n\tselfShape.emit(type, event);\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction getObject(shape: SensoredShape) {\r\n\tconst body = shape.getRigidBody();\r\n\tif (!body) {\r\n\t\treturn;\r\n\t}\r\n\t\r\n\treturn body.getObject();\r\n}\r\n\r\nexport class SensoredShape extends Shape {\r\n\tprivate _sensorEnabled: boolean = true;\r\n\tprotected _aabbTestCallback: OIMO.AabbTestCallback = new OIMO.AabbTestCallback();\r\n\tprotected _touchedShapes: Shape[] = [];\r\n\tprotected _touchShapes: Shape[] = [];\r\n\t\r\n\tconstructor(shapeConfig: OIMO.ShapeConfig) {\r\n\t\tsuper(shapeConfig);\r\n\t\t\r\n\t\tthis.contactEnabled = true;\r\n\t\t\r\n\t\tthis._updateCollisionGroup();\r\n\t\tthis._updateCollisionMask();\r\n\t\t\r\n\t\tthis._aabbTestCallback.process = (shape: Shape) => {\r\n\t\t\tif ((this._collisionMask & shape.collisionGroup) === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif ((this._collisionGroup & shape.collisionMask) === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst index = this._touchedShapes.indexOf(shape);\r\n\t\t\tif (index === -1) {\r\n\t\t\t\tsensorHandler('beginContact', this, shape);\r\n\t\t\t} else {\r\n\t\t\t\tthis._touchedShapes.splice(index, 1);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._touchShapes.push(shape);\r\n\t\t};\r\n\t}\r\n\t\r\n\tget sensorEnabled() {\r\n\t\treturn this._sensorEnabled;\r\n\t}\r\n\t\r\n\tset sensorEnabled(value: boolean) {\r\n\t\tthis._sensorEnabled = value;\r\n\t\t\r\n\t\tthis._updateCollisionGroup();\r\n\t\tthis._updateCollisionMask();\r\n\t}\r\n\t\r\n\tget isSensor() {\r\n\t\treturn this._collisionEnabled && this._contactEnabled && this._sensorEnabled;\r\n\t}\r\n\t\r\n\taabbTest(world: OIMO.World) {\r\n\t\tif (!this.isSensor) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._touchedShapes = this._touchShapes;\r\n\t\tthis._touchShapes = [];\r\n\t\t\r\n\t\tworld.aabbTest(this.getAabb(), this._aabbTestCallback);\r\n\t\t\r\n\t\tfor (let i = 0; i < this._touchedShapes.length; i++) {\r\n\t\t\tsensorHandler('endContact', this, this._touchedShapes[i]);\r\n\t\t}\r\n\t}\r\n\t\r\n\tprotected _updateCollisionGroup() {\r\n\t\tif (!this._collisionEnabled) {\r\n\t\t\tthis._setCollisionGroup(0);\r\n\t\t} else if (this._sensorEnabled) {\r\n\t\t\tthis._setCollisionGroup(0);\r\n\t\t} else {\r\n\t\t\tthis._setCollisionGroup(this._collisionGroup);\r\n\t\t}\r\n\t}\r\n\t\r\n\tprotected _updateCollisionMask() {\r\n\t\tif (!this._collisionEnabled) {\r\n\t\t\tthis._setCollisionMask(0);\r\n\t\t} else if (this._sensorEnabled) {\r\n\t\t\tthis._setCollisionMask(0);\r\n\t\t} else {\r\n\t\t\tthis._setCollisionMask(this._collisionMask);\r\n\t\t}\r\n\t}\r\n}","import OIMO from './OIMO';\r\nimport { Shape, SensoredShape } from './Shape';\r\nimport { PhysicsObject3D } from './PhysicsObject3D';\r\nimport { Emitter, IEmitterDelegate } from '@tawaship/emitter';\r\n\r\nexport class RigidBody extends OIMO.RigidBody {\r\n\tprivate _emitter: Emitter = new Emitter();\r\n\t\r\n\tdeclare userData: { ref: PhysicsObject3D | null };\r\n\t\r\n\tconstructor(rigidBodyConfig: OIMO.RigidBodyConfig) {\r\n\t\tsuper(rigidBodyConfig);\r\n\t\t\r\n\t\tthis.userData = { ref: null };\r\n\t}\r\n\t\r\n\tgetObject(): PhysicsObject3D | null {\r\n\t\treturn this.userData.ref;\r\n\t}\r\n\t\r\n\ton(type: string, callback: IEmitterDelegate) {\r\n\t\tthis._emitter.on(type, callback);\r\n\t}\r\n\t\r\n\toff(type: string, callback: IEmitterDelegate) {\r\n\t\tthis._emitter.off(type, callback);\r\n\t}\r\n\t\r\n\temit(type: string, ...args: any[]) {\r\n\t\tthis._emitter.cemit(type, this, ...args);\r\n\t}\r\n\t\r\n\tgetSensoredShapeList(): SensoredShape[] {\r\n\t\tconst res: SensoredShape[] = [];\r\n\t\t\r\n\t\tlet shape = this.getShapeList();\r\n\t\twhile (shape) {\r\n\t\t\tif (shape instanceof SensoredShape) {\r\n\t\t\t\tres.push(shape);\r\n\t\t\t}\r\n\t\t\tshape = shape.getNext();\r\n\t\t}\r\n\t\t\r\n\t\treturn res;\r\n\t}\r\n\t\r\n\taddShape(shape: Shape | SensoredShape) {\r\n\t\tsuper.addShape(shape);\r\n\t\t\r\n\t\tif (shape instanceof SensoredShape) {\r\n\t\t\tthis.emit('sensoredShapeAdded', shape);\r\n\t\t}\r\n\t}\r\n\t\r\n\tremoveShape(shape: Shape | SensoredShape) {\r\n\t\tsuper.removeShape(shape);\r\n\t\t\r\n\t\tif (shape instanceof SensoredShape) {\r\n\t\t\tthis.emit('sensoredShapeRemoved', shape);\r\n\t\t}\r\n\t}\r\n\t\r\n\tsetCollisionGroup(collisionGroup: number) {\r\n\t\tlet shape = this.getShapeList();\r\n\t\twhile (shape) {\r\n\t\t\tshape.setCollisionGroup(collisionGroup);\r\n\t\t\t\r\n\t\t\tshape = shape.getNext();\r\n\t\t}\r\n\t}\r\n\t\r\n\taddCollisionGroup(collisionGroup: number) {\r\n\t\tlet shape = this.getShapeList();\r\n\t\twhile (shape) {\r\n\t\t\tlet t = shape.getCollisionGroup();\r\n\t\t\tt |= collisionGroup;\r\n\t\t\tshape.setCollisionGroup(t);\r\n\t\t\t\r\n\t\t\tshape = shape.getNext();\r\n\t\t}\r\n\t}\r\n\t\r\n\tremoveCollisionGroup(collisionGroup: number) {\r\n\t\tlet shape = this.getShapeList();\r\n\t\twhile (shape) {\r\n\t\t\tlet t = shape.getCollisionGroup();\r\n\t\t\tt ^= t & collisionGroup;\r\n\t\t\tshape.setCollisionGroup(t);\r\n\t\t\t\r\n\t\t\tshape = shape.getNext();\r\n\t\t}\r\n\t}\r\n\t\r\n\tsetCollisionMask(collisionMask: number) {\r\n\t\tlet shape = this.getShapeList();\r\n\t\twhile (shape) {\r\n\t\t\tshape.setCollisionMask(collisionMask);\r\n\t\t\t\r\n\t\t\tshape = shape.getNext();\r\n\t\t}\r\n\t}\r\n\t\r\n\taddCollisionMask(collisionMask: number) {\r\n\t\tlet shape = this.getShapeList();\r\n\t\twhile (shape) {\r\n\t\t\tlet t = shape.getCollisionMask();\r\n\t\t\tt |= collisionMask;\r\n\t\t\tshape.setCollisionMask(t);\r\n\t\t\t\r\n\t\t\tshape = shape.getNext();\r\n\t\t}\r\n\t}\r\n\t\r\n\tremoveCollisionMask(collisionMask: number) {\r\n\t\tlet shape = this.getShapeList();\r\n\t\twhile (shape) {\r\n\t\t\tlet t = shape.getCollisionMask();\r\n\t\t\tt ^= t & collisionMask;\r\n\t\t\tshape.setCollisionMask(t);\r\n\t\t\t\r\n\t\t\tshape = shape.getNext();\r\n\t\t}\r\n\t}\r\n\t\r\n\tstatic createStatic() {\r\n\t\tconst rigidBodyConfig = new OIMO.RigidBodyConfig();\r\n\t\trigidBodyConfig.type = OIMO.RigidBodyType.STATIC;\r\n\t\t\r\n\t\treturn new RigidBody(rigidBodyConfig);\r\n\t}\r\n\t\r\n\tstatic createDynamic() {\r\n\t\tconst rigidBodyConfig = new OIMO.RigidBodyConfig();\r\n\t\trigidBodyConfig.type = OIMO.RigidBodyType.DYNAMIC;\r\n\t\t\r\n\t\treturn new RigidBody(rigidBodyConfig);\r\n\t}\r\n\t\r\n\tstatic createKinematic() {\r\n\t\tconst rigidBodyConfig = new OIMO.RigidBodyConfig();\r\n\t\trigidBodyConfig.type = OIMO.RigidBodyType.KINEMATIC;\r\n\t\t\r\n\t\treturn new RigidBody(rigidBodyConfig);\r\n\t}\r\n}","import * as THREE from 'three';\r\nimport { Object2D } from './Object2D';\r\nimport { Anchor } from './Anchor';\r\nimport { IMesh } from './IMesh'\r\n\r\nexport class Sprite extends Object2D<THREE.Mesh> implements IMesh {\r\n\tprivate _texture: THREE.Texture;\r\n\tprivate _anchor: Anchor;\r\n\tprivate _material: THREE.MeshBasicMaterial;\r\n\tprivate _width: number = 0;\r\n\tprivate _height: number = 0;\r\n\t\r\n\tconstructor(texture: THREE.Texture) {\r\n\t\tsuper(new THREE.Mesh());\r\n\t\t\r\n\t\tthis._anchor = new Anchor(0, 0, 0, this);\r\n\t\t\r\n\t\tthis._material = new THREE.MeshBasicMaterial();\r\n\t\tthis._material.transparent = true;\r\n\t\t\r\n\t\tthis._three.material = this._material;\r\n\t\t\r\n\t\tthis._texture = texture;\r\n\t\tthis.texture = texture;\r\n\t}\r\n\t\r\n\tget texture() {\r\n\t\treturn this._texture;\r\n\t}\r\n\t\r\n\tset texture(texture) {\r\n\t\tthis._texture = texture;\r\n\t\tthis._material.needsUpdate = true;\r\n\t\tthis._material.map = texture;\r\n\t\t\r\n\t\tif (texture && texture.image) {\r\n\t\t\tthis._updateGeometry(texture.image.width, texture.image.height);\r\n\t\t} else {\r\n\t\t\tthis._updateGeometry(0, 0);\r\n\t\t}\r\n\t}\r\n\t\r\n\tget anchor() {\r\n\t\treturn this._anchor;\r\n\t}\r\n\t\r\n\t_updateGeometry(width: number, height: number) {\r\n\t\tthis._three.geometry = new THREE.PlaneGeometry(width, height);\r\n\t\tthis._width = width;\r\n\t\tthis._height = height;\r\n\t\tthis.updateGeometryPosition();\r\n\t}\r\n\t\r\n\tupdateGeometryPosition() {\r\n\t\tthis._three.geometry.center();\r\n\t\tthis._three.geometry.translate(this._width * (0.5 - this._anchor.x), this._height * (0.5 - this._anchor.y), 0)\r\n\t}\r\n\t\r\n\tupdateBoundingBox() {\r\n\t\tthis._three.geometry.computeBoundingBox();\r\n\t\tthis._three.geometry.boundingBox && this._three.geometry.boundingBox.getSize(this._size);\r\n\t\tthis._size.multiply(this.scale);\r\n\t}\r\n\t\r\n\tstatic from(url: string, callback: (sprite: Sprite) => void) {\r\n\t\tconst sprite = new Sprite(new THREE.TextureLoader().load(url, texture => {\r\n\t\t\tsprite.texture = texture;\r\n\t\t\tcallback && callback(sprite);\r\n\t\t}));\r\n\t\t\r\n\t\treturn sprite;\r\n\t}\r\n}"],"names":["Anchor","x","y","z","mesh","this","_x","_y","_z","_mesh","prototypeAccessors","value","updateGeometryPosition","set","undefined","appleIphone","appleIpod","appleTablet","appleUniversal","androidPhone","androidTablet","amazonPhone","amazonTablet","windowsPhone","windowsTablet","otherBlackBerry","otherBlackBerry10","otherOpera","otherChrome","otherFirefox","isAppleTabletOnIos13","navigator","platform","maxTouchPoints","MSStream","Emitter","_events","_on","type","callback","once","const","events","i","length","push","on","off","splice","_emit","context","targets","event","let","apply","args","emit","cemit","_emitAll","emitAll","cemitAll","clear","isSP","param","nav","userAgent","tmp","split","match","regex","test","createMatch","result","apple","phone","ipod","tablet","universal","device","amazon","android","windows","other","blackberry","blackberry10","opera","firefox","chrome","any","isMobile","separate","_first","_emitted","first","concat","emitted","both","p","index","indexOf","dispatch","InteractionManager","THREE.Vector2","originalEvent","_cast","e","width","height","_event","_mouse","onDown","_down","interactive","interactiveDown","onMove","interactiveMove","_over","saparated","onUp","interactiveUp","addCanvas","canvas","addEventListener","touches","clientX","offsetLeft","clientY","offsetTop","offsetWidth","offsetHeight","changedTouches","offsetX","offsetY","Application","options","container","document","body","rendererOptions","alpha","transparent","antialias","renderer","THREE.WebGLRenderer","resolution","backgroundColor","autoAdjust","basepath","version","setClearColor","setSize","setPixelRatio","autoClear","_container","_renderer","_rendererSize","_basepath","_version","domElement","style","position","raycaster","THREE.Raycaster","_interactionManager","mouse","c","_views","onInteraction","window","_lastTime","timeStamp","step","timestamp","delta","_playing","update","requestAnimationFrame","autoAdjuster","fullScreen","attachAsync","content","loadAssetsAsync","then","resources","vars","$","viewClasses","addView","interactionManager","element","view","removeView","play","appendChild","start","stop","render","setViewport","_autoAdjuster","removeEventListener","rect","r","innerWidth","innerHeight","adjustHeight","toCenter","toTop","adjustWidth","toMiddle","toLeft","w","h","horizontal","hol","left","_getViewRect","toRight","vertical","ver","top","toBottom","parseInt","replace","BodyPosition","object","_object","getPosition","setPosition","updateTransform","BodyRotation","getRotation","toEulerXyz","rotation","setRotationXyz","Task","callbacks","_taskData","enabled","add","Array","isArray","list","Function","done","task","_to","Number","prev","next","to","finish","reset","destroy","_box","THREE.Box3","DisplayObject","three","super","THREE.Vector3","_three","_sub","_task","taskEnabled","parent","userData","children","_children","updateTask","updateBoundingBox","_size","depth","scale","pivot","_pivot","taskDisabledChildren","taskEnabledChildren","setFromObject","getSize","multiply","addChild","removeChild","remove","Object3D","Camera","camera","viewport","_viewport","scene","Object2D","matrixAutoUpdate","skew","_skew","_updateMatrix","scaleX","scaleY","skewX","skewY","pivotX","pivotY","a","Math","cos","b","sin","d","tx","ty","matrix","Container2D","THREE.Group","_updateOrder","Container3D","resolvePath","path","resolveVersion","url","_assetLoaders","Content","_viewClasses","Object","assign","_vars","defineViews","forEach","viewClass","defineAssets","key","data","_assetDefines","defineTextures","defineGLBs","promises","assets","Promise","all","defineVars","registerLoader","delegate","loader","THREE.TextureLoader","textures","resolve","reject","load","texture","GLTFLoader","models","model","Mesh","geometry","material","THREE.Mesh","_anchor","anchor","center","translate","computeBoundingBox","boundingBox","PhysicsObject3D","_body","_position","_rotation","ref","copy","quaternion","getOrientation","setCollisionGroup","collisionGroup","addCollisionGroup","removeCollisionGroup","setCollisionMask","collisionMask","addCollisionMask","removeCollisionMask","View","THREE.Scene","addCamera","_cameras","removeCamera","clearDepth","setFromCamera","f","map","flat","meshes","intersects","intersectObjects","dispatchEvent","OIMO","PhysicsView","_world","World","setGravity","Vec3","_onShapeAdded","shape","_sensoredShapes","_onShapeRemoved","world","addRigidBody","sensoredShapes","getSensoredShapeList","o","removeRigidBody","physicsEnabled","aabbTest","contactCallback","ContactCallback","contactHandler","selfShape","getShape1","opponentShape","getShape2","hit","beginContact","endContact","preSolve","postSolve","Shape","shapeConfig","_collisionGroup","getCollisionGroup","_collisionMask","getCollisionMask","_updateCollisionGroup","_updateCollisionMask","_emitter","collisionEnabled","_collisionEnabled","contectEnabled","_contactEnabled","contactEnabled","setContactCallback","_setCollisionGroup","_setCollisionMask","getObject","getRigidBody","ShapeConfig","sensorHandler","SensoredShape","AabbTestCallback","_aabbTestCallback","process","_touchedShapes","_touchShapes","prototypeAccessors$1","sensorEnabled","_sensorEnabled","isSensor","getAabb","RigidBody","rigidBodyConfig","res","getShapeList","getNext","addShape","removeShape","t","createStatic","RigidBodyConfig","RigidBodyType","STATIC","createDynamic","DYNAMIC","createKinematic","KINEMATIC","Sprite","_material","THREE.MeshBasicMaterial","_texture","needsUpdate","image","_updateGeometry","THREE.PlaneGeometry","_width","_height","from","sprite"],"mappings":";;;;;;;kCAGaA,EAMZ,SAAYC,EAAWC,EAAWC,EAAWC,GAC5CC,KAAKC,GAAKL,EACVI,KAAKE,GAAKL,EACVG,KAAKG,GAAKL,EACVE,KAAKI,MAAQL,mEAGdM,EAAIT,iBACH,OAAOI,KAAKC,IAGbI,EAAIT,eAAEU,GACLN,KAAKC,GAAKK,EACVN,KAAKI,MAAMG,0BAGZF,EAAIR,iBACH,OAAOG,KAAKE,IAGbG,EAAIR,eAAES,GACLN,KAAKE,GAAKI,EACVN,KAAKI,MAAMG,0BAGZF,EAAIP,iBACH,OAAOE,KAAKG,IAGbE,EAAIP,eAAEQ,GACLN,KAAKG,GAAKG,EACVN,KAAKI,MAAMG,sCAGZC,aAAIZ,EAAWC,EAAYC,QAChBW,IAANZ,IACHA,EAAID,QAGKa,IAANX,IACHA,EAAID,GAGLG,KAAKC,GAAKL,EACVI,KAAKE,GAAKL,EACVG,KAAKG,GAAKL,EAEVE,KAAKI,MAAMG,iECxDb,IAAIG,EAAc,UACdC,EAAY,QACZC,EAAc,QACdC,EAAiB,8BACjBC,EAAe,2BACfC,EAAgB,WAChBC,EAAc,qCACdC,EAAe,QACfC,EAAe,iBACfC,EAAgB,wBAChBC,EAAkB,cAClBC,EAAoB,QACpBC,EAAa,cACbC,EAAc,gCACdC,EAAe,yBACfC,EAAuB,SAAUC,GACjC,YAA6B,IAAdA,GACY,aAAvBA,EAAUC,UAC0B,iBAA7BD,EAAUE,gBACjBF,EAAUE,eAAiB,GACP,oBAAbC;;;;;;;ACbf,IAAMC,EACF,WACI9B,KAAK+B,QAAU,gBAEnBC,aAAIC,EAAMC,EAAUC,GAChB,IAAKF,IAASC,EACV,OAAOlC,KAGX,IADAoC,IAAMC,EAASrC,KAAK+B,QAAQE,GAAQjC,KAAK+B,QAAQE,IAAS,GACjDK,EAAI,EAAGA,EAAID,EAAOE,OAAQD,IAC/B,GAAID,EAAOC,GAAGJ,WAAaA,EACvB,OAAOlC,KAIf,OADAqC,EAAOG,KAAK,UAAEN,OAAUC,IACjBnC,kBAQXyC,YAAGR,EAAMC,GACL,OAAOlC,KAAKgC,IAAIC,EAAMC,GAAU,gBAQpCC,cAAKF,EAAMC,GACP,OAAOlC,KAAKgC,IAAIC,EAAMC,GAAU,gBAQpCQ,aAAIT,EAAMC,GACN,IAAKD,IAASC,EACV,OAAOlC,KAGX,IADAoC,IAAMC,EAASrC,KAAK+B,QAAQE,IAAS,GAC5BK,EAAI,EAAGA,EAAID,EAAOE,OAAQD,IAC/B,GAAID,EAAOC,GAAGJ,WAAaA,EAEvB,OADAG,EAAOM,OAAOL,EAAG,GACVtC,KAGf,OAAOA,kBAEX4C,eAAMX,EAAMY,iEACR,IAAKZ,EACD,OAAOjC,KAIX,IAFAoC,IAAMC,EAASrC,KAAK+B,QAAQE,IAAS,GAC/Ba,EAAU,GACPR,EAAID,EAAOE,OAAS,EAAGD,GAAK,EAAGA,IAAK,CACzCF,IAAMW,EAAQV,EAAOC,GACjBS,EAAMZ,MACNE,EAAOM,OAAOL,EAAG,GAErBQ,EAAQN,KAAKO,GAEjB,IAAKC,IAAIV,EAAIQ,EAAQP,OAAS,EAAGD,GAAK,EAAGA,IACrCQ,EAAQR,GAAGJ,SAASe,MAAMJ,EAASK,GAEvC,OAAOlD,kBAQXmD,cAAKlB,mEACD,SAAOjC,MAAK4C,eAAMX,EAAMjC,aAASkD,iBASrCE,eAAMnB,EAAMY,mEACR,SAAO7C,MAAK4C,eAAMX,EAAMY,UAAYK,iBAExCG,kBAASR,iEACL,GAAe,MAAXA,EACA,OAAO7C,KAEXoC,IAAMU,EAAU,GAChB,IAAKE,IAAIf,KAAQjC,KAAK+B,QAElB,IADAK,IAAMC,EAASrC,KAAK+B,QAAQE,IAAS,GAC5BK,EAAID,EAAOE,OAAS,EAAGD,GAAK,EAAGA,IAAK,CACzCF,IAAMW,EAAQV,EAAOC,GACjBS,EAAMZ,MACNE,EAAOM,OAAOL,EAAG,GAErBQ,EAAQN,KAAKO,GAGrB,IAAKC,IAAIV,EAAIQ,EAAQP,OAAS,EAAGD,GAAK,EAAGA,IACrCQ,EAAQR,GAAGJ,SAASe,MAAMJ,EAASK,GAEvC,OAAOlD,kBAOXsD,4EACI,SAAOtD,MAAKqD,kBAASrD,aAASkD,iBAQlCK,kBAASV,mEACL,SAAO7C,MAAKqD,kBAASR,UAAYK,iBAOrCM,eAAMvB,GAOF,sBAPS,IACLA,SACQjC,KAAK+B,QAAQE,GAGrBjC,KAAK+B,QAAU,GAEZ/B,MC3IfoC,IAAMqB,EFiBS,SAAkBC,GAC7B,IAAIC,EAAM,CACNC,UAAW,GACXjC,SAAU,GACVC,eAAgB,GAEf8B,GAA8B,oBAAdhC,UAOK,iBAAVgC,EACZC,EAAIC,UAAYF,EAEXA,GAASA,EAAME,YACpBD,EAAM,CACFC,UAAWF,EAAME,UACjBjC,SAAU+B,EAAM/B,SAChBC,eAAgB8B,EAAM9B,gBAAkB,IAb5C+B,EAAM,CACFC,UAAWlC,UAAUkC,UACrBjC,SAAUD,UAAUC,SACpBC,eAAgBF,UAAUE,gBAAkB,GAapD,IAAIgC,EAAYD,EAAIC,UAChBC,EAAMD,EAAUE,MAAM,cACJ,IAAXD,EAAI,KACXD,EAAYC,EAAI,SAGE,KADtBA,EAAMD,EAAUE,MAAM,YACP,KACXF,EAAYC,EAAI,IAEpB,IAAIE,EAnCR,SAAqBH,GACjB,OAAO,SAAUI,GAAS,OAAOA,EAAMC,KAAKL,IAkChCM,CAAYN,GACpBO,EAAS,CACTC,MAAO,CACHC,MAAON,EAAMrD,KAAiBqD,EAAM7C,GACpCoD,KAAMP,EAAMpD,GACZ4D,QAASR,EAAMrD,KACVqD,EAAMnD,IAAgBa,EAAqBkC,MAC3CI,EAAM7C,GACXsD,UAAWT,EAAMlD,GACjB4D,QAASV,EAAMrD,IACXqD,EAAMpD,IACNoD,EAAMnD,IACNmD,EAAMlD,IACNY,EAAqBkC,MACpBI,EAAM7C,IAEfwD,OAAQ,CACJL,MAAON,EAAM/C,GACbuD,QAASR,EAAM/C,IAAgB+C,EAAM9C,GACrCwD,OAAQV,EAAM/C,IAAgB+C,EAAM9C,IAExC0D,QAAS,CACLN,OAASN,EAAM7C,IAAiB6C,EAAM/C,KAChC+C,EAAM7C,IAAiB6C,EAAMjD,GACnCyD,QAASR,EAAM7C,KACV6C,EAAM/C,KACN+C,EAAMjD,KACNiD,EAAM9C,IAAiB8C,EAAMhD,IAClC0D,QAAUV,EAAM7C,KACX6C,EAAM/C,IACH+C,EAAM9C,IACN8C,EAAMjD,IACNiD,EAAMhD,KACVgD,EAAM,gBAEda,QAAS,CACLP,MAAON,EAAM7C,GACbqD,OAAQR,EAAM5C,GACdsD,OAAQV,EAAM7C,IAAiB6C,EAAM5C,IAEzC0D,MAAO,CACHC,WAAYf,EAAM3C,GAClB2D,aAAchB,EAAM1C,GACpB2D,MAAOjB,EAAMzC,GACb2D,QAASlB,EAAMvC,GACf0D,OAAQnB,EAAMxC,GACdkD,OAAQV,EAAM3C,IACV2C,EAAM1C,IACN0C,EAAMzC,IACNyC,EAAMvC,IACNuC,EAAMxC,IAEd4D,KAAK,EACLd,OAAO,EACPE,QAAQ,GAWZ,OATAJ,EAAOgB,IACHhB,EAAOC,MAAMK,QACTN,EAAOQ,QAAQF,QACfN,EAAOS,QAAQH,QACfN,EAAOU,MAAMJ,OACrBN,EAAOE,MACHF,EAAOC,MAAMC,OAASF,EAAOQ,QAAQN,OAASF,EAAOS,QAAQP,MACjEF,EAAOI,OACHJ,EAAOC,MAAMG,QAAUJ,EAAOQ,QAAQJ,QAAUJ,EAAOS,QAAQL,OAC5DJ,EElHEiB,CAAS1D,UAAUkC,WAAWuB,IAK3C,SAASE,EAASC,EAAyBC,GAK1C,IAJAnD,IAAMoD,EAAyBF,EAAOG,OAAO,IACvCC,EAA2BH,EAASE,OAAO,IAC3CE,EAAwB,GAErBrD,EAAIkD,EAAMjD,OAAS,EAAGD,GAAK,EAAGA,IAAK,CAC3CF,IAAMwD,EAAIJ,EAAMlD,GACVuD,EAAQH,EAAQI,QAAQF,GAE1BC,GAAS,IACZL,EAAM7C,OAAOL,EAAG,GAChBoD,EAAQ/C,OAAOkD,EAAO,GACtBF,EAAKnD,KAAKoD,IAIZ,MAAO,MAAED,QAAMH,UAAOE,GAMvB,SAASK,EAASjD,EAA0Bb,EAAcc,GACzD,IAAKC,IAAIV,EAAI,EAAGA,EAAIQ,EAAQP,OAAQD,IACnCQ,EAAQR,GAAGa,KAAKlB,EAAMc,OAUXiD,cAAb,qCACWhG,YAAwB,IAAIiG,UAC5BjG,YAA4B,CAAEiC,KAAM,GAAIyD,QAAS,GAAIQ,cAAe,MACpElG,WAAyB,GACzBA,WAAyB,GAEnCA,kBAAuB,EACvBA,sBAA2B,EAC3BA,sBAA2B,EAC3BA,oBAAyB,4GAKfmG,eAAMC,EAAUxG,EAAWC,EAAWwG,EAAeC,GAC9DtG,KAAKuG,OAAOL,cAAgBE,EAC5BpG,KAAKuG,OAAOb,QAAU,GAEtB1F,KAAKwG,OAAO5G,EAAKA,EAAIyG,EAAS,EAAI,EAClCrG,KAAKwG,OAAO3G,GAAMA,EAAIyG,EAAU,EAAI,EAEpCtG,KAAKmD,KAAK,OAAQnD,KAAKuG,OAAQvG,KAAKwG,qBAGrCC,gBAAOL,EAAUxG,EAAWC,EAAWwG,EAAeC,GACrDtG,KAAK0G,MAAQ,GACR1G,KAAK2G,aAAgB3G,KAAK4G,kBAI/B5G,KAAKuG,OAAOtE,KAAO,iCACnBjC,KAAKmG,MAAMC,EAAGxG,EAAGC,EAAGwG,EAAOC,GAEQ,IAA/BtG,KAAKuG,OAAOb,QAAQnD,SAIxBwD,EAAS/F,KAAKuG,OAAOb,QAAS,cAAe1F,KAAKuG,QAClDvG,KAAK0G,MAAQ1G,KAAKuG,OAAOb,uBAG1BmB,gBAAOT,EAAUxG,EAAWC,EAAWwG,EAAeC,GACrD,GAAKtG,KAAK2G,aAAgB3G,KAAK8G,gBAO/B,GAHA9G,KAAKuG,OAAOtE,KAAO,iCACnBjC,KAAKmG,MAAMC,EAAGxG,EAAGC,EAAGwG,EAAOC,GAED,IAAtBtG,KAAK+G,MAAMxE,OAAf,CASA,GAAmC,IAA/BvC,KAAKuG,OAAOb,QAAQnD,OAIvB,OAHAwD,EAAS/F,KAAK+G,MAAO,aAAc/G,KAAKuG,aACxCvG,KAAK+G,MAAQ,IAKd3E,IAAM4E,EAAY3B,EAASrF,KAAK+G,MAAO/G,KAAKuG,OAAOb,SAEnDK,EAASiB,EAAUtB,QAAS,cAAe1F,KAAKuG,QAChDR,EAASiB,EAAUxB,MAAO,aAAcxF,KAAKuG,QAC7CvG,KAAK+G,MAAQ/G,KAAKuG,OAAOb,QAEzBK,EAASiB,EAAUrB,KAAM,cAAe3F,KAAKuG,aArBxCvG,KAAKuG,OAAOb,QAAQnD,OAAS,IAChCwD,EAAS/F,KAAKuG,OAAOb,QAAS,cAAe1F,KAAKuG,QAClDvG,KAAK+G,MAAQ/G,KAAKuG,OAAOb,sBAsB5BuB,cAAKb,EAAUxG,EAAWC,EAAWwG,EAAeC,GACnD,GAAKtG,KAAK2G,aAAgB3G,KAAKkH,cAO/B,GAHAlH,KAAKuG,OAAOtE,KAAO,+BACnBjC,KAAKmG,MAAMC,EAAGxG,EAAGC,EAAGwG,EAAOC,GAED,IAAtBtG,KAAK0G,MAAMnE,OAAf,CAQA,GAAmC,IAA/BvC,KAAKuG,OAAOb,QAAQnD,OAIvB,OAHAwD,EAAS/F,KAAK0G,MAAO,mBAAoB1G,KAAKuG,aAC9CvG,KAAK0G,MAAQ,IAKdtE,IAAM4E,EAAY3B,EAASrF,KAAK0G,MAAO1G,KAAKuG,OAAOb,SAEnDK,EAASiB,EAAUtB,QAAS,YAAa1F,KAAKuG,QAC9CR,EAASiB,EAAUxB,MAAO,mBAAoBxF,KAAKuG,QAEnDR,EAASiB,EAAUrB,KAAM,YAAa3F,KAAKuG,QAC3CR,EAASiB,EAAUrB,KAAM,aAAc3F,KAAKuG,QAC5CvG,KAAK0G,MAAQ,QArBR1G,KAAKuG,OAAOb,QAAQnD,OAAS,GAChCwD,EAAS/F,KAAKuG,OAAOb,QAAS,YAAa1F,KAAKuG,qBAuBnDY,mBAAUC,cACL3D,GACH2D,EAAOC,iBAAiB,uBAAejB,GACtCpG,EAAKyG,OAAOL,EAAGA,EAAEkB,QAAQ,GAAGC,QAAUH,EAAOI,WAAYpB,EAAEkB,QAAQ,GAAGG,QAAUL,EAAOM,UAAWN,EAAOO,YAAaP,EAAOQ,iBAG9HR,EAAOC,iBAAiB,sBAAcjB,GACrCpG,EAAK6G,OAAOT,EAAGA,EAAEkB,QAAQ,GAAGC,QAAUH,EAAOI,WAAYpB,EAAEkB,QAAQ,GAAGG,QAAUL,EAAOM,UAAWN,EAAOO,YAAaP,EAAOQ,iBAG9HR,EAAOC,iBAAiB,qBAAajB,GACpCpG,EAAKiH,KAAKb,EAAGA,EAAEyB,eAAe,GAAGN,QAAUH,EAAOI,WAAYpB,EAAEyB,eAAe,GAAGJ,QAAUL,EAAOM,UAAWN,EAAOO,YAAaP,EAAOQ,mBAG1IR,EAAOC,iBAAiB,sBAAcjB,GACrCpG,EAAKyG,OAAOL,EAAGA,EAAE0B,QAAS1B,EAAE2B,QAASX,EAAOO,YAAaP,EAAOQ,iBAGjER,EAAOC,iBAAiB,sBAAcjB,GACrCpG,EAAK6G,OAAOT,EAAGA,EAAE0B,QAAS1B,EAAE2B,QAASX,EAAOO,YAAaP,EAAOQ,iBAGjER,EAAOC,iBAAiB,oBAAYjB,GACnCpG,EAAKiH,KAAKb,EAAGA,EAAE0B,QAAS1B,EAAE2B,QAASX,EAAOO,YAAaP,EAAOQ,sBAlI1B9F,GCU3BkG,EAYZ,SAAYC,6BAA8B,IATlCjI,YAAiB,GACjBA,eAAoB,EACpBA,eAAoB,EAEpBA,mBAA+B,KAC/BA,eAAoB,GACpBA,cAAmB,GACnBA,yBAAsB,IAAIgG,EAGjC5D,IAAMgF,EAASa,EAAQb,aAAU3G,EAC3ByH,EAAYD,EAAQC,WAAaC,SAASC,KAG1CC,EAAkB,QACvBjB,EAAQkB,MAHWL,EAAQM,cAAe,YACzBN,EAAQO,YAAa,GAKjCC,EAAW,IAAIC,gBAAoBL,GAEnChC,EAAQ4B,EAAQ5B,OAAS,IACzBC,EAAS2B,EAAQ3B,QAAU,IAC3BqC,EAAaV,EAAQU,YAAc,EACnCC,EAAkBX,EAAQW,iBAAmB,EAE7CC,EAAaZ,EAAQY,aAAc,EACnCC,EAAWb,EAAQa,UAAY,KAC/BC,EAAUd,EAAQc,SAAW,GAEnCN,EAASO,cAAcJ,EAAiB,GACxCH,EAASQ,QAAQ5C,EAAOC,GACxBmC,EAASS,cAAcP,GACvBF,EAASU,WAAY,EAErBnJ,KAAKoJ,WAAalB,EAClBlI,KAAKqJ,UAAYZ,EACjBzI,KAAKsJ,cAAgB,IAAIrD,UAAcI,EAAOC,GAC9CtG,KAAKuJ,UAAYT,EACjB9I,KAAKwJ,SAAWT,EAEhBN,EAASgB,WAAWC,MAAMC,SAAW,WAErCvH,IAAMwH,EAAY,IAAIC,YAEtB7J,KAAK8J,oBAAoB3C,UAAUsB,EAASgB,YAE5CzJ,KAAK8J,oBAAoBrH,GAAG,iBAASM,EAA0BgH,GAE9D,IADA3H,IAAM4H,EAAIhK,EAAKiK,OACN3H,EAAI0H,EAAEzH,OAAS,EAAGD,GAAK,EAAGA,IAAK,CACvC,GAAIS,EAAM2C,QAAQnD,OAAS,EAC1B,OAGDyH,EAAE1H,GAAG4H,cAAcnH,EAAO6G,EAAWG,OAIvCI,OAAO9C,iBAAiB,6BAAoBjB,GAC3CpG,EAAKoK,UAAYhE,EAAEiE,aAGpBjI,IAAMkI,WAAQC,GACbnI,IAAMoI,EAAuC,KAA9BD,EAAYvK,EAAKoK,WAChCpK,EAAKoK,UAAYG,EAEZvK,EAAKyK,UAKVzK,EAAK0K,OAAOF,GACZG,sBAAsBL,IALrBK,sBAAsBL,IAQxBK,sBAAsBL,GAElBzB,IAEF7I,KAAK4K,cADa,IAAf/B,aAEF7I,EAAK6K,yBAILhC,EAAW7I,gMAMf8K,qBAAYC,cACX,OAAOA,EAAQC,gBAAgBhL,KAAKuJ,UAAWvJ,KAAKwJ,UAClDyB,eAAKC,GACL,MAAO,CACN7E,MAAOrG,EAAKsJ,cAAcjD,MAC1BC,OAAQtG,EAAKsJ,cAAchD,iBAC3B4E,EACAC,KAAMJ,EAAQI,SAGfF,eAAMG,GAEN,IADAhJ,IAAMiJ,EAAcN,EAAQM,YACnB/I,EAAI,EAAGA,EAAI+I,EAAY9I,OAAQD,IACvCtC,EAAKsL,QAAQ,IAAID,EAAY/I,GAAG8I,IAGjC,OAAOpL,MAIVK,EAAIoI,wBACH,OAAOzI,KAAKqJ,WAGbhJ,EAAIkL,kCACH,OAAOvL,KAAK8J,qBAGbzJ,EAAImL,uBACH,OAAOxL,KAAKqJ,UAAUI,YAGvBpJ,EAAIgG,qBACH,OAAOrG,KAAKsJ,cAAc1J,GAG3BS,EAAIiG,sBACH,OAAOtG,KAAKsJ,cAAczJ,eAG3ByL,iBAAQG,GAGP,OAFAzL,KAAKiK,OAAOzH,KAAKiJ,GAEVA,eAGRC,oBAAWD,GACVrJ,IAAMyD,EAAQ7F,KAAKiK,OAAOnE,QAAQ2F,GAClC,IAAe,IAAX5F,EAMJ,OAFA7F,KAAKiK,OAAOtH,OAAOkD,EAAO,GAEnB4F,eAGRE,gBAGC,OAFA3L,KAAKoJ,WAAWwC,YAAY5L,KAAKqJ,UAAUI,YAEpCzJ,KAAK6L,qBAGbA,iBAGC,OAFA7L,KAAKyK,UAAW,EAETzK,kBAGR8L,gBAGC,OAFA9L,KAAKyK,UAAW,EAETzK,kBAGR0K,gBAAOF,GAIN,IAHApI,IAAM4H,EAAIhK,KAAKiK,OACT7D,EAAiB,OAAEoE,GAEhBlI,EAAI,EAAGA,EAAI0H,EAAEzH,OAAQD,IAC7B0H,EAAE1H,GAAGoI,OAAOtE,GAAG,GAGhBpG,KAAK+L,sBAGNA,kBACC/L,KAAKqJ,UAAU2C,YAAY,EAAG,EAAGhM,KAAKsJ,cAAc1J,EAAGI,KAAKsJ,cAAczJ,GAC1EG,KAAKqJ,UAAU7F,QAGf,IADApB,IAAM4H,EAAIhK,KAAKiK,OACN3H,EAAI,EAAGA,EAAI0H,EAAEzH,OAAQD,IAC7B0H,EAAE1H,GAAGyJ,OAAO/L,KAAKqJ,YAInBhJ,EAAIuK,4BACH,OAAO5K,KAAKiM,eAGb5L,EAAIuK,0BAAaA,GACZ5K,KAAKiM,eACR9B,OAAO+B,oBAAoB,SAAUlM,KAAKiM,eAGtCrB,GAKL5K,KAAKiM,cAAgBrB,EACrBT,OAAO9C,iBAAiB,SAAUuD,GAClCA,KANC5K,KAAKiM,cAAgB,kBAcvBpB,oBAAWsB,GACV/J,IAAMqJ,EAA0BzL,KAAKqJ,UAAUI,WACzC2C,EAAWD,GAAQ,CACxBvM,EAAG,EACHC,EAAG,EACHwG,MAAOrG,KAAKoJ,WAAWzB,aAAewC,OAAOkC,WAC7C/F,OAAQtG,KAAKoJ,WAAWxB,cAAgBuC,OAAOmC,aAGhD,OAAIF,EAAE/F,MAAQ+F,EAAE9F,OAASmF,EAAKpF,MAAQoF,EAAKnF,OACnCtG,KAAKuM,aAAaH,EAAE9F,QAAQkG,SAASJ,GAAGK,MAAML,GAG/CpM,KAAK0M,YAAYN,EAAE/F,OAAOsG,SAASP,GAAGQ,OAAOR,gBAQrDM,qBAAYrG,GACXjE,IAAMqJ,EAA0BzL,KAAKqJ,UAAUI,WACzCoD,EAAYxG,GAASrG,KAAKoJ,WAAWzB,aAAewC,OAAOkC,WAE3DS,EAAYD,EAAIpB,EAAKpF,MAAQoF,EAAKnF,OAMxC,OAHAmF,EAAK/B,MAAMrD,MAAWwG,OACtBpB,EAAK/B,MAAMpD,OAAYwG,OAEhB9M,kBAQRuM,sBAAajG,GACZlE,IAAMqJ,EAAOzL,KAAKqJ,UAAUI,WACtBqD,EAAYxG,GAAUtG,KAAKoJ,WAAWxB,cAAgBuC,OAAOmC,YAE7DO,EAAIC,EAAIrB,EAAKnF,OAASmF,EAAKpF,MAMjC,OAHAoF,EAAK/B,MAAMpD,OAAYwG,OACvBrB,EAAK/B,MAAMrD,MAAWwG,OAEf7M,kBAQR4M,gBAAOG,GACN3K,IAAMqJ,EAAOzL,KAAKqJ,UAAUI,WACtBuD,EAAmBD,GAAc,CACtCnN,EAAG,EACHyG,MAAOrG,KAAKoJ,WAAWzB,aAAewC,OAAOkC,YAK9C,OAFAZ,EAAK/B,MAAMuD,KAAUD,SAEdhN,kBAQRwM,kBAASO,GACR3K,IAAMqJ,EAAOzL,KAAKqJ,UAAUI,WACtBuD,EAAmBD,GAAc,CACtCnN,EAAG,EACHyG,MAAOrG,KAAKoJ,WAAWzB,aAAewC,OAAOkC,YAK9C,OAFAZ,EAAK/B,MAAMuD,MAAWD,EAAI3G,MAAQrG,KAAKkN,eAAe7G,OAAS,EAAI2G,EAAIpN,OAEhEI,kBAQRmN,iBAAQJ,GACP3K,IAAMqJ,EAAOzL,KAAKqJ,UAAUI,WACtBuD,EAAmBD,GAAc,CACtCnN,EAAG,EACHyG,MAAOrG,KAAKoJ,WAAWzB,aAAewC,OAAOkC,YAK9C,OAFAZ,EAAK/B,MAAMuD,KAAUD,EAAI3G,MAAQrG,KAAKkN,eAAe7G,MAAQ2G,EAAIpN,OAE1DI,kBAQRyM,eAAMW,GACLhL,IAAMqJ,EAAOzL,KAAKqJ,UAAUI,WACtB4D,EAAiBD,GAAY,CAClCvN,EAAG,EACHyG,OAAQtG,KAAKoJ,WAAWxB,cAAgBuC,OAAOmC,aAKhD,OAFAb,EAAK/B,MAAM4D,IAASD,SAEbrN,kBAQR2M,kBAASS,GACRhL,IAAMqJ,EAAOzL,KAAKqJ,UAAUI,WACtB4D,EAAiBD,GAAY,CAClCvN,EAAG,EACHyG,OAAQtG,KAAKoJ,WAAWxB,cAAgBuC,OAAOmC,aAKhD,OAFAb,EAAK/B,MAAM4D,KAAUD,EAAI/G,OAAStG,KAAKkN,eAAe5G,QAAU,EAAI+G,EAAIxN,OAEjEG,kBAQRuN,kBAASH,GACRhL,IAAMqJ,EAAOzL,KAAKqJ,UAAUI,WACtB4D,EAAiBD,GAAY,CAClCvN,EAAG,EACHyG,OAAQtG,KAAKoJ,WAAWxB,cAAgBuC,OAAOmC,aAKhD,OAFAb,EAAK/B,MAAM4D,IAASD,EAAI/G,OAAStG,KAAKkN,eAAe5G,OAAS+G,EAAIxN,OAE3DG,kBAGAkN,wBACP9K,IAAMqJ,EAAOzL,KAAKqJ,UAAUI,WAE5B,MAAO,CACN7J,EAAG4N,SAAS/B,EAAK/B,MAAMuD,KAAKQ,QAAQ,KAAM,KAC1C5N,EAAG2N,SAAS/B,EAAK/B,MAAM4D,IAAIG,QAAQ,KAAM,KACzCpH,MAAOmH,SAAS/B,EAAK/B,MAAMrD,MAAMoH,QAAQ,KAAM,KAC/CnH,OAAQkH,SAAS/B,EAAK/B,MAAMpD,OAAOmH,QAAQ,KAAM,kDC5avCC,EAGZ,SAAYC,GACX3N,KAAK4N,QAAUD,mEAGhBtN,EAAIT,iBACH,OAAOI,KAAK4N,QAAQxF,KAAKyF,cAAcjO,GAGxCS,EAAIT,eAAEU,GACL8B,IAAMuH,EAAW3J,KAAK4N,QAAQxF,KAAKyF,cACnClE,EAAS/J,EAAIU,EACbN,KAAK4N,QAAQxF,KAAK0F,YAAYnE,GAC9B3J,KAAK4N,QAAQG,mBAGd1N,EAAIR,iBACH,OAAOG,KAAK4N,QAAQxF,KAAKyF,cAAchO,GAGxCQ,EAAIR,eAAES,GACL8B,IAAMuH,EAAW3J,KAAK4N,QAAQxF,KAAKyF,cACnClE,EAAS9J,EAAIS,EACbN,KAAK4N,QAAQxF,KAAK0F,YAAYnE,GAC9B3J,KAAK4N,QAAQG,mBAGd1N,EAAIP,iBACH,OAAOE,KAAK4N,QAAQxF,KAAKyF,cAAc/N,GAGxCO,EAAIP,eAAEQ,GACL8B,IAAMuH,EAAW3J,KAAK4N,QAAQxF,KAAKyF,cACnClE,EAAS7J,EAAIQ,EACbN,KAAK4N,QAAQxF,KAAK0F,YAAYnE,GAC9B3J,KAAK4N,QAAQG,+BAGdvN,aAAIZ,EAAWC,EAAYC,QAChBW,IAANZ,IACHA,EAAID,QAGKa,IAANX,IACHA,EAAID,GAGLuC,IAAMuH,EAAW3J,KAAK4N,QAAQxF,KAAKyF,cACnClE,EAAS/J,EAAIA,EACb+J,EAAS9J,EAAIA,EACb8J,EAAS7J,EAAIA,EAEbE,KAAK4N,QAAQxF,KAAK0F,YAAYnE,GAC9B3J,KAAK4N,QAAQG,8DCvDFC,EAGZ,SAAYL,GACX3N,KAAK4N,QAAUD,mEAGhBtN,EAAIT,iBACH,OAAOI,KAAK4N,QAAQxF,KAAK6F,cAAcC,aAAatO,GAGrDS,EAAIT,eAAEU,GACL8B,IAAM+L,EAAWnO,KAAK4N,QAAQxF,KAAK6F,cAAcC,aACjDC,EAASvO,EAAIU,EACbN,KAAK4N,QAAQxF,KAAKgG,eAAeD,GACjCnO,KAAK4N,QAAQG,mBAGd1N,EAAIR,iBACH,OAAOG,KAAK4N,QAAQxF,KAAK6F,cAAcC,aAAarO,GAGrDQ,EAAIR,eAAES,GACL8B,IAAM+L,EAAWnO,KAAK4N,QAAQxF,KAAK6F,cAAcC,aACjDC,EAAStO,EAAIS,EACbN,KAAK4N,QAAQxF,KAAKgG,eAAeD,GACjCnO,KAAK4N,QAAQG,mBAGd1N,EAAIP,iBACH,OAAOE,KAAK4N,QAAQxF,KAAK6F,cAAcC,aAAapO,GAGrDO,EAAIP,eAAEQ,GACL8B,IAAM+L,EAAWnO,KAAK4N,QAAQxF,KAAK6F,cAAcC,aACjDC,EAASrO,EAAIQ,EACbN,KAAK4N,QAAQxF,KAAKgG,eAAeD,GACjCnO,KAAK4N,QAAQG,+BAGdvN,aAAIZ,EAAWC,EAAYC,QAChBW,IAANZ,IACHA,EAAID,QAGKa,IAANX,IACHA,EAAID,GAGLuC,IAAM+L,EAAWnO,KAAK4N,QAAQxF,KAAK6F,cAAcC,aACjDC,EAASvO,EAAIA,EACbuO,EAAStO,EAAIA,EACbsO,EAASrO,EAAIA,EAEbE,KAAK4N,QAAQxF,KAAKgG,eAAeD,GACjCnO,KAAK4N,QAAQG;;;;;;;AClDf,IAAMM,EACF,SAAYC,EAAWzL,GACnB7C,KAAKuO,UAAY,CACb1L,QAAoB,MAAXA,EAAkB7C,KAAO6C,EAClC2L,SAAS,EACT3I,OAAQ,EACRyI,UAAW,GACXhO,MAAO,MAEXN,KAAKyO,IAAIH,0DAKbjO,EAAImO,uBACA,OAAOxO,KAAKuO,UAAUC,SAE1BnO,EAAImO,qBAAQA,GACRxO,KAAKuO,UAAUC,QAAUA,eAK7BC,aAAIH,GACKI,MAAMC,QAAQL,KACfA,EAAY,CAACA,IAIjB,IAFAlM,IAAMwM,EAAO5O,KAAKuO,UAAUD,UAEnBhM,GADIsM,EAAKrM,OACL,GAAGD,EAAIgM,EAAU/L,OAAQD,IAC5BgM,EAAUhM,aAAcuM,UAG9BD,EAAKpM,KAAK8L,EAAUhM,IAExB,OAAOtC,kBAKX8O,uEACI,GAAK9O,KAAKuO,UAAUC,QAApB,CAGApM,IAAM2M,EAAO/O,KAAKuO,UAAUD,UAAUtO,KAAKuO,UAAU1I,OACrD,GAAKkJ,EAGL,OAAO/O,KAAKuO,UAAUjO,MAAQyO,EAAK9L,MAAMjD,KAAKuO,UAAU1L,QAASK,iBAErE8L,aAAInJ,GAEA,OADA7F,KAAKuO,UAAU1I,MAAQoJ,OAAOpJ,GACvB7F,kBAKXwF,iBACI,OAAOxF,KAAKgP,IAAI,gBAKpBE,gBACI,OAAOlP,KAAKgP,IAAIhP,KAAKuO,UAAU1I,MAAQ,gBAK3CsJ,gBACI,OAAOnP,KAAKgP,IAAIhP,KAAKuO,UAAU1I,MAAQ,gBAK3CuJ,YAAGvJ,GACC,OAAO7F,KAAKgP,IAAInJ,gBAKpBwJ,kBAEI,OADArP,KAAKuO,UAAU1I,OAAS,EACjB7F,kBAKXsP,iBAII,OAHAtP,KAAKuO,UAAUD,UAAY,GAC3BtO,KAAKuO,UAAU1I,OAAS,EACxB7F,KAAKuO,UAAUjO,MAAQ,KAChBN,kBAKXuP,mBACIvP,KAAKsP,SAKTjP,EAAIC,qBACA,OAAON,KAAKuO,UAAUjO,8CCpG9B8B,IAAMoN,EAAO,IAAIC,OAEKC,cAWrB,WAAYC,cACXC,aATS5P,WAAuB,IAAI6P,UAC3B7P,YAAwB,IAAI6P,UAC5B7P,eAA6B,GAGvCA,kBAAuB,EACvBA,0BAA+B,EAK9BA,KAAK8P,OAAS9P,KAAK+P,KAAOJ,EAE1BA,EAAMtI,iBAAiB,2CAAkCtE,GACnD/C,EAAK2G,aAIV5D,EAAM2C,QAAQlD,KAAKxC,MAGpB2P,EAAMtI,iBAAiB,yCAAgCtE,GACjD/C,EAAK2G,aAIV5D,EAAM2C,QAAQlD,KAAKxC,MAGpB2P,EAAMtI,iBAAiB,2CAAkCtE,GACnD/C,EAAK2G,aAIV5D,EAAM2C,QAAQlD,KAAKxC,MAGpB2P,EAAMtI,iBAAiB,gDAAuCtE,GACxD/C,EAAK2G,aAIV5D,EAAM2C,QAAQlD,KAAKxC,MAGpBA,KAAKgQ,MAAQ,IAAI3B,EAAK,GAAIrO,MAC1BA,KAAKgQ,MAAMxK,oaAGZnF,EAAIsP,qBACH,OAAO3P,KAAK8P,QAGbzP,EAAI0O,oBACH,OAAO/O,KAAKgQ,OAGb3P,EAAI4P,2BACH,OAAOjQ,KAAKgQ,MAAMxB,SAGnBnO,EAAI4P,yBAAY3P,GACfN,KAAKgQ,MAAMxB,QAAUlO,GAGtBD,EAAI6P,sBACH,OAAOlQ,KAAK8P,OAAOK,SAASD,QAG7B7P,EAAI+P,wBACH,OAAOpQ,KAAKqQ,uBAGbC,oBAAWlK,GACVpG,KAAKgQ,MAAMlB,KAAK1I,IAGjB/F,EAAIgG,qBAEH,OADArG,KAAKuQ,oBACEvQ,KAAKwQ,MAAM5Q,GAGnBS,EAAIiG,sBAEH,OADAtG,KAAKuQ,oBACEvQ,KAAKwQ,MAAM3Q,GAGnBQ,EAAIoQ,qBAEH,OADAzQ,KAAKuQ,oBACEvQ,KAAKwQ,MAAM1Q,EAAIE,KAAK0Q,MAAM5Q,GAGlCO,EAAIT,iBACH,OAAOI,KAAK8P,OAAOnG,SAAS/J,GAG7BS,EAAIT,eAAEU,GACLN,KAAK8P,OAAOnG,SAAS/J,EAAIU,GAG1BD,EAAIR,iBACH,OAAOG,KAAK8P,OAAOnG,SAAS9J,GAG7BQ,EAAIR,eAAES,GACLN,KAAK8P,OAAOnG,SAAS9J,EAAIS,GAG1BD,EAAIP,iBACH,OAAOE,KAAK8P,OAAOnG,SAAS7J,GAG7BO,EAAIP,eAAEQ,GACLN,KAAK8P,OAAOnG,SAAS7J,EAAIQ,GAS1BD,EAAIqQ,qBACH,OAAO1Q,KAAK8P,OAAOY,OAGpBrQ,EAAIsQ,qBACH,OAAO3Q,KAAK4Q,oBAGblG,gBAAOtE,EAAgByK,GACtB7Q,KAAK+N,mBACJ8C,GAAwB7Q,KAAKsQ,WAAWlK,GACzCyK,EAAuBA,IAAyB7Q,KAAK8Q,oBAGrD,IADA1O,IAAM4H,EAAIhK,KAAKqQ,UACN/N,EAAI,EAAGA,EAAI0H,EAAEzH,OAAQD,IAC7B0H,EAAE1H,GAAGoI,OAAOtE,EAAGyK,gBAMjBN,6BACCvQ,KAAK+N,kBAELyB,EAAKuB,cAAc/Q,KAAK+P,MACxBP,EAAKwB,QAAQhR,KAAKwQ,OAClBxQ,KAAKwQ,MAAMS,SAASjR,KAAK0Q,oBAG1BQ,kBAASvD,GASR,OARIA,EAAOuC,QACVvC,EAAOuC,OAAOiB,YAAYxD,GAG3B3N,KAAKqQ,UAAU7N,KAAKmL,GACpB3N,KAAK+P,KAAKtB,IAAId,EAAOgC,OACrBhC,EAAOgC,MAAMQ,SAASD,OAASlQ,KAExB2N,eAGRwD,qBAAYxD,GACX,GAAIA,EAAOuC,SAAWlQ,KAAtB,CAIAoC,IAAMyD,EAAQ7F,KAAKqQ,UAAUvK,QAAQ6H,GACrC,IAAe,IAAX9H,EAQJ,OAJA7F,KAAKqQ,UAAU1N,OAAOkD,EAAO,GAC7B7F,KAAK+P,KAAKqB,OAAOzD,EAAOgC,OACxBhC,EAAOgC,MAAMQ,SAASD,OAAS,KAExBvC,8CApL8E7L,GCVjEuP,oLACrBhR,EAAI8N,wBACH,OAAOnO,KAAK8P,OAAO3B,sBAGpBJ,uEALiF2B,GCCrE4B,cAGZ,WAAYC,EAAsBC,GACjC5B,YAAM2B,GAENvR,KAAKyR,UAAYD,4JAGlBnR,EAAIkR,sBACH,OAAOvR,KAAK8P,QAGbzP,EAAImR,wBACH,OAAOxR,KAAKyR,uBAGb1F,gBAAOtD,EAA+BiJ,GACrCjJ,EAASuD,YAAYhM,KAAKyR,UAAU7R,EAAGI,KAAKyR,UAAU5R,EAAGG,KAAKyR,UAAUpL,MAAOrG,KAAKyR,UAAUnL,QAC9FmC,EAASsD,OAAO2F,EAAO1R,KAAK8P,qBAG7B/B,yCAIAwC,yEA1B2Bc,GCDNM,cAGrB,WAAYhC,GACXC,YAAMD,GAHG3P,WAAuB,IAAIiG,UAKpC0J,EAAMiC,kBAAmB,0JAG1BvR,EAAIwR,oBACH,OAAO7R,KAAK8R,OAGbzR,EAAI8N,wBACH,OAAOnO,KAAK8P,OAAO3B,SAASrO,GAG7BO,EAAI8N,sBAAS7N,GACZN,KAAK8P,OAAO3B,SAASrO,EAAIQ,eAG1ByN,2BACC/N,KAAK+R,6BAGNA,yBACC3P,IAAMxC,EAAII,KAAKJ,EACTC,EAAIG,KAAKH,EACTC,EAAIE,KAAK8P,OAAOnG,SAAS7J,EACzBkS,EAAShS,KAAK0Q,MAAM9Q,EACpBqS,EAASjS,KAAK0Q,MAAM7Q,EACpBqS,EAAQlS,KAAK6R,KAAKjS,EAClBuS,EAAQnS,KAAK6R,KAAKhS,EAClBsO,EAAWnO,KAAKmO,SAChBiE,EAASpS,KAAK2Q,MAAM/Q,EACpByS,EAASrS,KAAK2Q,MAAM9Q,EAEpByS,EAAIC,KAAKC,IAAIrE,EAAWgE,GAASH,EACjCS,EAAIF,KAAKG,IAAIvE,EAAWgE,GAASH,EACjChI,GAAKuI,KAAKG,IAAIvE,EAAW+D,GAASD,EAClCU,EAAIJ,KAAKC,IAAIrE,EAAW+D,GAASD,EACjCW,EAAKhT,GAAMwS,EAASE,EAAMD,EAASrI,GACnC6I,EAAKhT,GAAMuS,EAASK,EAAMJ,EAASM,GAEzC3S,KAAK8P,OAAOgD,OAAOtS,IAClB8R,EAAGtI,EAAG,EAAG4I,EACTH,EAAGE,EAAG,EAAGE,EACT,EAAG,EAAG,EAAG/S,EACT,EAAG,EAAG,EAAG,8CAhDsE4P,GCArEqD,cACZ,aACCnD,YAAM,IAAIoD,SAEVhT,KAAK+P,KAAO,IAAIiD,QAChBhT,KAAK8P,OAAOrB,IAAIzO,KAAK+P,gHAGtBkD,wBAEC,IADA7Q,IAAM4H,EAAIhK,KAAKqQ,UACN/N,EAAI,EAAGA,EAAI0H,EAAEzH,OAAQD,IAC7B0H,EAAE1H,GAAGqN,MAAMhG,SAAS7J,EAAQ,KAAJwC,eAI1BiO,6BACCvQ,KAAK8P,OAAOsB,OAAOpR,KAAK+P,MACxB,IAAK/M,IAAIV,EAAI,EAAGA,EAAItC,KAAKqQ,UAAU9N,OAAQD,IAC1CtC,KAAKqQ,UAAU/N,GAAGyL,kBAEnB6B,YAAMW,6BACNvQ,KAAK8P,OAAOrB,IAAIzO,KAAK+P,UArBU4B,GCApBuB,cACZ,aACCtD,YAAM,IAAIoD,SAEVhT,KAAK+P,KAAO,IAAIiD,QAChBhT,KAAK8P,OAAOrB,IAAIzO,KAAK+P,gHAGtBhC,2BACC/N,KAAK+P,KAAKpG,SAAS/J,GAAKI,KAAK4Q,OAAOhR,EACpCI,KAAK+P,KAAKpG,SAAS9J,GAAKG,KAAK4Q,OAAO/Q,EACpCG,KAAK+P,KAAKpG,SAAS7J,GAAKE,KAAK4Q,OAAO9Q,eAGrCyQ,6BACCvQ,KAAK8P,OAAOsB,OAAOpR,KAAK+P,MACxBH,YAAMW,6BACNvQ,KAAK8P,OAAOrB,IAAIzO,KAAK+P,UAjBUsB,GCIjC,SAAS8B,EAAYC,EAActK,GAClC,OAAgC,IAA5BsK,EAAKtN,QAAQ,YAAiD,IAA7BsN,EAAKtN,QAAQ,aAA4C,IAAvBsN,EAAKtN,QAAQ,OAAqC,IAAtBsN,EAAKtN,QAAQ,KACxGsN,EAEAtK,EAAS2E,QAAQ,WAAY,MAAQ,IAAM2F,EAOpD,SAASC,EAAeC,EAAavK,GACpC,OAAKA,EAIKuK,GAAMA,EAAIvP,MAAM,MAAQ,IAAM,YAAUgF,EAH1CuK,EA+FTlR,IAAMmR,EAA8D,GAEvDC,EAAb,WACSxT,mBAA0D,GAC1DA,kBAA8B,GAC9BA,WAA6B,6DAErCK,EAAIgL,2BACH,OAAOrL,KAAKyT,cAGbpT,EAAI8K,oBACH,OAAOuI,OAAOC,OAAO,GAAI3T,KAAK4T,oBAG/BC,qBAAYxI,cACNqD,MAAMC,QAAQtD,KAClBA,EAAc,CAAEA,IAGjBA,EAAYyI,kBAAQC,GACnB/T,EAAKyT,aAAajR,KAAKuR,mBAIzBC,sBAAgBC,EAAaC,GAG5B,IAAKlR,IAAIV,KAFTtC,KAAKmU,cAAcF,GAAOjU,KAAKmU,cAAcF,IAAQ,GAEvCC,EACblU,KAAKmU,cAAcF,GAAK3R,GAAK4R,EAAK5R,gBAIpC8R,wBAAeF,GACdlU,KAAKgU,aAAqB,WAAYE,gBAGvCG,oBAAWH,GACVlU,KAAKgU,aAAqB,OAAQE,gBAGnClJ,yBAAgBlC,EAAkBC,cAC3BuL,EAA6C,GAC7CpJ,EAAiC,iBAGhC5I,KAAKiR,GAIXe,EAAS9R,KACR+Q,EAAcjR,GAAGtC,EAAKmU,cAAc7R,GAAIwG,EAAUC,GAChDkC,eAAMsJ,GACN,OAAOrJ,EAAU5I,GAAKiS,OAR1B,IAAKvR,IAAIV,KAAKtC,EAAKmU,mBAanB,OAAOK,QAAQC,IAAIH,GAAUrJ,wBAAWC,kBAGzCwJ,oBAAWR,GACV,IAAKlR,IAAIV,KAAK4R,EACblU,KAAK4T,MAAMtR,GAAK4R,EAAK5R,IAIvBkR,EAAOmB,wBAAkBV,EAAaW,GACrCrB,EAAcU,GAAOW,0CAIvBpB,EAAQmB,eAA8B,YA9ItC,SAA2BT,EAAoCpL,EAAkBC,GAChF3G,IAAMyS,EAAS,IAAIC,gBACbR,EAA4B,GAC5BS,EAA+B,iBAGpCT,EAAS9R,KACR,IAAIgS,kBAAeQ,EAASC,GAC3B7S,IAAMkR,EAAMD,EAAeF,EAAYe,EAAK5R,GAAIwG,GAAWC,GAC3D8L,EAAOK,KAAK5B,YAAK6B,GAChBJ,EAASzS,GAAK6S,EACdH,WACEvU,YAAW2F,GACb6O,EAAO7O,WARX,IAAKpD,IAAIV,KAAK4R,OAcd,OAAOM,QAAQC,IAAIH,GAAUrJ,wBAAW8J,QA4HzCvB,EAAQmB,eAAqB,QA9G7B,SAAwBT,EAAiCpL,EAAkBC,GAC1E3G,IAAMyS,EAAS,IAAIO,aACbd,EAA4B,GAC5Be,EAA0B,iBAG/Bf,EAAS9R,KACR,IAAIgS,kBAAeQ,EAASC,GAC3B7S,IAAMkR,EAAMD,EAAeF,EAAYe,EAAK5R,GAAIwG,GAAWC,GAC3D8L,EAAOK,KAAK5B,YAAKgC,GAChBD,EAAO/S,GAAKgT,EACZN,WACEvU,YAAW2F,GACb6O,EAAO7O,WARX,IAAKpD,IAAIV,KAAK4R,OAcd,OAAOM,QAAQC,IAAIH,GAAUrJ,wBAAWoK,YC5F5BE,cAGZ,WAAYC,EAAgCC,GAC3C7F,YAAM,IAAI8F,OAAWF,EAAUC,IAE/BzV,KAAK2V,QAAU,IAAIhW,EAAO,EAAG,EAAG,EAAGK,MACnCyV,EAASlN,aAAc,EACvBvI,KAAKO,wJAGNF,EAAIuV,sBACH,OAAO5V,KAAK2V,qBAGbpV,kCACCP,KAAK8P,OAAO0F,SAASK,SACrB7V,KAAKuQ,oBACLvQ,KAAK8P,OAAO0F,SAASM,UAAU9V,KAAKwQ,MAAM5Q,GAAK,GAAMI,KAAK2V,QAAQ/V,GAAII,KAAKwQ,MAAM3Q,GAAK,GAAMG,KAAK2V,QAAQ9V,GAAIG,KAAKwQ,MAAM1Q,GAAK,GAAME,KAAK2V,QAAQ7V,iBAGjJyQ,6BACCvQ,KAAK8P,OAAO0F,SAASO,qBACrB/V,KAAK8P,OAAO0F,SAASQ,aAAehW,KAAK8P,OAAO0F,SAASQ,YAAYhF,QAAQhR,KAAKwQ,OAClFxQ,KAAKwQ,MAAMS,SAASjR,KAAK0Q,kDAxBDW,GCCb4E,cAMZ,WAAYtG,EAAuBvH,GAClCwH,YAAMD,GALG3P,sBAA2B,EAOpCA,KAAKkW,MAAQ9N,EACbpI,KAAKmW,UAAY,IAAIzI,EAAa1N,MAClCA,KAAKoW,UAAY,IAAIpI,EAAahO,MAElCoI,EAAK+H,SAASkG,IAAMrW,oPAGrBK,EAAI+H,oBACH,OAAOpI,KAAKkW,OAGb7V,EAAIT,iBACH,OAAOI,KAAKmW,UAAUvW,GAGvBS,EAAIT,eAAEU,GACLN,KAAKmW,UAAUvW,EAAIU,GAGpBD,EAAIR,iBACH,OAAOG,KAAKmW,UAAUtW,GAGvBQ,EAAIR,eAAES,GACLN,KAAKmW,UAAUtW,EAAIS,GAGpBD,EAAIP,iBACH,OAAOE,KAAKmW,UAAUrW,GAGvBO,EAAIP,eAAEQ,GACLN,KAAKmW,UAAUrW,EAAIQ,GAGpBD,EAAIsJ,wBACH,OAAO3J,KAAKmW,WAIb9V,EAAI8N,wBACH,OAAOnO,KAAKoW,uBAGbrI,2BACC/N,KAAK8P,OAAOnG,SAAS2M,KAAKtW,KAAKkW,MAAMrI,eACrC7N,KAAK8P,OAAOyG,WAAWD,KAAKtW,KAAKkW,MAAMM,+BAGxCC,2BAAkBC,GACjB1W,KAAKkW,MAAMO,kBAAkBC,gBAG9BC,2BAAkBD,GACjB1W,KAAKkW,MAAMS,kBAAkBD,gBAG9BE,8BAAqBF,GACpB1W,KAAKkW,MAAMU,qBAAqBF,gBAGjCG,0BAAiBC,GAChB9W,KAAKkW,MAAMW,iBAAiBC,gBAG7BC,0BAAiBD,GAChB9W,KAAKkW,MAAMa,iBAAiBD,gBAG7BE,6BAAoBF,GACnB9W,KAAKkW,MAAMc,oBAAoBF,8CA/EIzF,GCCxB4F,cAGZ,WAAY7L,GACXwE,YAAM,IAAIsH,SAHHlX,cAAqB,GAK5BA,KAAK2G,aAAc,gIAGpBtG,EAAIqR,qBACH,OAAO1R,KAAK8P,oBAGbqH,mBAAU5F,GAST,OARIA,EAAOrB,QACVqB,EAAOrB,OAAOiB,YAAYI,GAG3BvR,KAAKoX,SAAS5U,KAAK+O,GACnBvR,KAAK8P,OAAOrB,IAAI8C,EAAO5B,OACvB4B,EAAO5B,MAAMQ,SAASD,OAASlQ,KAExBuR,eAGR8F,sBAAa9F,GACZ,GAAIA,EAAOrB,SAAWlQ,KAAtB,CAIAoC,IAAMyD,EAAQ7F,KAAKoX,SAAStR,QAAQyL,GACpC,IAAe,IAAX1L,EAQJ,OAJA7F,KAAKoX,SAASzU,OAAOkD,EAAO,GAC5B7F,KAAK8P,OAAOsB,OAAOG,EAAO5B,OAC1B4B,EAAO5B,MAAMQ,SAASD,OAAS,KAExBqB,gBAGR9C,aAAIkB,GAGH,OAFA3P,KAAK8P,OAAOrB,IAAIkB,GAETA,eAGRyB,gBAAOzB,GAGN,OAFA3P,KAAK8P,OAAOsB,OAAOzB,GAEZA,eAYR5D,gBAAOtD,GAGN,IAFArG,IAAM4H,EAAIhK,KAAKoX,SAEN9U,EAAI,EAAGA,EAAI0H,EAAEzH,OAAQD,IAC7BmG,EAAS6O,aACTtN,EAAE1H,GAAGyJ,OAAOtD,EAAUzI,KAAK8P,qBAI7B5F,uBAAcnH,EAA0B6G,EAA4BG,cACnE,GAAK/J,KAAK2G,YAMV,IAFAvE,IAAM4H,EAAIhK,KAAKoX,uBAGd,GAAIrU,EAAM2C,QAAQnD,OAAS,EAC1B,SAGDqH,EAAU2N,cAAcxN,EAAOC,EAAE1H,GAAGiP,QAgBpC,IAdAnP,IAAMoV,WAA8C5R,GACnD,OAAOA,EAAEwK,SAASqH,cAAI7R,GACrB,OAAIA,aAAa8P,OACT9P,EAGD4R,EAAE5R,MACP8R,QAGEC,EAASH,EAAExX,EAAK8P,QAEhB8H,EAAahO,EAAUiO,iBAAiBF,GAErCrV,EAAI,EAAGA,EAAIsV,EAAWrV,OAAQD,IAAK,CAC3C,GAAIS,EAAM2C,QAAQnD,OAAS,EAC1B,OAID,IADAS,IAAI4C,EAAIgS,EAAWtV,GAAGqL,OACf/H,IAAM5F,EAAK8P,SACjBlK,EAAEkS,cAAc/U,GAEX6C,EAAEsK,SAIPtK,EAAIA,EAAEsK,SAlCA5N,EAAI,EAAGA,EAAI0H,EAAEzH,OAAQD,8CAwC/ByL,uEAvHyBsD,KCsBX0G,KCtBFC,cAQZ,wBACCpI,aAPO5P,qBAAmC,GAI3CA,qBAA0B,EAKzBA,KAAKiY,OAAS,IAAIF,EAAKG,MACvBlY,KAAKiY,OAAOE,WAAW,IAAIJ,EAAKK,KAAK,GAAI,IAAK,IAE9CpY,KAAKqY,uBAAiBC,IAEN,IADDtY,EAAKuY,gBAAgBzS,QAAQwS,IAE1CtY,EAAKuY,gBAAgB/V,KAAK8V,IAI5BtY,KAAKwY,yBAAmBF,GACvBlW,IAAMyD,EAAQ7F,EAAKuY,gBAAgBzS,QAAQwS,GACvCzS,GAAS,GACZ7F,EAAKuY,gBAAgB5V,OAAOkD,EAAO,6JAKtCxF,EAAIoY,qBACH,OAAOzY,KAAKiY,QAGb5X,EAAI+P,wBACH,OAAOpQ,KAAKqQ,uBAGba,kBAASvD,GACRiC,YAAMsB,mBAASvD,GAEf3N,KAAKiY,OAAOS,aAAa/K,EAAOvF,MAGhC,IADAhG,IAAMuW,EAAiBhL,EAAOvF,KAAKwQ,uBAC1BtW,EAAI,EAAGA,EAAIqW,EAAepW,OAAQD,IAC1CtC,KAAKqY,cAAcM,EAAerW,IAMnC,OAHAqL,EAAOvF,KAAK3F,GAAG,qBAAsBzC,KAAKqY,eAC1C1K,EAAOvF,KAAK3F,GAAG,uBAAwBzC,KAAKwY,iBAErC7K,eAGRwD,qBAAYxD,GACXvL,IAAMyW,EAAIjJ,YAAMuB,sBAAYxD,GAE5B,GAAKkL,EAAL,CAIA7Y,KAAKiY,OAAOa,gBAAgBnL,EAAOvF,MAGnC,IADAhG,IAAMuW,EAAiBhL,EAAOvF,KAAKwQ,uBAC1BtW,EAAI,EAAGA,EAAIqW,EAAepW,OAAQD,IAC1CtC,KAAKwY,gBAAgBG,EAAerW,IAMrC,OAHAqL,EAAOvF,KAAK1F,IAAI,qBAAsB1C,KAAKqY,eAC3C1K,EAAOvF,KAAK1F,IAAI,uBAAwB1C,KAAKwY,iBAEtCK,gBAGRnO,gBAAOtE,EAAgByK,GACtB,GAAI7Q,KAAK+Y,eAAgB,CACxB/Y,KAAKiY,OAAO3N,KAAK,EAAI,IAcrB,IAAKtH,IAAIV,EAAI,EAAGA,EAAItC,KAAKuY,gBAAgBhW,OAAQD,IAChDtC,KAAKuY,gBAAgBjW,GAAG0W,SAAShZ,KAAKiY,QAIxCrI,YAAMlF,iBAAOtE,EAAGyK,8CA9FeoG,GCM3BgC,EAAkB,IAAIlB,EAAKmB,gBAKjC,SAASC,EAAelX,EAAcmE,GACrChE,IAAMgX,EAAmBhT,EAAEiT,YACrBC,EAAuBlT,EAAEmT,YAE/BxW,GAAMmD,cAAgBE,EACtBrD,GAAMyW,IAAMF,EACZF,EAAUjW,KAAKlB,EAAMc,IAGtBkW,EAAgBQ,sBAAgBrT,GAC/B+S,EAAe,eAAgB/S,IAEhC6S,EAAgBS,oBAActT,GAC7B+S,EAAe,aAAc/S,IAE9B6S,EAAgBU,kBAAYvT,GAC3B+S,EAAe,WAAY/S,IAE5B6S,EAAgBW,mBAAaxT,GAC5B+S,EAAe,YAAa/S,QAGhByT,cAOZ,WAAYC,GACXlK,YAAMkK,GALG9Z,wBAA6B,EAC7BA,sBAA2B,EAC7BA,cAAoB,IAAI8B,EAK/B9B,KAAK+Z,gBAAkB/Z,KAAKga,oBAC5Bha,KAAKia,eAAiBja,KAAKka,mBAE3Bla,KAAKma,wBACLna,KAAKoa,+SAGN3X,YAAGR,EAAcC,GAChBlC,KAAKqa,SAAS5X,GAAGR,EAAMC,gBAGxBQ,aAAIT,EAAcC,GACjBlC,KAAKqa,SAAS3X,IAAIT,EAAMC,gBAGzBiB,cAAKlB,sEACJjC,KAAKqa,UAASjX,eAAMnB,EAAMjC,aAASkD,KAGpC7C,EAAIqW,8BACH,OAAO1W,KAAK+Z,iBAGb1Z,EAAIyW,6BACH,OAAO9W,KAAKia,gBAGb5Z,EAAIia,gCACH,OAAOta,KAAKua,mBAGbla,EAAIia,8BAAiBha,GACpBN,KAAKua,kBAAoBja,EAEzBN,KAAKma,wBACLna,KAAKoa,wBAGN/Z,EAAIma,8BACH,OAAOxa,KAAKya,iBAGbpa,EAAIqa,4BAAepa,GAClBN,KAAKya,gBAAkBna,EAEnBA,EACHN,KAAK2a,mBAAmB1B,GAExBjZ,KAAK2a,mBAAmB,mBAI1BlE,2BAAkBC,GACjB1W,KAAK+Z,gBAAkBrD,EAEvB1W,KAAKma,qCAGNxD,2BAAkBD,GACjB1W,KAAK+Z,iBAAmBrD,EAExB1W,KAAKma,qCAGNvD,8BAAqBF,GACpB1W,KAAK+Z,iBAAmB/Z,KAAK+Z,gBAAkBrD,EAE/C1W,KAAKma,qCAGNtD,0BAAiBC,GAChB9W,KAAKia,eAAiBnD,EAEtB9W,KAAKoa,oCAGNrD,0BAAiBD,GAChB9W,KAAKia,gBAAkBnD,EAEvB9W,KAAKoa,oCAGNpD,6BAAoBF,GACnB9W,KAAKia,gBAAkBja,KAAKia,eAAiBnD,EAE7C9W,KAAKoa,oCAGIQ,4BAAmBlE,GAC5B9G,YAAM6G,4BAAkBC,gBAGfmE,2BAAkB/D,GAC3BlH,YAAMiH,2BAAiBC,gBAGdqD,iCACJna,KAAKua,kBAGTva,KAAK6a,kBAAkB7a,KAAK+Z,iBAF5B/Z,KAAK4a,mBAAmB,gBAMhBR,gCACJpa,KAAKua,kBAGTva,KAAK6a,kBAAkB7a,KAAKia,gBAF5Bja,KAAK6a,kBAAkB,gBAMzBC,qBACC1Y,IAAMgG,EAAOpI,KAAK+a,eAClB,GAAK3S,EAIL,OAAOA,EAAK0S,uDAhIa/C,EAAK8B,OAuI1B9W,GAAsB,CAAEyW,IAAK,IAAIK,EAAM,IAAI9B,EAAKiD,aAAgB9U,cAAe,MAKrF,SAAS+U,GAAchZ,EAAcmX,EAA0BE,GAC9DvW,GAAMmD,cAAgB,KACtBnD,GAAMyW,IAAMF,EACZF,EAAUjW,KAAKlB,EAAMc,QAeTmY,eAMZ,WAAYpB,cACXlK,YAAMkK,GANC9Z,qBAA0B,EACxBA,uBAA2C,IAAI+X,EAAKoD,iBACpDnb,oBAA0B,GAC1BA,kBAAwB,GAKjCA,KAAK0a,gBAAiB,EAEtB1a,KAAKma,wBACLna,KAAKoa,uBAELpa,KAAKob,kBAAkBC,iBAAW/C,GACjC,GAAqD,IAAhDtY,EAAKia,eAAiB3B,EAAM5B,iBAIoB,IAAhD1W,EAAK+Z,gBAAkBzB,EAAMxB,eAAlC,CAIA1U,IAAMyD,EAAQ7F,EAAKsb,eAAexV,QAAQwS,IAC3B,IAAXzS,EACHoV,GAAc,eAAgBjb,EAAMsY,GAEpCtY,EAAKsb,eAAe3Y,OAAOkD,EAAO,GAGnC7F,EAAKub,aAAa/Y,KAAK8V,sKAIzBkD,EAAIC,6BACH,OAAOzb,KAAK0b,gBAGbF,EAAIC,2BAAcnb,GACjBN,KAAK0b,eAAiBpb,EAEtBN,KAAKma,wBACLna,KAAKoa,wBAGNoB,EAAIG,wBACH,OAAO3b,KAAKua,mBAAqBva,KAAKya,iBAAmBza,KAAK0b,4BAG/D1C,kBAASP,GACR,GAAKzY,KAAK2b,SAAV,CAIA3b,KAAKsb,eAAiBtb,KAAKub,aAC3Bvb,KAAKub,aAAe,GAEpB9C,EAAMO,SAAShZ,KAAK4b,UAAW5b,KAAKob,mBAEpC,IAAKpY,IAAIV,EAAI,EAAGA,EAAItC,KAAKsb,eAAe/Y,OAAQD,IAC/C2Y,GAAc,aAAcjb,KAAMA,KAAKsb,eAAehZ,kBAI9C6X,iCACJna,KAAKua,kBAECva,KAAK0b,eACf1b,KAAK4a,mBAAmB,GAExB5a,KAAK4a,mBAAmB5a,KAAK+Z,iBAJ7B/Z,KAAK4a,mBAAmB,gBAQhBR,gCACJpa,KAAKua,kBAECva,KAAK0b,eACf1b,KAAK6a,kBAAkB,GAEvB7a,KAAK6a,kBAAkB7a,KAAKia,gBAJ5Bja,KAAK6a,kBAAkB,8CA5EShB,GCjMtBgC,eAKZ,WAAYC,GACXlM,YAAMkM,GALC9b,cAAoB,IAAI8B,EAO/B9B,KAAKmQ,SAAW,CAAEkG,IAAK,gHAGxByE,qBACC,OAAO9a,KAAKmQ,SAASkG,iBAGtB5T,YAAGR,EAAcC,GAChBlC,KAAKqa,SAAS5X,GAAGR,EAAMC,gBAGxBQ,aAAIT,EAAcC,GACjBlC,KAAKqa,SAAS3X,IAAIT,EAAMC,gBAGzBiB,cAAKlB,sEACJjC,KAAKqa,UAASjX,eAAMnB,EAAMjC,aAASkD,iBAGpC0V,gCAIC,IAHAxW,IAAM2Z,EAAuB,GAEzBzD,EAAQtY,KAAKgc,eACV1D,GACFA,aAAiB4C,IACpBa,EAAIvZ,KAAK8V,GAEVA,EAAQA,EAAM2D,UAGf,OAAOF,eAGRG,kBAAS5D,GACR1I,YAAMsM,mBAAS5D,GAEXA,aAAiB4C,IACpBlb,KAAKmD,KAAK,qBAAsBmV,gBAIlC6D,qBAAY7D,GACX1I,YAAMuM,sBAAY7D,GAEdA,aAAiB4C,IACpBlb,KAAKmD,KAAK,uBAAwBmV,gBAIpC7B,2BAAkBC,GAEjB,IADA1T,IAAIsV,EAAQtY,KAAKgc,eACV1D,GACNA,EAAM7B,kBAAkBC,GAExB4B,EAAQA,EAAM2D,uBAIhBtF,2BAAkBD,GAEjB,IADA1T,IAAIsV,EAAQtY,KAAKgc,eACV1D,GAAO,CACbtV,IAAIoZ,EAAI9D,EAAM0B,oBACdoC,GAAK1F,EACL4B,EAAM7B,kBAAkB2F,GAExB9D,EAAQA,EAAM2D,wBAIhBrF,8BAAqBF,GAEpB,IADA1T,IAAIsV,EAAQtY,KAAKgc,eACV1D,GAAO,CACbtV,IAAIoZ,EAAI9D,EAAM0B,oBACdoC,GAAKA,EAAI1F,EACT4B,EAAM7B,kBAAkB2F,GAExB9D,EAAQA,EAAM2D,wBAIhBpF,0BAAiBC,GAEhB,IADA9T,IAAIsV,EAAQtY,KAAKgc,eACV1D,GACNA,EAAMzB,iBAAiBC,GAEvBwB,EAAQA,EAAM2D,uBAIhBlF,0BAAiBD,GAEhB,IADA9T,IAAIsV,EAAQtY,KAAKgc,eACV1D,GAAO,CACbtV,IAAIoZ,EAAI9D,EAAM4B,mBACdkC,GAAKtF,EACLwB,EAAMzB,iBAAiBuF,GAEvB9D,EAAQA,EAAM2D,wBAIhBjF,6BAAoBF,GAEnB,IADA9T,IAAIsV,EAAQtY,KAAKgc,eACV1D,GAAO,CACbtV,IAAIoZ,EAAI9D,EAAM4B,mBACdkC,GAAKA,EAAItF,EACTwB,EAAMzB,iBAAiBuF,GAEvB9D,EAAQA,EAAM2D,YAIhBJ,EAAOQ,wBACNja,IAAM0Z,EAAkB,IAAI/D,EAAKuE,gBAGjC,OAFAR,EAAgB7Z,KAAO8V,EAAKwE,cAAcC,OAEnC,IAAIX,EAAUC,IAGtBD,EAAOY,yBACNra,IAAM0Z,EAAkB,IAAI/D,EAAKuE,gBAGjC,OAFAR,EAAgB7Z,KAAO8V,EAAKwE,cAAcG,QAEnC,IAAIb,EAAUC,IAGtBD,EAAOc,2BACNva,IAAM0Z,EAAkB,IAAI/D,EAAKuE,gBAGjC,OAFAR,EAAgB7Z,KAAO8V,EAAKwE,cAAcK,UAEnC,IAAIf,EAAUC,OAzIQ/D,EAAK8D,WCAvBgB,eAOZ,WAAY1H,GACXvF,YAAM,IAAI8F,QAJH1V,YAAiB,EACjBA,aAAkB,EAKzBA,KAAK2V,QAAU,IAAIhW,EAAO,EAAG,EAAG,EAAGK,MAEnCA,KAAK8c,UAAY,IAAIC,oBACrB/c,KAAK8c,UAAUvU,aAAc,EAE7BvI,KAAK8P,OAAO2F,SAAWzV,KAAK8c,UAE5B9c,KAAKgd,SAAW7H,EAChBnV,KAAKmV,QAAUA,2JAGhB9U,EAAI8U,uBACH,OAAOnV,KAAKgd,UAGb3c,EAAI8U,qBAAQA,GACXnV,KAAKgd,SAAW7H,EAChBnV,KAAK8c,UAAUG,aAAc,EAC7Bjd,KAAK8c,UAAUrF,IAAMtC,EAEjBA,GAAWA,EAAQ+H,MACtBld,KAAKmd,gBAAgBhI,EAAQ+H,MAAM7W,MAAO8O,EAAQ+H,MAAM5W,QAExDtG,KAAKmd,gBAAgB,EAAG,IAI1B9c,EAAIuV,sBACH,OAAO5V,KAAK2V,qBAGbwH,yBAAgB9W,EAAeC,GAC9BtG,KAAK8P,OAAO0F,SAAW,IAAI4H,gBAAoB/W,EAAOC,GACtDtG,KAAKqd,OAAShX,EACdrG,KAAKsd,QAAUhX,EACftG,KAAKO,sCAGNA,kCACCP,KAAK8P,OAAO0F,SAASK,SACrB7V,KAAK8P,OAAO0F,SAASM,UAAU9V,KAAKqd,QAAU,GAAMrd,KAAK2V,QAAQ/V,GAAII,KAAKsd,SAAW,GAAMtd,KAAK2V,QAAQ9V,GAAI,gBAG7G0Q,6BACCvQ,KAAK8P,OAAO0F,SAASO,qBACrB/V,KAAK8P,OAAO0F,SAASQ,aAAehW,KAAK8P,OAAO0F,SAASQ,YAAYhF,QAAQhR,KAAKwQ,OAClFxQ,KAAKwQ,MAAMS,SAASjR,KAAK0Q,QAG1BmM,EAAOU,cAAKjK,EAAapR,GACxBE,IAAMob,EAAS,IAAIX,GAAO,IAAI/H,iBAAsBI,KAAK5B,YAAK6B,GAC7DqI,EAAOrI,QAAUA,EACjBjT,GAAYA,EAASsb,OAGtB,OAAOA,6CAjEmB7L"}
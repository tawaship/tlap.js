{"version":3,"file":"trap.js","sources":["../node_modules/ismobilejs/esm/isMobile.js","../src/Application.ts","../node_modules/@tawaship/emitter/dist/Emitter.esm.js","../node_modules/@tawaship/task/dist/Task.esm.js","../src/DisplayObject.ts","../src/Object2D.ts","../src/Object3D.ts","../src/Container2D.ts","../src/Container3D.ts","../src/View.ts","../src/OIMO.ts","../src/PhysicsView.ts","../src/BodyPosition.ts","../src/BodyRotation.ts","../src/PhysicsObject3D.ts","../src/Anchor.ts","../src/Sprite.ts","../src/Mesh.ts","../src/Camera.ts"],"sourcesContent":["var appleIphone = /iPhone/i;\nvar appleIpod = /iPod/i;\nvar appleTablet = /iPad/i;\nvar appleUniversal = /\\biOS-universal(?:.+)Mac\\b/i;\nvar androidPhone = /\\bAndroid(?:.+)Mobile\\b/i;\nvar androidTablet = /Android/i;\nvar amazonPhone = /(?:SD4930UR|\\bSilk(?:.+)Mobile\\b)/i;\nvar amazonTablet = /Silk/i;\nvar windowsPhone = /Windows Phone/i;\nvar windowsTablet = /\\bWindows(?:.+)ARM\\b/i;\nvar otherBlackBerry = /BlackBerry/i;\nvar otherBlackBerry10 = /BB10/i;\nvar otherOpera = /Opera Mini/i;\nvar otherChrome = /\\b(CriOS|Chrome)(?:.+)Mobile/i;\nvar otherFirefox = /Mobile(?:.+)Firefox\\b/i;\nvar isAppleTabletOnIos13 = function (navigator) {\n    return (typeof navigator !== 'undefined' &&\n        navigator.platform === 'MacIntel' &&\n        typeof navigator.maxTouchPoints === 'number' &&\n        navigator.maxTouchPoints > 1 &&\n        typeof MSStream === 'undefined');\n};\nfunction createMatch(userAgent) {\n    return function (regex) { return regex.test(userAgent); };\n}\nexport default function isMobile(param) {\n    var nav = {\n        userAgent: '',\n        platform: '',\n        maxTouchPoints: 0\n    };\n    if (!param && typeof navigator !== 'undefined') {\n        nav = {\n            userAgent: navigator.userAgent,\n            platform: navigator.platform,\n            maxTouchPoints: navigator.maxTouchPoints || 0\n        };\n    }\n    else if (typeof param === 'string') {\n        nav.userAgent = param;\n    }\n    else if (param && param.userAgent) {\n        nav = {\n            userAgent: param.userAgent,\n            platform: param.platform,\n            maxTouchPoints: param.maxTouchPoints || 0\n        };\n    }\n    var userAgent = nav.userAgent;\n    var tmp = userAgent.split('[FBAN');\n    if (typeof tmp[1] !== 'undefined') {\n        userAgent = tmp[0];\n    }\n    tmp = userAgent.split('Twitter');\n    if (typeof tmp[1] !== 'undefined') {\n        userAgent = tmp[0];\n    }\n    var match = createMatch(userAgent);\n    var result = {\n        apple: {\n            phone: match(appleIphone) && !match(windowsPhone),\n            ipod: match(appleIpod),\n            tablet: !match(appleIphone) &&\n                (match(appleTablet) || isAppleTabletOnIos13(nav)) &&\n                !match(windowsPhone),\n            universal: match(appleUniversal),\n            device: (match(appleIphone) ||\n                match(appleIpod) ||\n                match(appleTablet) ||\n                match(appleUniversal) ||\n                isAppleTabletOnIos13(nav)) &&\n                !match(windowsPhone)\n        },\n        amazon: {\n            phone: match(amazonPhone),\n            tablet: !match(amazonPhone) && match(amazonTablet),\n            device: match(amazonPhone) || match(amazonTablet)\n        },\n        android: {\n            phone: (!match(windowsPhone) && match(amazonPhone)) ||\n                (!match(windowsPhone) && match(androidPhone)),\n            tablet: !match(windowsPhone) &&\n                !match(amazonPhone) &&\n                !match(androidPhone) &&\n                (match(amazonTablet) || match(androidTablet)),\n            device: (!match(windowsPhone) &&\n                (match(amazonPhone) ||\n                    match(amazonTablet) ||\n                    match(androidPhone) ||\n                    match(androidTablet))) ||\n                match(/\\bokhttp\\b/i)\n        },\n        windows: {\n            phone: match(windowsPhone),\n            tablet: match(windowsTablet),\n            device: match(windowsPhone) || match(windowsTablet)\n        },\n        other: {\n            blackberry: match(otherBlackBerry),\n            blackberry10: match(otherBlackBerry10),\n            opera: match(otherOpera),\n            firefox: match(otherFirefox),\n            chrome: match(otherChrome),\n            device: match(otherBlackBerry) ||\n                match(otherBlackBerry10) ||\n                match(otherOpera) ||\n                match(otherFirefox) ||\n                match(otherChrome)\n        },\n        any: false,\n        phone: false,\n        tablet: false\n    };\n    result.any =\n        result.apple.device ||\n            result.android.device ||\n            result.windows.device ||\n            result.other.device;\n    result.phone =\n        result.apple.phone || result.android.phone || result.windows.phone;\n    result.tablet =\n        result.apple.tablet || result.android.tablet || result.windows.tablet;\n    return result;\n}\n//# sourceMappingURL=isMobile.js.map","import * as THREE from 'three';\r\nimport isMobile from 'ismobilejs';\r\nimport { View } from './View';\r\nimport { DisplayObject, IInteractionEvent, ITickerData } from './DisplayObject';\r\n\r\nexport interface IApplicationOption {\r\n\tcanvas?: HTMLCanvasElement;\r\n\tcontainer?: HTMLElement;\r\n\twidth?: number;\r\n\theight?: number;\r\n\ttransparent?: boolean;\r\n\tresolution?: number;\r\n\tbackgroundColor?: number;\r\n\tantialias?: boolean;\r\n\tautoAdjust?: TAutoAdjust;\r\n}\r\n\r\nexport interface IAdjustDelegate {\r\n\t(app: Application): void;\r\n}\r\n\r\nexport type TAutoAdjust = boolean | IAdjustDelegate;\r\n\r\nexport interface IAutoAdjustDelegate {\r\n\t(): void;\r\n}\r\n\r\nexport type TAutoAdjuster = IAutoAdjustDelegate | null;\r\n\r\nexport interface ISize {\r\n\twidth: number;\r\n\theight: number;\r\n}\r\n\r\nexport interface IPosition {\r\n\tx: number;\r\n\ty: number;\r\n}\r\n\r\nexport interface IHorizontal {\r\n\tx: number;\r\n\twidth: number;\r\n}\r\n\r\nexport interface IVertical {\r\n\ty: number;\r\n\theight: number;\r\n}\r\n\r\nexport interface IRect extends ISize, IPosition {}\r\n\r\nexport class Application {\r\n\tprivate _container: HTMLElement;\r\n\tprivate _renderer: THREE.WebGLRenderer;\r\n\tprivate _views: View[] = [];\r\n\tprivate _lastTime: number = 0;\r\n\tprivate _playing: boolean = false;\r\n\tprivate _rendererSize: THREE.Vector2;\r\n\tprivate _autoAdjuster: TAutoAdjuster = null;\r\n\t\r\n\tinteractionDown: boolean = true;\r\n\tinteractionMove: boolean = false;\r\n\tinteractionUp: boolean = true;\r\n\t\r\n\tconstructor(options: IApplicationOption = {}) {\r\n\t\tconst canvas = options.canvas || undefined;\r\n\t\tconst container = options.container || document.body;\r\n\t\tconst transparent = options.transparent || false;\r\n\t\tconst antialias = options.antialias || false;\r\n\t\tconst rendererOptions = {\r\n\t\t\tcanvas, alpha: transparent, antialias\r\n\t\t}\r\n\t\t\r\n\t\tconst renderer = new THREE.WebGLRenderer(rendererOptions);\r\n\t\t\r\n\t\tconst width = options.width || 600;\r\n\t\tconst height = options.height || 400;\r\n\t\tconst resolution = options.resolution || 1;\r\n\t\tconst backgroundColor = options.backgroundColor || 0;\r\n\t\tconst opacity = transparent ? 0 : 1;\r\n\t\tconst autoAdjust = options.autoAdjust || false;\r\n\t\t\r\n\t\trenderer.setClearColor(backgroundColor, 0);\r\n\t\trenderer.setSize(width, height);\r\n\t\trenderer.setPixelRatio(resolution);\r\n\t\trenderer.autoClear = false;\r\n\t\t\r\n\t\tthis._container = container;\r\n\t\tthis._renderer = renderer;\r\n\t\tthis._rendererSize = new THREE.Vector2(width, height);\r\n\t\t\r\n\t\tconst dom = renderer.domElement;\r\n\t\tdom.style.position = 'absolute';\r\n\t\tconst isSP = isMobile(navigator.userAgent).any;\r\n\t\t\r\n\t\tconst raycaster = new THREE.Raycaster();\r\n\t\tconst mouse = new THREE.Vector2();\r\n\t\tconst event: IInteractionEvent = { type: '', emitted: [], originalEvent: null };\r\n\t\tlet down: DisplayObject[] = [];\r\n\t\tlet over: DisplayObject[] = [];\r\n\t\t\r\n\t\tconst cast = (e: Event, x: number, y: number) => {\r\n\t\t\tevent.originalEvent = e;\r\n\t\t\tevent.emitted = [];\r\n\t\t\t\r\n\t\t\tconst w = dom.offsetWidth;\r\n\t\t\tconst h = dom.offsetHeight;\r\n\t\t\t\r\n\t\t\tmouse.x = (x / w) * 2 - 1;\r\n\t\t\tmouse.y = -(y / h) * 2 + 1;\r\n\t\t\t\r\n\t\t\tconst c = this._views;\r\n\t\t\tfor (let i = c.length - 1; i >= 0; i--) {\r\n\t\t\t\tif (event.emitted.length > 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tc[i].onInteraction(event, raycaster, mouse);\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tconst dispatch = (targets: DisplayObject[], type: string) => {\r\n\t\t\tfor (let i = 0; i < targets.length; i++) {\r\n\t\t\t\ttargets[i].emit(type, event);\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\tconst separate = (_first: DisplayObject[], _emitted: DisplayObject[]) => {\r\n\t\t\tconst first: DisplayObject[] = _first.concat([]);\r\n\t\t\tconst emitted: DisplayObject[] = _emitted.concat([]);\r\n\t\t\tconst both: DisplayObject[] = [];\r\n\t\t\t\r\n\t\t\tfor (let i = first.length - 1; i >= 0; i--) {\r\n\t\t\t\tconst p = first[i];\r\n\t\t\t\tconst index = emitted.indexOf(p);\r\n\t\t\t\t\r\n\t\t\t\tif (index > -1) {\r\n\t\t\t\t\tfirst.splice(i, 1);\r\n\t\t\t\t\temitted.splice(index, 1);\r\n\t\t\t\t\tboth.push(p);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn { both, first, emitted };\r\n\t\t}\r\n\t\t\r\n\t\tconst startHandler = (e: Event, x: number, y: number) => {\r\n\t\t\tdown = [];\r\n\t\t\tif (!this.interactionDown) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tevent.type = 'system:interaction:pointerdown';\r\n\t\t\tcast(e, x, y);\r\n\t\t\t\r\n\t\t\tif (event.emitted.length === 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdispatch(event.emitted, 'pointerdown');\r\n\t\t\tdown = event.emitted;\r\n\t\t};\r\n\t\t\r\n\t\tconst moveHandler = (e: Event, x: number, y: number) => {\r\n\t\t\tif (!this.interactionMove) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tevent.type = 'system:interaction:pointermove';\r\n\t\t\tcast(e, x, y);\r\n\t\t\t\r\n\t\t\t// 開始がない\r\n\t\t\tif (over.length === 0) {\r\n\t\t\t\tif (event.emitted.length > 0) {\r\n\t\t\t\t\tdispatch(event.emitted, 'pointerover');\r\n\t\t\t\t\tover = event.emitted;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 開始はあるが乗っていない\r\n\t\t\tif (event.emitted.length === 0) {\r\n\t\t\t\tdispatch(over, 'pointerout');\r\n\t\t\t\tover = [];\r\n\t\t\t\t\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst saparated = separate(over, event.emitted);\r\n\t\t\t\r\n\t\t\t// 共にあるが一致していない\r\n\t\t\tdispatch(saparated.emitted, 'pointerover');\r\n\t\t\tdispatch(saparated.first, 'pointerout');\r\n\t\t\tover = event.emitted;\r\n\t\t\t\r\n\t\t\t// 共にあって一致\r\n\t\t\tdispatch(saparated.both, 'pointermove');\r\n\t\t}\r\n\t\t\r\n\t\tconst endHandler = (e: Event, x: number, y: number) => {\r\n\t\t\tif (!this.interactionUp) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tevent.type = 'system:interaction:pointerup';\r\n\t\t\tcast(e, x, y);\r\n\t\t\t\r\n\t\t\t// 開始がない\r\n\t\t\tif (down.length === 0) {\r\n\t\t\t\tif (event.emitted.length > 0) {\r\n\t\t\t\t\tdispatch(event.emitted, 'pointerup');\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 開始はあるが終了がない\r\n\t\t\tif (event.emitted.length === 0) {\r\n\t\t\t\tdispatch(down, 'pointerupoutside');\r\n\t\t\t\tdown = [];\r\n\t\t\t\t\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst saparated = separate(down, event.emitted);\r\n\t\t\t\r\n\t\t\t// 共にあるが一致していない\r\n\t\t\tdispatch(saparated.emitted, 'pointerup');\r\n\t\t\tdispatch(saparated.first, 'pointerupoutside');\r\n\t\t\t\r\n\t\t\t// 共にあって一致\r\n\t\t\tdispatch(saparated.both, 'pointerup');\r\n\t\t\tdispatch(saparated.both, 'pointertap');\r\n\t\t\tdown = [];\r\n\t\t}\r\n\t\t\r\n\t\tif (isSP) {\r\n\t\t\tdom.addEventListener('touchstart', e => {\r\n\t\t\t\tstartHandler(e, e.touches[0].clientX - dom.offsetLeft, e.touches[0].clientY - dom.offsetTop);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tdom.addEventListener('touchmove', e => {\r\n\t\t\t\tmoveHandler(e, e.touches[0].clientX - dom.offsetLeft, e.touches[0].clientY - dom.offsetTop);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tdom.addEventListener('touchend', e => {\r\n\t\t\t\tendHandler(e, e.changedTouches[0].clientX - dom.offsetLeft, e.changedTouches[0].clientY - dom.offsetTop);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tdom.addEventListener('mousedown', e => {\r\n\t\t\t\tstartHandler(e, e.offsetX, e.offsetY);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tdom.addEventListener('mousemove', e => {\r\n\t\t\t\tmoveHandler(e, e.offsetX, e.offsetY);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tdom.addEventListener('mouseup', e => {\r\n\t\t\t\tendHandler(e, e.offsetX, e.offsetY);\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\twindow.addEventListener('visibilitychange', e => {\r\n\t\t\tthis._lastTime = e.timeStamp;\r\n\t\t});\r\n\t\t\r\n\t\tconst step = (timestamp: number) => {\r\n\t\t\tconst delta = (timestamp - this._lastTime) * 0.06;\r\n\t\t\tthis._lastTime = timestamp;\r\n\t\t\t\r\n\t\t\tif (!this._playing) {\r\n\t\t\t\trequestAnimationFrame(step);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.update(delta);\r\n\t\t\trequestAnimationFrame(step);\r\n\t\t};\r\n\t\t\r\n\t\trequestAnimationFrame(step);\r\n\t\t\r\n\t\tif (autoAdjust) {\r\n\t\t\tif (autoAdjust === true) {\r\n\t\t\t\tthis.autoAdjuster = () => {\r\n\t\t\t\t\tthis.fullScreen()\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\tthis.autoAdjuster = () => {\r\n\t\t\t\t\tautoAdjust(this);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tget element() {\r\n\t\treturn this._renderer.domElement;\r\n\t}\r\n\t\r\n\tget width() {\r\n\t\treturn this._rendererSize.x;\r\n\t}\r\n\t\r\n\tget height() {\r\n\t\treturn this._rendererSize.y;\r\n\t}\r\n\t\r\n\taddView(view: View) {\r\n\t\tthis._views.push(view);\r\n\t\t\r\n\t\treturn view;\r\n\t}\r\n\t\r\n\tremoveView(view: View) {\r\n\t\tconst index = this._views.indexOf(view);\r\n\t\tif (index === -1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._views.splice(index, 1);\r\n\t\t\r\n\t\treturn view;\r\n\t}\r\n\t\r\n\tplay() {\r\n\t\tthis._container.appendChild(this._renderer.domElement);\r\n\t\t\r\n\t\tthis.start();\r\n\t}\r\n\t\r\n\tstart() {\r\n\t\tthis._playing = true;\r\n\t}\r\n\t\r\n\tstop() {\r\n\t\tthis._playing = false;\r\n\t}\r\n\t\r\n\tupdate(delta: number) {\r\n\t\tconst c = this._views;\r\n\t\tconst e: ITickerData = { delta };\r\n\t\t\r\n\t\tfor (let i = 0; i < c.length; i++) {\r\n\t\t\tc[i].update(e);\r\n\t\t}\r\n\t\t\r\n\t\tthis.render();\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tthis._renderer.setViewport(0, 0, this._rendererSize.x, this._rendererSize.y);\r\n\t\tthis._renderer.clear();\r\n\t\t\r\n\t\tconst c = this._views;\r\n\t\tfor (let i = 0; i < c.length; i++) {\r\n\t\t\tc[i].render(this._renderer);\r\n\t\t}\r\n\t}\r\n\t\r\n\tget autoAdjuster() {\r\n\t\treturn this._autoAdjuster;\r\n\t}\r\n\t\r\n\tset autoAdjuster(autoAdjuster: TAutoAdjuster) {\r\n\t\tif (this._autoAdjuster) {\r\n\t\t\twindow.removeEventListener('resize', this._autoAdjuster);\r\n\t\t}\r\n\t\t\r\n\t\tif (!autoAdjuster) {\r\n\t\t\tthis._autoAdjuster = null;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._autoAdjuster = autoAdjuster;\r\n\t\twindow.addEventListener('resize', autoAdjuster);\r\n\t\tautoAdjuster();\r\n\t}\r\n\t\r\n\t/**\r\n\t * Resize canvas to fit specified rectangle.\r\n\t * \r\n\t * @param rect Rectangle to adjust.\r\n\t */\r\n\tfullScreen(rect?: IRect) {\r\n\t\tconst view: HTMLCanvasElement = this._renderer.domElement;\r\n\t\tconst r: IRect = rect || {\r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\twidth: this._container.offsetWidth || window.innerWidth,\r\n\t\t\theight: this._container.offsetHeight || window.innerHeight\r\n\t\t};\r\n\t\t\r\n\t\tif (r.width / r.height > view.width / view.height) {\r\n\t\t\treturn this.adjustHeight(r.height).toCenter(r).toTop(r);\r\n\t\t}\r\n\t\t\r\n\t\treturn this.adjustWidth(r.width).toMiddle(r).toLeft(r);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Resize canvas to fit specified width.\r\n\t * \r\n\t * @param width Width to adjust.\r\n\t */\r\n\tadjustWidth(width?: number) {\r\n\t\tconst view: HTMLCanvasElement = this._renderer.domElement;\r\n\t\tconst w: number = width || this._container.offsetWidth || window.innerWidth;\r\n\t\t\r\n\t\tconst h: number = w / view.width * view.height;\r\n\t\t\r\n\t\t//const frame = this._piximData.frame;\r\n\t\tview.style.width = `${w}px`;\r\n\t\tview.style.height = `${h}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Resize canvas to fit specified height.\r\n\t * \r\n\t * @param height Height to adjust.\r\n\t */\r\n\tadjustHeight(height?: number) {\r\n\t\tconst view = this._renderer.domElement;\r\n\t\tconst h: number = height || this._container.offsetHeight || window.innerHeight;\r\n\t\t\r\n\t\tconst w = h / view.height * view.width;\r\n\t\t\r\n\t\t//const frame = this._piximData.frame;\r\n\t\tview.style.height = `${h}px`;\r\n\t\tview.style.width = `${w}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Left justified with respect to the reference data.\r\n\t * \r\n\t * @param horizontal Horizontal data used to calculate the position.\r\n\t */\r\n\ttoLeft(horizontal?: IHorizontal) {\r\n\t\tconst view = this._renderer.domElement;\r\n\t\tconst hol: IHorizontal = horizontal || {\r\n\t\t\tx: 0,\r\n\t\t\twidth: this._container.offsetWidth || window.innerWidth\r\n\t\t};\r\n\t\t\r\n\t\tview.style.left = `${hol.x}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Center justified with respect to the reference data.\r\n\t * \r\n\t * @param horizontal Horizontal data used to calculate the position.\r\n\t */\r\n\ttoCenter(horizontal?: IHorizontal) {\r\n\t\tconst view = this._renderer.domElement;\r\n\t\tconst hol: IHorizontal = horizontal || {\r\n\t\t\tx: 0,\r\n\t\t\twidth: this._container.offsetWidth || window.innerWidth\r\n\t\t};\r\n\t\t\r\n\t\tview.style.left = `${(hol.width - this._getViewRect().width) / 2 + hol.x}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Right justified with respect to the reference data.\r\n\t * \r\n\t * @param horizontal Horizontal data used to calculate the position.\r\n\t */\r\n\ttoRight(horizontal?: IHorizontal) {\r\n\t\tconst view = this._renderer.domElement;\r\n\t\tconst hol: IHorizontal = horizontal || {\r\n\t\t\tx: 0,\r\n\t\t\twidth: this._container.offsetWidth || window.innerWidth\r\n\t\t};\r\n\t\t\r\n\t\tview.style.left = `${hol.width - this._getViewRect().width + hol.x}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Top justified with respect to the reference data.\r\n\t * \r\n\t * @param vertical Vertical data used to calculate the position.\r\n\t */\r\n\ttoTop(vertical?: IVertical) {\r\n\t\tconst view = this._renderer.domElement;\r\n\t\tconst ver: IVertical = vertical || {\r\n\t\t\ty: 0,\r\n\t\t\theight: this._container.offsetHeight || window.innerHeight\r\n\t\t};\r\n\t\t\r\n\t\tview.style.top = `${ver.y}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Middle justified with respect to the reference data.\r\n\t * \r\n\t * @param vertical Vertical data used to calculate the position.\r\n\t */\r\n\ttoMiddle(vertical?: IVertical) {\r\n\t\tconst view = this._renderer.domElement;\r\n\t\tconst ver: IVertical = vertical || {\r\n\t\t\ty: 0,\r\n\t\t\theight: this._container.offsetHeight || window.innerHeight\r\n\t\t};\r\n\t\t\r\n\t\tview.style.top = `${(ver.height - this._getViewRect().height) / 2 + ver.y}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Bottom justified with respect to the reference data.\r\n\t * \r\n\t * @param vertical Vertical data used to calculate the position.\r\n\t */\r\n\ttoBottom(vertical?: IVertical) {\r\n\t\tconst view = this._renderer.domElement;\r\n\t\tconst ver: IVertical = vertical || {\r\n\t\t\ty: 0,\r\n\t\t\theight: this._container.offsetHeight || window.innerHeight\r\n\t\t};\r\n\t\t\r\n\t\tview.style.top = `${ver.height - this._getViewRect().height + ver.y}px`;\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\tprivate _getViewRect(): IRect {\r\n\t\tconst view = this._renderer.domElement;\r\n\t\t\r\n\t\treturn {\r\n\t\t\tx: parseInt(view.style.left.replace('px', '')),\r\n\t\t\ty: parseInt(view.style.top.replace('px', '')),\r\n\t\t\twidth: parseInt(view.style.width.replace('px', '')),\r\n\t\t\theight: parseInt(view.style.height.replace('px', ''))\r\n\t\t};\r\n\t}\r\n}\r\n","/*!\n * @tawaship/emitter - v3.1.1\n * \n * @author tawaship (makazu.mori@gmail.com)\n * @license MIT\n */\n\nclass Emitter {\r\n    constructor() {\r\n        this._events = {};\r\n    }\r\n    _on(type, callback, once) {\r\n        if (!type || !callback) {\r\n            return this;\r\n        }\r\n        const events = this._events[type] = this._events[type] || [];\r\n        for (let i = 0; i < events.length; i++) {\r\n            if (events[i].callback === callback) {\r\n                return this;\r\n            }\r\n        }\r\n        events.push({ callback, once });\r\n        return this;\r\n    }\r\n    /**\r\n     * Register event.\r\n     *\r\n     * @param type Event type.\r\n     * @param callback Callback when the event fires.\r\n     */\r\n    on(type, callback) {\r\n        return this._on(type, callback, false);\r\n    }\r\n    /**\r\n     * Register one-time event.\r\n     *\r\n     * @param type Event type.\r\n     * @param callback Callback when the event fires.\r\n     */\r\n    once(type, callback) {\r\n        return this._on(type, callback, true);\r\n    }\r\n    /**\r\n     * Unregister event.\r\n     *\r\n     * @param type Event type.\r\n     * @param callback Registered callback.\r\n     */\r\n    off(type, callback) {\r\n        if (!type || !callback) {\r\n            return this;\r\n        }\r\n        const events = this._events[type] || [];\r\n        for (let i = 0; i < events.length; i++) {\r\n            if (events[i].callback === callback) {\r\n                events.splice(i, 1);\r\n                return this;\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    _emit(type, context, ...args) {\r\n        if (!type) {\r\n            return this;\r\n        }\r\n        const events = this._events[type] || [];\r\n        const targets = [];\r\n        for (let i = events.length - 1; i >= 0; i--) {\r\n            const event = events[i];\r\n            if (event.once) {\r\n                events.splice(i, 1);\r\n            }\r\n            targets.push(event);\r\n        }\r\n        for (let i = targets.length - 1; i >= 0; i--) {\r\n            targets[i].callback.apply(context, args);\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Emit event.\r\n     *\r\n     * @param type Event type to emit.\r\n     * @param args Argument(s) in callback.\r\n     */\r\n    emit(type, ...args) {\r\n        return this._emit(type, this, ...args);\r\n    }\r\n    /**\r\n     * Emit event with specifying a context.\r\n     *\r\n     * @param type Event type to emit.\r\n     * @param context Context to execute the callback.\r\n     * @param args Argument(s) in callback.\r\n     */\r\n    cemit(type, context, ...args) {\r\n        return this._emit(type, context, ...args);\r\n    }\r\n    _emitAll(context, ...args) {\r\n        if (context == null) {\r\n            return this;\r\n        }\r\n        const targets = [];\r\n        for (let type in this._events) {\r\n            const events = this._events[type] || [];\r\n            for (let i = events.length - 1; i >= 0; i--) {\r\n                const event = events[i];\r\n                if (event.once) {\r\n                    events.splice(i, 1);\r\n                }\r\n                targets.push(event);\r\n            }\r\n        }\r\n        for (let i = targets.length - 1; i >= 0; i--) {\r\n            targets[i].callback.apply(context, args);\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Emit all events.\r\n     *\r\n     * @param args Argument(s) in callback.\r\n     */\r\n    emitAll(...args) {\r\n        return this._emitAll(this, ...args);\r\n    }\r\n    /**\r\n     * Emit all events with specifying a context.\r\n     *\r\n     * @param context Context to execute the callback.\r\n     * @param args Argument(s) in callback.\r\n     */\r\n    cemitAll(context, ...args) {\r\n        return this._emitAll(context, ...args);\r\n    }\r\n    /**\r\n     * Remove events grouped event type.\r\n     *\r\n     * @param type Event type to remove. If it is empty, removes all events.\r\n     */\r\n    clear(type = '') {\r\n        if (type) {\r\n            delete (this._events[type]);\r\n        }\r\n        else {\r\n            this._events = {};\r\n        }\r\n        return this;\r\n    }\r\n}\n\nexport { Emitter };\n//# sourceMappingURL=Emitter.esm.js.map\n","/*!\n * @tawaship/task - v1.1.0\n * \n * @author tawaship (makazu.mori@gmail.com)\n * @license MIT\n */\n\nclass Task {\r\n    constructor(callbacks, context) {\r\n        this._taskData = {\r\n            context: context == null ? this : context,\r\n            enabled: true,\r\n            index: -1,\r\n            callbacks: [],\r\n            value: null\r\n        };\r\n        this.add(callbacks);\r\n    }\r\n    /**\r\n     * Whether the task works.\r\n     */\r\n    get enabled() {\r\n        return this._taskData.enabled;\r\n    }\r\n    set enabled(enabled) {\r\n        this._taskData.enabled = enabled;\r\n    }\r\n    /**\r\n     * Add the task to the end of the list.\r\n     */\r\n    add(callbacks) {\r\n        if (!Array.isArray(callbacks)) {\r\n            callbacks = [callbacks];\r\n        }\r\n        const list = this._taskData.callbacks;\r\n        const flag = list.length === 0;\r\n        for (let i = 0; i < callbacks.length; i++) {\r\n            if (!(callbacks[i] instanceof Function)) {\r\n                continue;\r\n            }\r\n            list.push(callbacks[i]);\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Execute the current task.\r\n     */\r\n    done(...args) {\r\n        if (!this._taskData.enabled) {\r\n            return;\r\n        }\r\n        const task = this._taskData.callbacks[this._taskData.index];\r\n        if (!task) {\r\n            return;\r\n        }\r\n        return this._taskData.value = task.apply(this._taskData.context, args);\r\n    }\r\n    _to(index) {\r\n        this._taskData.index = Number(index);\r\n        return this;\r\n    }\r\n    /**\r\n     * Change the current task to the first task.\r\n     */\r\n    first() {\r\n        return this._to(0);\r\n    }\r\n    /**\r\n     * Change the current task to the previos task.\r\n     */\r\n    prev() {\r\n        return this._to(this._taskData.index - 1);\r\n    }\r\n    /**\r\n     * Change the current task to the next task.\r\n     */\r\n    next() {\r\n        return this._to(this._taskData.index + 1);\r\n    }\r\n    /**\r\n     * Change the current task to the specified task.\r\n     */\r\n    to(index) {\r\n        return this._to(index);\r\n    }\r\n    /**\r\n     * Skips all tasks and changes to the finished state.\r\n     */\r\n    finish() {\r\n        this._taskData.index = -1;\r\n        return this;\r\n    }\r\n    /**\r\n     * Cancel all task and leave them unregistered.\r\n     */\r\n    reset() {\r\n        this._taskData.callbacks = [];\r\n        this._taskData.index = -1;\r\n        this._taskData.value = null;\r\n        return this;\r\n    }\r\n    /**\r\n     * Destroy instance.\r\n     */\r\n    destroy() {\r\n        this.reset();\r\n    }\r\n    /**\r\n     * The value returned by the last task executed.\r\n     */\r\n    get value() {\r\n        return this._taskData.value;\r\n    }\r\n}\n\nexport { Task };\n//# sourceMappingURL=Task.esm.js.map\n","import * as THREE from 'three';\r\nimport { Emitter } from '@tawaship/emitter';\r\nimport { Task } from '@tawaship/task';\r\n\r\nexport interface IInteractionEvent extends THREE.Event {\r\n\ttype: string;\r\n\temitted: DisplayObject[];\r\n\toriginalEvent: Event | null;\r\n};\r\n\r\nexport interface ITickerData {\r\n\tdelta: number;\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst _box = new THREE.Box3();\r\n\r\nexport abstract class DisplayObject<T extends THREE.Object3D = THREE.Object3D> extends Emitter {\r\n\tprotected _three: T;\r\n\tprotected _sub: T;\r\n\tprotected _size: THREE.Vector3 = new THREE.Vector3();\r\n\tprotected _pivot: THREE.Vector3 = new THREE.Vector3();\r\n\tprotected _children: DisplayObject[] = [];\r\n\tprotected _task: Task;\r\n\t\r\n\tinteractive: boolean = false;\r\n\t\r\n\tconstructor(three: T) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis._three = this._sub = three;\r\n\t\t\r\n\t\tthree.addEventListener('system:interaction:pointerdown', event => {\r\n\t\t\tif (!this.interactive) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tevent.emitted.push(this);\r\n\t\t});\r\n\t\t\r\n\t\tthree.addEventListener('system:interaction:pointerup', event => {\r\n\t\t\tif (!this.interactive) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tevent.emitted.push(this);\r\n\t\t});\r\n\t\t\r\n\t\tthree.addEventListener('system:interaction:pointermove', event => {\r\n\t\t\tif (!this.interactive) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tevent.emitted.push(this);\r\n\t\t});\r\n\t\t\r\n\t\tthree.addEventListener('system:interaction:pointerupoutside', event => {\r\n\t\t\tif (!this.interactive) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tevent.emitted.push(this);\r\n\t\t});\r\n\t\t\r\n\t\tthis._task = new Task([], this);\r\n\t\tthis._task.first();\r\n\t}\r\n\t\r\n\tget three() {\r\n\t\treturn this._three;\r\n\t}\r\n\t\r\n\tget task() {\r\n\t\treturn this._task;\r\n\t}\r\n\t\r\n\tget parent(): DisplayObject | null {\r\n\t\treturn this._three.userData.parent;\r\n\t}\r\n\t\r\n\tget children() {\r\n\t\treturn this._children;\r\n\t}\r\n\t\r\n\tupdateTask(e: ITickerData) {\r\n\t\tthis._task.done(e);\r\n\t}\r\n\t\r\n\tget width() {\r\n\t\tthis.updateBoundingBox();\r\n\t\treturn this._size.x;\r\n\t}\r\n\t\r\n\tget height() {\r\n\t\tthis.updateBoundingBox();\r\n\t\treturn this._size.y;\r\n\t}\r\n\t\r\n\tget depth() {\r\n\t\tthis.updateBoundingBox();\r\n\t\treturn this._size.z * this.scale.z;\r\n\t}\r\n\t\r\n\tget x() {\r\n\t\treturn this._three.position.x;\r\n\t}\r\n\t\r\n\tset x(value) {\r\n\t\tthis._three.position.x = value;\r\n\t}\r\n\t\r\n\tget y() {\r\n\t\treturn this._three.position.y;\r\n\t}\r\n\t\r\n\tset y(value) {\r\n\t\tthis._three.position.y = value;\r\n\t}\r\n\t\r\n\tget z() {\r\n\t\treturn this._three.position.z;\r\n\t}\r\n\t\r\n\tset z(value) {\r\n\t\tthis._three.position.z = value;\r\n\t}\r\n\t\r\n\t/*\r\n\tget position() {\r\n\t\treturn this._three.position;\r\n\t}\r\n\t*/\r\n\t\r\n\tget scale() {\r\n\t\treturn this._three.scale;\r\n\t}\r\n\t\r\n\tget pivot() {\r\n\t\treturn this._pivot;\r\n\t}\r\n\t\r\n\tupdate(e: ITickerData) {\r\n\t\tthis.updateTransform();\r\n\t\tthis.updateTask(e);\r\n\t\t\r\n\t\tconst c = this._children;\r\n\t\tfor (let i = 0; i < c.length; i++) {\r\n\t\t\tc[i].update(e);\r\n\t\t}\r\n\t}\r\n\t\r\n\tabstract updateTransform(): void;\r\n\t\r\n\tupdateBoundingBox() {\r\n\t\tthis.updateTransform();\r\n\t\t\r\n\t\tthis._three.remove(this._sub)\r\n\t\t_box.setFromObject(this._sub);\r\n\t\tthis._three.add(this._sub)\r\n\t\t_box.getSize(this._size);\r\n\t\tthis._size.multiply(this.scale);\r\n\t}\r\n\t\r\n\taddChild(object: DisplayObject) {\r\n\t\tif (object.parent) {\r\n\t\t\tobject.parent.removeChild(object);\r\n\t\t}\r\n\t\t\r\n\t\tthis._children.push(object);\r\n\t\tthis._sub.add(object.three);\r\n\t\tobject.three.userData.parent = this;\r\n\t\t\r\n\t\treturn object;\r\n\t}\r\n\t\r\n\tremoveChild(object: DisplayObject) {\r\n\t\tif (object.parent !== this) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tconst index = this._children.indexOf(object);\r\n\t\tif (index === -1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._children.splice(index, 1);\r\n\t\tthis._sub.remove(object.three);\r\n\t\tobject.three.userData.parent = null;\r\n\t\t\r\n\t\treturn object;\r\n\t}\r\n}\r\n","import * as THREE from 'three';\r\nimport { DisplayObject } from './DisplayObject';\r\n\r\nexport abstract class Object2D<T extends THREE.Object3D = THREE.Object3D> extends DisplayObject<T> {\r\n\tprotected _skew: THREE.Vector2 = new THREE.Vector2();\r\n\t\r\n\tconstructor(three: T) {\r\n\t\tsuper(three);\r\n\t\t\r\n\t\tthree.matrixAutoUpdate = false;\r\n\t}\r\n\t\r\n\tget skew() {\r\n\t\treturn this._skew;\r\n\t}\r\n\t\r\n\tget rotation() {\r\n\t\treturn this._three.rotation.z;\r\n\t}\r\n\t\r\n\tset rotation(value) {\r\n\t\tthis._three.rotation.z = value;\r\n\t}\r\n\t\r\n\tupdateTransform() {\r\n\t\tthis._updateMatrix();\r\n\t}\r\n\t\r\n\t_updateMatrix() {\r\n\t\tconst x = this.x;\r\n\t\tconst y = this.y;\r\n\t\tconst z = this._three.position.z;\r\n\t\tconst scaleX = this.scale.x;\r\n\t\tconst scaleY = this.scale.y;\r\n\t\tconst skewX = this.skew.x;\r\n\t\tconst skewY = this.skew.y;\r\n\t\tconst rotation = this.rotation;\r\n\t\tconst pivotX = this.pivot.x;\r\n\t\tconst pivotY = this.pivot.y;\r\n\t\t\r\n\t\tconst a = Math.cos(rotation + skewY) * scaleX;\r\n\t\tconst b = Math.sin(rotation + skewY) * scaleX;\r\n\t\tconst c = -Math.sin(rotation - skewX) * scaleY;\r\n\t\tconst d = Math.cos(rotation - skewX) * scaleY;\r\n\t\tconst tx = x - ((pivotX * a) + (pivotY * c));\r\n\t\tconst ty = y - ((pivotX * b) + (pivotY * d));\r\n\t\t\r\n\t\tthis._three.matrix.set(\r\n\t\t\ta, c, 0, tx, \r\n\t\t\tb, d, 0, ty,\r\n\t\t\t0, 0, 1, z,\r\n\t\t\t0, 0, 0, 1\r\n\t\t);\r\n\t}\r\n}","import * as THREE from 'three';\r\nimport { DisplayObject } from './DisplayObject';\r\n\r\nexport abstract class Object3D<T extends THREE.Object3D = THREE.Object3D> extends DisplayObject<T> {\r\n\tget rotation() {\r\n\t\treturn this._three.rotation;\r\n\t}\r\n}","import * as THREE from 'three';\r\nimport { Object2D } from './Object2D';\r\n\r\nexport class Container2D extends Object2D<THREE.Group> {\r\n\tconstructor() {\r\n\t\tsuper(new THREE.Group());\r\n\t\t\r\n\t\tthis._sub = new THREE.Group();\r\n\t\tthis._three.add(this._sub);\r\n\t}\r\n\t\r\n\t_updateOrder() {\r\n\t\tconst c = this._children;\r\n\t\tfor (let i = 0; i < c.length; i++) {\r\n\t\t\tc[i].three.position.z = i * 0.0000001;\r\n\t\t}\r\n\t}\r\n\t\r\n\tupdateTransform() {\r\n\t\tthis._updateMatrix();\r\n\t}\r\n}","import * as THREE from 'three';\r\nimport { Object3D } from './Object3D';\r\n\r\nexport class Container3D extends Object3D<THREE.Group> {\r\n\tconstructor() {\r\n\t\tsuper(new THREE.Group());\r\n\t\t\r\n\t\tthis._sub = new THREE.Group();\r\n\t\tthis._three.add(this._sub);\r\n\t}\r\n\t\r\n\tupdateTransform() {\r\n\t\tthis._sub.position.x = -this._pivot.x;\r\n\t\tthis._sub.position.y = -this._pivot.y;\r\n\t\tthis._sub.position.z = -this._pivot.z;\r\n\t}\r\n}","import * as THREE from 'three';\r\nimport { Object3D } from './Object3D';\r\nimport { Camera } from './Camera';\r\nimport { IInteractionEvent, ITickerData } from './DisplayObject';\r\n\r\nexport class View extends Object3D<THREE.Scene> {\r\n\tprivate _cameras: Camera[] = [];\r\n\t\r\n\tconstructor() {\r\n\t\tsuper(new THREE.Scene());\r\n\t\t\r\n\t\tthis.interactive = true;\r\n\t}\r\n\t\r\n\tget scene() {\r\n\t\treturn this._three;\r\n\t}\r\n\t\r\n\taddCamera(camera: Camera) {\r\n\t\tif (camera.parent) {\r\n\t\t\tcamera.parent.removeChild(camera);\r\n\t\t}\r\n\t\t\r\n\t\tthis._cameras.push(camera);\r\n\t\tthis._three.add(camera.three);\r\n\t\tcamera.three.userData.parent = this;\r\n\t\t\r\n\t\treturn camera;\r\n\t}\r\n\t\r\n\tremoveCamera(camera: Camera) {\r\n\t\tif (camera.parent !== this) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tconst index = this._cameras.indexOf(camera);\r\n\t\tif (index === -1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._cameras.splice(index, 1);\r\n\t\tthis._three.remove(camera.three);\r\n\t\tcamera.three.userData.parent = null;\r\n\t\t\r\n\t\treturn camera;\r\n\t}\r\n\t\r\n\tadd(three: THREE.Object3D) {\r\n\t\tthis._three.add(three);\r\n\t\t\r\n\t\treturn three;\r\n\t}\r\n\t\r\n\tremove(three: THREE.Object3D) {\r\n\t\tthis._three.remove(three);\r\n\t\t\r\n\t\treturn three;\r\n\t}\r\n\t\r\n\tupdate(e: ITickerData) {\r\n\t\tthis.updateTask(e);\r\n\t\t\r\n\t\tconst c = this._children;\r\n\t\tfor (let i in this._children) {\r\n\t\t\tc[i].update(e);\r\n\t\t}\r\n\t}\r\n\t\r\n\trender(renderer: THREE.WebGLRenderer) {\r\n\t\tconst c = this._cameras;\r\n\t\t\r\n\t\tfor (let i = 0; i < c.length; i++) {\r\n\t\t\trenderer.clearDepth();\r\n\t\t\tc[i].render(renderer, this._three);\r\n\t\t}\r\n\t}\r\n\t\r\n\tonInteraction(event: IInteractionEvent, raycaster: THREE.Raycaster, mouse: THREE.Vector2) {\r\n\t\tif (!this.interactive) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tconst c = this._cameras;\r\n\t\t\r\n\t\tfor (let i = 0; i < c.length; i++) {\r\n\t\t\tif (event.emitted.length > 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\traycaster.setFromCamera(mouse, c[i].camera);\r\n\t\t\t\r\n\t\t\tconst f: (p: THREE.Object3D) => THREE.Object3D[] = (p: THREE.Object3D) => {\r\n\t\t\t\treturn p.children.map(p => {\r\n\t\t\t\t\tif (p instanceof THREE.Mesh) {\r\n\t\t\t\t\t\treturn p;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn f(p);\r\n\t\t\t\t}).flat();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst meshes = f(this._three);\r\n\t\t\t\r\n\t\t\tconst intersects = raycaster.intersectObjects(meshes);\r\n\t\t\t\r\n\t\t\tfor (let i = 0; i < intersects.length; i++) {\r\n\t\t\t\tif (event.emitted.length > 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tlet p = intersects[i].object;\r\n\t\t\t\twhile (p !== this._three) {\r\n\t\t\t\t\tp.dispatchEvent(event);\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (!p.parent) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tp = p.parent;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tupdateTransform() {\r\n\t\r\n\t}\r\n}\r\n","declare const OIMO: any;\r\n\r\nexport default OIMO;","import * as THREE from 'three';\r\nimport { View } from './View';\r\nimport { ITickerData } from './DisplayObject';\r\nimport { PhysicsObject3D } from './PhysicsObject3D';\r\nimport OIMO from './OIMO';\r\n\r\nexport class PhysicsView extends View {\r\n\tprivate _world: any;\r\n\tphysicsEnabled: boolean = true;\r\n\t\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis._world = new OIMO.World();\r\n\t\tthis._world.setGravity(new OIMO.Vec3(0, -9.8, 0));\r\n\t}\r\n\t\r\n\tget world() {\r\n\t\treturn this._world;\r\n\t}\r\n\t\r\n\taddChild(object: PhysicsObject3D) {\r\n\t\tsuper.addChild(object);\r\n\t\t\r\n\t\tthis._world.addRigidBody(object.body);\r\n\t\t\r\n\t\treturn object;\r\n\t}\r\n\t\r\n\tremoveChild(object: PhysicsObject3D) {\r\n\t\tconst o = super.removeChild(object);\r\n\t\t\r\n\t\tif (!o) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._world.removeRigidBody(object.body);\r\n\t\t\r\n\t\treturn o;\r\n\t}\r\n\t\r\n\tupdate(e: ITickerData) {\r\n\t\tif (this.physicsEnabled) {\r\n\t\t\tthis._world.step(1 / 60);\r\n\t\t}\r\n\t\t\r\n\t\tthis.updateTask(e);\r\n\t\t\r\n\t\tconst c = this._children;\r\n\t\tfor (let i in this._children) {\r\n\t\t\tc[i].update(e);\r\n\t\t}\r\n\t}\r\n}\r\n","import { PhysicsObject3D } from './PhysicsObject3D';\r\n\r\nexport class BodyPosition {\r\n\tprivate _object: PhysicsObject3D;\r\n\t\r\n\tconstructor(object: PhysicsObject3D) {\r\n\t\tthis._object = object;\r\n\t}\r\n\t\r\n\tget x() {\r\n\t\treturn this._object.body.getPosition().x;\r\n\t}\r\n\t\r\n\tset x(value) {\r\n\t\tconst position = this._object.body.getPosition();\r\n\t\tposition.x = value;\r\n\t\tthis._object.body.setPosition(position);\r\n\t\tthis._object.updateTransform();\r\n\t}\r\n\t\r\n\tget y() {\r\n\t\treturn this._object.body.getPosition().y;\r\n\t}\r\n\t\r\n\tset y(value) {\r\n\t\tconst position = this._object.body.getPosition();\r\n\t\tposition.y = value;\r\n\t\tthis._object.body.setPosition(position);\r\n\t\tthis._object.updateTransform();\r\n\t}\r\n\t\r\n\tget z() {\r\n\t\treturn this._object.body.getPosition().z;\r\n\t}\r\n\t\r\n\tset z(value) {\r\n\t\tconst position = this._object.body.getPosition();\r\n\t\tposition.z = value;\r\n\t\tthis._object.body.setPosition(position);\r\n\t\tthis._object.updateTransform();\r\n\t}\r\n\t\r\n\tset(x: number, y?: number, z?: number) {\r\n\t\tif (y === undefined) {\r\n\t\t\ty = x;\r\n\t\t}\r\n\t\t\r\n\t\tif (z === undefined) {\r\n\t\t\tz = y;\r\n\t\t}\r\n\t\t\r\n\t\tconst position = this._object.body.getPosition();\r\n\t\tposition.x = x;\r\n\t\tposition.y = y;\r\n\t\tposition.z = z;\r\n\t\t\r\n\t\tthis._object.body.setPosition(position);\r\n\t\tthis._object.updateTransform();\r\n\t}\r\n}","import { PhysicsObject3D } from './PhysicsObject3D';\r\n\r\nexport class BodyRotation {\r\n\tprivate _object: PhysicsObject3D;\r\n\t\r\n\tconstructor(object: PhysicsObject3D) {\r\n\t\tthis._object = object;\r\n\t}\r\n\t\r\n\tget x() {\r\n\t\treturn this._object.body.getRotation().toEulerXyz().x;\r\n\t}\r\n\t\r\n\tset x(value) {\r\n\t\tconst rotation = this._object.body.getRotation().toEulerXyz();\r\n\t\trotation.x = value;\r\n\t\tthis._object.body.setRotationXyz(rotation);\r\n\t\tthis._object.updateTransform();\r\n\t}\r\n\t\r\n\tget y() {\r\n\t\treturn this._object.body.getRotation().toEulerXyz().y;\r\n\t}\r\n\t\r\n\tset y(value) {\r\n\t\tconst rotation = this._object.body.getRotation().toEulerXyz();\r\n\t\trotation.y = value;\r\n\t\tthis._object.body.setRotationXyz(rotation);\r\n\t\tthis._object.updateTransform();\r\n\t}\r\n\t\r\n\tget z() {\r\n\t\treturn this._object.body.getRotation().toEulerXyz().z;\r\n\t}\r\n\t\r\n\tset z(value) {\r\n\t\tconst rotation = this._object.body.getRotation().toEulerXyz();\r\n\t\trotation.z = value;\r\n\t\tthis._object.body.setRotationXyz(rotation);\r\n\t\tthis._object.updateTransform();\r\n\t}\r\n\t\r\n\tset(x: number, y?: number, z?: number) {\r\n\t\tif (y === undefined) {\r\n\t\t\ty = x;\r\n\t\t}\r\n\t\t\r\n\t\tif (z === undefined) {\r\n\t\t\tz = y;\r\n\t\t}\r\n\t\t\r\n\t\tconst rotation = this._object.body.getRotation().toEulerXyz();\r\n\t\trotation.x = x;\r\n\t\trotation.y = y;\r\n\t\trotation.z = z;\r\n\t\t\r\n\t\tthis._object.body.setRotationXyz(rotation);\r\n\t\tthis._object.updateTransform();\r\n\t}\r\n}","import * as THREE from 'three';\r\nimport { Object3D } from './Object3D';\r\nimport OIMO from './OIMO';\r\nimport { BodyPosition } from './BodyPosition';\r\nimport { BodyRotation } from './BodyRotation';\r\n\r\nexport class PhysicsObject3D extends Object3D<THREE.Object3D> {\r\n\tprivate _body: any;\r\n\tprivate _contantEnabled: boolean = false;\r\n\tprivate _position: BodyPosition;\r\n\tprivate _rotation: BodyRotation;\r\n\t\r\n\tconstructor(three: THREE.Object3D, body: any) {\r\n\t\tsuper(three);\r\n\t\t\r\n\t\tthis._body = body;\r\n\t\tthis._position = new BodyPosition(this);\r\n\t\tthis._rotation = new BodyRotation(this);\r\n\t\t\r\n\t\tbody.userData = {};\r\n\t\tbody.userData.ref = this;\r\n\t}\r\n\t\r\n\tget body() {\r\n\t\treturn this._body;\r\n\t}\r\n\t\r\n\tget x() {\r\n\t\treturn this._position.x;\r\n\t}\r\n\t\r\n\tset x(value) {\r\n\t\tthis._position.x = value;\r\n\t}\r\n\t\r\n\tget y() {\r\n\t\treturn this._position.y;\r\n\t}\r\n\t\r\n\tset y(value) {\r\n\t\tthis._position.y = value;\r\n\t}\r\n\t\r\n\tget z() {\r\n\t\treturn this._position.z;\r\n\t}\r\n\t\r\n\tset z(value) {\r\n\t\tthis._position.z = value;\r\n\t}\r\n\t\r\n\tget position() {\r\n\t\treturn this._position;\r\n\t}\r\n\t\r\n\t// @ts-ignore\r\n\tget rotation() {\r\n\t\treturn this._rotation;\r\n\t}\r\n\t\r\n\tget contactEnabled() {\r\n\t\treturn this._contantEnabled;\r\n\t}\r\n\t\r\n\tset contactEnabled(value) {\r\n\t\tthis._contantEnabled = value;\r\n\t\t\r\n\t\tif (!value) {\r\n\t\t\tlet shape = this._body.getShapeList();\r\n\t\t\twhile (shape) {\r\n\t\t\t\tshape.setContactCallback(null);\r\n\t\t\t\tshape = shape.getNext();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tconst callback = new OIMO.ContactCallback();\r\n\t\tconst event = { hit: null, originalEvent: null };\r\n\t\t\r\n\t\tcallback.beginContact = (e: any) => {\r\n\t\t\tevent.hit = e.getShape2().getRigidBody().userData.ref;\r\n\t\t\tevent.originalEvent = e;\r\n\t\t\tthis.emit('beginContact', event);\r\n\t\t};\r\n\t\tcallback.endContact = (e: any) => {\r\n\t\t\tevent.hit = e.getShape2().getRigidBody().userData.ref;\r\n\t\t\tevent.originalEvent = e;\r\n\t\t\tthis.emit('endContact', event);\r\n\t\t};\r\n\t\tcallback.preSolve = (e: any) => {\r\n\t\t\tevent.hit = e.getShape2().getRigidBody().userData.ref;\r\n\t\t\tevent.originalEvent = e;\r\n\t\t\tthis.emit('preSolve', event);\r\n\t\t};\r\n\t\tcallback.postSolve = (e: any) => {\r\n\t\t\tevent.hit = e.getShape2().getRigidBody().userData.ref;\r\n\t\t\tevent.originalEvent = e;\r\n\t\t\tthis.emit('postSolve', event);\r\n\t\t};\r\n\t\t\r\n\t\tlet shape = this._body.getShapeList();\r\n\t\twhile (shape) {\r\n\t\t\tshape.setContactCallback(callback);\r\n\t\t\tshape = shape.getNext();\r\n\t\t}\r\n\t}\r\n\t\r\n\tupdateTransform() {\r\n\t\tthis._three.position.copy(this._body.getPosition());\r\n\t\tthis._three.quaternion.copy(this._body.getOrientation());\r\n\t}\r\n\t\r\n\tupdateBoundingBox() {\r\n\t\r\n\t}\r\n}","import * as THREE from 'three';\r\nimport { IMesh } from './IMesh';\r\n\r\nexport class Anchor {\r\n\tprivate _x: number;\r\n\tprivate _y: number;\r\n\tprivate _z: number;\r\n\tprivate _mesh: IMesh;\r\n\t\r\n\tconstructor(x: number, y: number, z: number, mesh: IMesh) {\r\n\t\tthis._x = x;\r\n\t\tthis._y = y;\r\n\t\tthis._z = z;\r\n\t\tthis._mesh = mesh;\r\n\t}\r\n\t\r\n\tget x() {\r\n\t\treturn this._x;\r\n\t}\r\n\t\r\n\tset x(value) {\r\n\t\tthis._x = value;\r\n\t\tthis._mesh.updateGeometryPosition();\r\n\t}\r\n\t\r\n\tget y() {\r\n\t\treturn this._y;\r\n\t}\r\n\t\r\n\tset y(value) {\r\n\t\tthis._y = value;\r\n\t\tthis._mesh.updateGeometryPosition();\r\n\t}\r\n\t\r\n\tget z() {\r\n\t\treturn this._z;\r\n\t}\r\n\t\r\n\tset z(value) {\r\n\t\tthis._z = value;\r\n\t\tthis._mesh.updateGeometryPosition();\r\n\t}\r\n\t\r\n\tset(x: number, y?: number, z?: number) {\r\n\t\tif (y === undefined) {\r\n\t\t\ty = x;\r\n\t\t}\r\n\t\t\r\n\t\tif (z === undefined) {\r\n\t\t\tz = y;\r\n\t\t}\r\n\t\t\r\n\t\tthis._x = x;\r\n\t\tthis._y = y;\r\n\t\tthis._z = z;\r\n\t\t\r\n\t\tthis._mesh.updateGeometryPosition();\r\n\t}\r\n}","import * as THREE from 'three';\r\nimport { Object2D } from './Object2D';\r\nimport { Anchor } from './Anchor';\r\nimport { IMesh } from './IMesh'\r\n\r\nexport class Sprite extends Object2D<THREE.Mesh> implements IMesh {\r\n\tprivate _texture: THREE.Texture;\r\n\tprivate _anchor: Anchor;\r\n\tprivate _material: THREE.MeshBasicMaterial;\r\n\tprivate _width: number = 0;\r\n\tprivate _height: number = 0;\r\n\t\r\n\tconstructor(texture: THREE.Texture) {\r\n\t\tsuper(new THREE.Mesh());\r\n\t\t\r\n\t\tthis._anchor = new Anchor(0, 0, 0, this);\r\n\t\t\r\n\t\tthis._material = new THREE.MeshBasicMaterial();\r\n\t\tthis._material.transparent = true;\r\n\t\t\r\n\t\tthis._three.material = this._material;\r\n\t\t\r\n\t\tthis._texture = texture;\r\n\t\tthis.texture = texture;\r\n\t}\r\n\t\r\n\tget texture() {\r\n\t\treturn this._texture;\r\n\t}\r\n\t\r\n\tset texture(texture) {\r\n\t\tthis._texture = texture;\r\n\t\tthis._material.needsUpdate = true;\r\n\t\tthis._material.map = texture;\r\n\t\t\r\n\t\tif (texture && texture.image) {\r\n\t\t\tthis._updateGeometry(texture.image.width, texture.image.height);\r\n\t\t} else {\r\n\t\t\tthis._updateGeometry(0, 0);\r\n\t\t}\r\n\t}\r\n\t\r\n\tget anchor() {\r\n\t\treturn this._anchor;\r\n\t}\r\n\t\r\n\t_updateGeometry(width: number, height: number) {\r\n\t\tthis._three.geometry = new THREE.PlaneGeometry(width, height);\r\n\t\tthis._width = width;\r\n\t\tthis._height = height;\r\n\t\tthis.updateGeometryPosition();\r\n\t}\r\n\t\r\n\tupdateGeometryPosition() {\r\n\t\tthis._three.geometry.center();\r\n\t\tthis._three.geometry.translate(this._width * (0.5 - this._anchor.x), this._height * (0.5 - this._anchor.y), 0)\r\n\t}\r\n\t\r\n\tupdateBoundingBox() {\r\n\t\tthis._three.geometry.computeBoundingBox();\r\n\t\tthis._three.geometry.boundingBox && this._three.geometry.boundingBox.getSize(this._size);\r\n\t\tthis._size.multiply(this.scale);\r\n\t}\r\n\t\r\n\tupdateTransform() {\r\n\t\t\r\n\t}\r\n\t\r\n\tstatic from(url: string, callback: (sprite: Sprite) => void) {\r\n\t\tconst sprite = new Sprite(new THREE.TextureLoader().load(url, texture => {\r\n\t\t\tsprite.texture = texture;\r\n\t\t\tcallback && callback(sprite);\r\n\t\t}));\r\n\t\t\r\n\t\treturn sprite;\r\n\t}\r\n}","import * as THREE from 'three';\r\nimport { Object3D } from './Object3D';\r\nimport { Anchor } from './Anchor';\r\nimport { IMesh } from './IMesh'\r\n\r\nexport class Mesh extends Object3D<THREE.Mesh> implements IMesh {\r\n\tprivate _anchor: Anchor;\r\n\t\r\n\tconstructor(geometry: THREE.BufferGeometry, material: THREE.Material) {\r\n\t\tsuper(new THREE.Mesh(geometry, material));\r\n\t\t\r\n\t\tthis._anchor = new Anchor(0, 0, 0, this);\r\n\t\tmaterial.transparent = true;\r\n\t\tthis.updateGeometryPosition();\r\n\t}\r\n\t\r\n\tget anchor() {\r\n\t\treturn this._anchor;\r\n\t}\r\n\t\r\n\tupdateGeometryPosition() {\r\n\t\tthis._three.geometry.center();\r\n\t\tthis.updateBoundingBox();\r\n\t\tthis._three.geometry.translate(this._size.x * (0.5 - this._anchor.x), this._size.y * (0.5 - this._anchor.y), this._size.z * (0.5 - this._anchor.z))\r\n\t}\r\n\t\r\n\tupdateBoundingBox() {\r\n\t\tthis._three.geometry.computeBoundingBox();\r\n\t\tthis._three.geometry.boundingBox && this._three.geometry.boundingBox.getSize(this._size);\r\n\t\tthis._size.multiply(this.scale);\r\n\t}\r\n\t\r\n\tupdateTransform() {\r\n\t\t\r\n\t}\r\n}","import * as THREE from 'three';\r\nimport { Object3D } from './Object3D';\r\nimport { IRect } from './Application';\r\n\r\nexport class Camera extends Object3D<THREE.Camera> {\r\n\tprivate _viewport: IRect;\r\n\t\r\n\tconstructor(camera: THREE.Camera, viewport: IRect) {\r\n\t\tsuper(camera);\r\n\t\t\r\n\t\tthis._viewport = viewport;\r\n\t}\r\n\t\r\n\tget camera() {\r\n\t\treturn this._three;\r\n\t}\r\n\t\r\n\tget viewport() {\r\n\t\treturn this._viewport;\r\n\t}\r\n\t\r\n\trender(renderer: THREE.WebGLRenderer, scene: THREE.Scene) {\r\n\t\trenderer.setViewport(this._viewport.x, this._viewport.y, this._viewport.width, this._viewport.height);\r\n\t\trenderer.render(scene, this._three);\r\n\t}\r\n\t\r\n\tupdateTransform() {\r\n\t\r\n\t}\r\n\t\r\n\tupdateBoundingBox() {\r\n\t\r\n\t}\r\n}"],"names":["appleIphone","appleIpod","appleTablet","appleUniversal","androidPhone","androidTablet","amazonPhone","amazonTablet","windowsPhone","windowsTablet","otherBlackBerry","otherBlackBerry10","otherOpera","otherChrome","otherFirefox","isAppleTabletOnIos13","navigator","platform","maxTouchPoints","MSStream","Application","options","this","const","canvas","undefined","container","document","body","rendererOptions","alpha","transparent","antialias","renderer","THREE.WebGLRenderer","width","height","resolution","backgroundColor","autoAdjust","setClearColor","setSize","setPixelRatio","autoClear","_container","_renderer","_rendererSize","THREE.Vector2","dom","domElement","style","position","isSP","param","nav","userAgent","tmp","split","match","regex","test","createMatch","result","apple","phone","ipod","tablet","universal","device","amazon","android","windows","other","blackberry","blackberry10","opera","firefox","chrome","any","isMobile","raycaster","THREE.Raycaster","mouse","event","type","emitted","originalEvent","down","over","cast","e","x","y","w","offsetWidth","h","offsetHeight","c","_views","i","length","onInteraction","dispatch","targets","let","emit","separate","_first","_emitted","first","concat","both","p","index","indexOf","splice","push","startHandler","interactionDown","moveHandler","interactionMove","saparated","endHandler","interactionUp","addEventListener","touches","clientX","offsetLeft","clientY","offsetTop","changedTouches","offsetX","offsetY","window","_lastTime","timeStamp","step","timestamp","delta","_playing","update","requestAnimationFrame","autoAdjuster","fullScreen","prototypeAccessors","element","addView","view","removeView","play","appendChild","start","stop","render","setViewport","clear","_autoAdjuster","removeEventListener","rect","r","innerWidth","innerHeight","adjustHeight","toCenter","toTop","adjustWidth","toMiddle","toLeft","horizontal","hol","left","_getViewRect","toRight","vertical","ver","top","toBottom","parseInt","replace","Emitter","_events","_on","callback","once","events","on","off","_emit","context","apply","args","cemit","_emitAll","emitAll","cemitAll","Task","callbacks","_taskData","enabled","value","add","Array","isArray","list","Function","done","task","_to","Number","prev","next","to","finish","reset","destroy","_box","THREE.Box3","DisplayObject","three","super","THREE.Vector3","_three","_sub","interactive","_task","parent","userData","children","_children","updateTask","updateBoundingBox","_size","depth","z","scale","pivot","_pivot","updateTransform","remove","setFromObject","getSize","multiply","addChild","object","removeChild","Object2D","matrixAutoUpdate","skew","_skew","rotation","_updateMatrix","scaleX","scaleY","skewX","skewY","pivotX","pivotY","a","Math","cos","b","sin","d","tx","ty","matrix","set","Object3D","Container2D","THREE.Group","_updateOrder","Container3D","View","THREE.Scene","scene","addCamera","camera","_cameras","removeCamera","clearDepth","setFromCamera","f","map","THREE.Mesh","flat","meshes","intersects","intersectObjects","dispatchEvent","OIMO","PhysicsView","_world","World","setGravity","Vec3","world","addRigidBody","o","removeRigidBody","physicsEnabled","BodyPosition","_object","getPosition","setPosition","BodyRotation","getRotation","toEulerXyz","setRotationXyz","PhysicsObject3D","_body","_position","_rotation","ref","contactEnabled","_contantEnabled","ContactCallback","hit","beginContact","getShape2","getRigidBody","endContact","preSolve","postSolve","shape","getShapeList","setContactCallback","getNext","copy","quaternion","getOrientation","Anchor","mesh","_x","_y","_z","_mesh","updateGeometryPosition","Sprite","texture","_anchor","_material","THREE.MeshBasicMaterial","material","_texture","needsUpdate","image","_updateGeometry","anchor","geometry","THREE.PlaneGeometry","_width","_height","center","translate","computeBoundingBox","boundingBox","from","url","sprite","THREE.TextureLoader","load","Mesh","Camera","viewport","_viewport"],"mappings":"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"}